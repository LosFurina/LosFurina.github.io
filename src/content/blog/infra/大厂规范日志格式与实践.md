---
title: "大厂规范日志格式与实践"
description: "使用 ISO 8601 格式（带时区，精确到毫秒）。这是 ELK 排序的核心。"
pubDate: "2026-02-12"
updatedDate: "2026-02-12"
category: "infra"
tags: ["infra"]
sourcePath: "src/content/blog/Gemini-大厂规范日志格式与实践.md"
sourceVault: "chat-export"
---
## 背景与适用场景

本文基于实际问题整理：一条正常且符合大厂规范的，能被记录在elk里面的日志，应该长什么样‘。

## 核心结论

- 使用 ISO 8601 格式（带时区，精确到毫秒）。这是 ELK 排序的核心。
- 日志级别（DEBUG, INFO, WARN, ERROR, FATAL）。
- 区分 production, staging, dev。
- 重中之重。整个请求链路的唯一 ID，用于串联起网关（Traefik）、后端服务、数据库的所有操作。
- 记录当前处理单元的 ID。

## 详细说明

### 实现思路 1

使用 ISO 8601 格式（带时区，精确到毫秒）

大厂对级别的管控非常严格，以避免日志风暴压垮 ELK 集群

## 操作步骤与命令示例

### 示例 1

```bash
{
  "timestamp": "2026-01-29T05:30:15.123Z",
  "level": "ERROR",
  "service": "revieu-auth-service",
  "version": "1.2.0",
  "trace_id": "a1b2c3d4e5f6g7h8",
  "span_id": "b87654321",
  "client_ip": "192.168.1.100",
  "user_id": "u9527",
  "event": "user_login_failed",
  "message": "Failed to authenticate user due to expired token",
  "stack_trace": "InternalError: Token expired\n    at Auth.verify...",
  "extra": {
    "login_type": "oauth2",
    "attempt_count": 3
  }
}
```

### 执行顺序建议

1. 明确目标环境、依赖条件与网络连通性。
2. 分阶段实施配置或部署，逐步验证。
3. 记录最终状态与回滚策略，便于复用。

## 常见问题与排查

- **问题：** 如何开始  **排查：** 先确认当前状态和目标，再按步骤执行并验证结果。

## 关键问答摘录

> **Q:** 这篇内容适合谁？
>
> **A:** 适合需要快速理解主题并执行实践步骤的读者。

## 总结

使用 ISO 8601 格式（带时区，精确到毫秒）。这是 ELK 排序的核心。

- 原始对话来源：https://gemini.google.com/app/f266eb3ae0be6afb
