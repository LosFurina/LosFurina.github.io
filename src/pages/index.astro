---
import { getCollection } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import HeroSection from "../components/home/HeroSection.astro";
import NowStatus from "../components/home/NowStatus.astro";
import FeaturedProjects from "../components/home/FeaturedProjects.astro";
import TechTimeline from "../components/home/TechTimeline.astro";
import LatestPosts from "../components/home/LatestPosts.astro";
import HomeCTA from "../components/home/HomeCTA.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import {
	hero,
	nowStatus,
	featuredProjects,
	techTimeline,
	homeCta,
} from "../data/home";
import { filterVisiblePosts } from "../utils/blogVisibility";

const latestPosts = filterVisiblePosts(await getCollection("blog"))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			:global(.home-section) {
				padding: 3.5rem 0;
			}

			:global(.home-container) {
				max-width: 1100px;
				margin: 0 auto;
				padding: 0 2rem;
			}

			:global(.home-section__header) {
				margin-bottom: 1.75rem;
			}

			:global(.home-section__title) {
				margin: 0 0 0.4rem;
				font-size: 1.8rem;
			}

			:global(.home-section__subtitle) {
				margin: 0;
				color: rgb(var(--gray));
				font-size: 1rem;
			}

			@media (max-width: 720px) {
				:global(.home-container) {
					padding: 0 1.25rem;
				}

				:global(.home-section) {
					padding: 2.5rem 0;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<HeroSection hero={hero} />
		<NowStatus nowStatus={nowStatus} />
		<FeaturedProjects projects={featuredProjects} />
		<TechTimeline items={techTimeline} />
		<LatestPosts posts={latestPosts} />
		<HomeCTA {...homeCta} />
		<Footer />
	</body>
</html>
