<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" href="/favicon.ico"><!-- Theme Initialization Script --><script>
	const theme = (() => {
		if (
			typeof localStorage !== "undefined" &&
			localStorage.getItem("theme")
		) {
			return localStorage.getItem("theme");
		}
		if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
			return "dark";
		}
		return "light";
	})();

	if (theme === "dark") {
		document.documentElement.setAttribute("data-theme", "dark");
		document.documentElement.classList.add("dark");
	} else {
		document.documentElement.setAttribute("data-theme", "light");
		document.documentElement.classList.remove("dark");
	}

	window.localStorage.setItem("theme", theme);
</script><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Wayne" href="https://blog.liweijun.com/rss.xml"><meta name="generator" content="Astro v5.17.1"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://blog.liweijun.com/blog/security/gpg-%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/"><!-- Primary Meta Tags --><title>GPG é…ç½®ä¸ä½¿ç”¨</title><meta name="title" content="GPG é…ç½®ä¸ä½¿ç”¨"><meta name="description" content="Keyï¼š (9) ECC (sign and encrypt) ï¼ˆå¦‚æœçœ‹åˆ°çš„è¯ï¼‰ã€‚"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.liweijun.com/blog/security/gpg-%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/"><meta property="og:title" content="GPG é…ç½®ä¸ä½¿ç”¨"><meta property="og:description" content="Keyï¼š (9) ECC (sign and encrypt) ï¼ˆå¦‚æœçœ‹åˆ°çš„è¯ï¼‰ã€‚"><meta property="og:image" content="https://blog.liweijun.com/_astro/blog-placeholder-1.Bx0Zcyzv.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.liweijun.com/blog/security/gpg-%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/"><meta property="twitter:title" content="GPG é…ç½®ä¸ä½¿ç”¨"><meta property="twitter:description" content="Keyï¼š (9) ECC (sign and encrypt) ï¼ˆå¦‚æœçœ‹åˆ°çš„è¯ï¼‰ã€‚"><meta property="twitter:image" content="https://blog.liweijun.com/_astro/blog-placeholder-1.Bx0Zcyzv.jpg"><!-- Structured Data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Wayne","description":"DevOps and infrastructure engineering notes, projects, and practical automation experiments by Wayne Li.","url":"https://blog.liweijun.com/","inLanguage":"en"}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"Wayne Li","url":"https://blog.liweijun.com/","email":"mailto:me@liweijun.com","sameAs":["https://github.com/LosFurina","https://x.com/MicroNahida"],"jobTitle":"DevOps / Infrastructure Engineer"}</script><link rel="stylesheet" href="/_astro/index.DCFK0IPC.css">
<link rel="stylesheet" href="/_astro/about.C7Me09Gr.css">
<style>a[data-astro-cid-eimmu3lg]{display:inline-flex;align-items:center;gap:.5rem;padding:.4rem .75rem;text-decoration:none;font-size:.9rem;font-weight:500;color:var(--header-text, rgb(var(--gray-dark)));border-radius:999px;transition:color .2s ease,background .2s ease;position:relative}a[data-astro-cid-eimmu3lg]:hover{background:var(--header-hover, rgba(179, 106, 74, .08));color:var(--header-text-strong, rgb(var(--gray-dark)))}a[data-astro-cid-eimmu3lg]:focus-visible{outline:2px solid var(--header-accent, #b36a4a);outline-offset:2px}a[data-astro-cid-eimmu3lg].active{color:var(--header-accent, #b36a4a)}a[data-astro-cid-eimmu3lg].active:after{content:"";position:absolute;left:50%;bottom:4px;width:4px;height:4px;margin-left:-2px;border-radius:999px;background:var(--header-accent, #b36a4a)}.nav-icon[data-astro-cid-eimmu3lg]{display:inline-flex;width:16px;height:16px}.nav-icon[data-astro-cid-eimmu3lg] svg{width:16px;height:16px;fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}@media(max-width:720px){a[data-astro-cid-eimmu3lg]{width:100%;justify-content:flex-start;padding:.6rem .9rem}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="nav-left" data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>Wayne</a></h2> </div> <div class="internal-links" id="mobileMenu" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> <span class="nav-icon" aria-hidden="true" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" stroke-width="1.6" data-astro-cid-3ef6ksr2> <path d="M3 11.5L12 4l9 7.5" data-astro-cid-3ef6ksr2></path> <path d="M6.5 10.5V20h11V10.5" data-astro-cid-3ef6ksr2></path> </svg> </span> <span class="nav-text" data-astro-cid-eimmu3lg> 
Home
</span> </a>  <a href="/blog" class="active" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> <span class="nav-icon" aria-hidden="true" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" stroke-width="1.6" data-astro-cid-3ef6ksr2> <rect x="6" y="4.5" width="12" height="15" rx="2" data-astro-cid-3ef6ksr2></rect> <path d="M9 9h6" data-astro-cid-3ef6ksr2></path> <path d="M9 13h6" data-astro-cid-3ef6ksr2></path> </svg> </span> <span class="nav-text" data-astro-cid-eimmu3lg> 
Blog
</span> </a>  <a href="/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> <span class="nav-icon" aria-hidden="true" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" stroke-width="1.6" data-astro-cid-3ef6ksr2> <rect x="4" y="4" width="7" height="7" rx="1.5" data-astro-cid-3ef6ksr2></rect> <rect x="13" y="4" width="7" height="7" rx="1.5" data-astro-cid-3ef6ksr2></rect> <rect x="4" y="13" width="7" height="7" rx="1.5" data-astro-cid-3ef6ksr2></rect> <rect x="13" y="13" width="7" height="7" rx="1.5" data-astro-cid-3ef6ksr2></rect> </svg> </span> <span class="nav-text" data-astro-cid-eimmu3lg> 
Projects
</span> </a>  <a href="/resume" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> <span class="nav-icon" aria-hidden="true" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" stroke-width="1.6" data-astro-cid-3ef6ksr2> <path d="M7 3.5h7l4 4v13a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5.5a2 2 0 0 1 2-2z" data-astro-cid-3ef6ksr2></path> <path d="M14 3.5V8h4" data-astro-cid-3ef6ksr2></path> <path d="M9 12h6" data-astro-cid-3ef6ksr2></path> <path d="M9 16h6" data-astro-cid-3ef6ksr2></path> </svg> </span> <span class="nav-text" data-astro-cid-eimmu3lg> 
Resume
</span> </a>  <a href="/contact" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> <span class="nav-icon" aria-hidden="true" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" stroke-width="1.6" data-astro-cid-3ef6ksr2> <path d="M4 6.5h16a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2z" data-astro-cid-3ef6ksr2></path> <path d="M4 8l8 6 8-6" data-astro-cid-3ef6ksr2></path> </svg> </span> <span class="nav-text" data-astro-cid-eimmu3lg> 
Contact
</span> </a>  <!-- Tools Dropdown --> <div class="dropdown" id="toolsDropdown" data-astro-cid-3ef6ksr2> <button class="dropdown-trigger" id="toolsBtn" data-astro-cid-3ef6ksr2>
More
<svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="12" height="12" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" data-astro-cid-3ef6ksr2></path> </svg> </button> <div class="dropdown-menu" id="toolsMenu" data-astro-cid-3ef6ksr2> <!-- æœ¬ç«™é¡µé¢ --> <a href="/about" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ‘¤</span>
About
</a> <a href="/uses" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ› ï¸</span>
Uses
</a> <a href="/now" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>â°</span>
Now
</a> <a href="/bookmarks" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ”–</span>
Bookmarks
</a> <a href="/guestbook" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ“</span>
Guestbook
</a> <div class="dropdown-divider" data-astro-cid-3ef6ksr2></div> <a href="/keys" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ”</span>
GPG Keys
</a> <div class="dropdown-divider" data-astro-cid-3ef6ksr2></div> <!-- å¤–éƒ¨é“¾æ¥ --> <a href="https://github.com/LosFurina" target="_blank" rel="noopener" class="dropdown-item" data-astro-cid-3ef6ksr2> <span class="item-icon" data-astro-cid-3ef6ksr2>ğŸ“¦</span>
GitHub
<span class="external-icon" data-astro-cid-3ef6ksr2>â†—</span> </a> </div> </div> </div> <div class="nav-right" data-astro-cid-3ef6ksr2> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://github.com/LosFurina" target="_blank" title="GitHub" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path> </svg> </a> <a href="https://x.com/MicroNahida" target="_blank" rel="noopener" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>X (Twitter)</span> <svg viewBox="0 0 24 24" aria-hidden="true" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> <button id="theme-toggle" aria-label="Toggle theme" data-astro-cid-x3pjskd3> <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-x3pjskd3> <circle cx="12" cy="12" r="5" data-astro-cid-x3pjskd3></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-x3pjskd3></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-x3pjskd3></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-x3pjskd3></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-x3pjskd3></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-x3pjskd3></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-x3pjskd3></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-x3pjskd3></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-x3pjskd3></line> </svg> <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-x3pjskd3> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-x3pjskd3></path> </svg> </button>  <script type="module">const t=()=>{const e=document.documentElement;e.getAttribute("data-theme")==="dark"?(e.setAttribute("data-theme","light"),e.classList.remove("dark"),localStorage.setItem("theme","light")):(e.setAttribute("data-theme","dark"),e.classList.add("dark"),localStorage.setItem("theme","dark"))};document.getElementById("theme-toggle")?.addEventListener("click",t);</script> <!-- Hamburger Menu Button (Mobile Only) --> <button class="hamburger" id="hamburgerBtn" aria-label="Toggle menu" data-astro-cid-3ef6ksr2> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> <span class="hamburger-line" data-astro-cid-3ef6ksr2></span> </button> </div> </nav> </header>  <script type="module">const n=document.querySelector("header");function c(){window.scrollY>10?n?.classList.add("scrolled"):n?.classList.remove("scrolled")}window.addEventListener("scroll",c,{passive:!0});c();const t=document.getElementById("hamburgerBtn"),o=document.getElementById("mobileMenu");t?.addEventListener("click",e=>{e.stopPropagation(),t.classList.toggle("open"),o?.classList.toggle("open")});o?.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{t?.classList.remove("open"),o?.classList.remove("open")})});const s=document.getElementById("toolsDropdown"),l=document.getElementById("toolsBtn");l?.addEventListener("click",e=>{e.stopPropagation(),s?.classList.toggle("open")});document.addEventListener("click",e=>{s?.contains(e.target)||s?.classList.remove("open"),!o?.contains(e.target)&&!t?.contains(e.target)&&(t?.classList.remove("open"),o?.classList.remove("open"))});document.addEventListener("keydown",e=>{e.key==="Escape"&&(s?.classList.remove("open"),t?.classList.remove("open"),o?.classList.remove("open"))});</script> <div class="blog-container" data-astro-cid-bvzihdzo> <aside class="toc-sidebar" data-astro-cid-bvzihdzo> <div class="toc-wrapper" data-astro-cid-bvzihdzo> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn><h4 class="toc-title" data-astro-cid-xvrfupwn><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" data-astro-cid-xvrfupwn><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" data-astro-cid-xvrfupwn></path></svg>
On this page
</h4><ul class="toc-list" data-astro-cid-xvrfupwn><li class="toc-item depth-2" data-astro-cid-xvrfupwn><a href="#èƒŒæ™¯ä¸ç›®æ ‡" class="toc-link" data-astro-cid-xvrfupwn>èƒŒæ™¯ä¸ç›®æ ‡</a></li><li class="toc-item depth-2" data-astro-cid-xvrfupwn><a href="#æ ¸å¿ƒå†…å®¹" class="toc-link" data-astro-cid-xvrfupwn>æ ¸å¿ƒå†…å®¹</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-1-gpgæ€ä¹ˆé…ç½®æ€ä¹ˆä½¿ç”¨" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 1. gpgæ€ä¹ˆé…ç½®æ€ä¹ˆä½¿ç”¨</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å®‰è£…" class="toc-link" data-astro-cid-xvrfupwn>å®‰è£…</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#åˆå§‹åŒ–ç¬¬ä¸€æ¬¡ç”¨ä¼šè‡ªåŠ¨å»ºç›®å½•" class="toc-link" data-astro-cid-xvrfupwn>åˆå§‹åŒ–ï¼ˆç¬¬ä¸€æ¬¡ç”¨ä¼šè‡ªåŠ¨å»ºç›®å½•ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ–¹æ¡ˆ-aæ¨èeccç°ä»£" class="toc-link" data-astro-cid-xvrfupwn>æ–¹æ¡ˆ Aï¼šæ¨èï¼ˆECCï¼Œç°ä»£ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å®‰è£…-pinentrykde-å¸¸ç”¨" class="toc-link" data-astro-cid-xvrfupwn>å®‰è£… pinentryï¼ˆKDE å¸¸ç”¨ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#é…ç½®-gpg-agent" class="toc-link" data-astro-cid-xvrfupwn>é…ç½® gpg-agent</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1-ç»™æ–‡ä»¶ç­¾åç”Ÿæˆ-sig" class="toc-link" data-astro-cid-xvrfupwn>(1) ç»™æ–‡ä»¶ç­¾åï¼ˆç”Ÿæˆ .sigï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2-ç›´æ¥ç­¾åæˆå¯è¯»æ–‡æœ¬å¸¸ç”¨äºå‘å¸ƒå£°æ˜" class="toc-link" data-astro-cid-xvrfupwn>(2) ç›´æ¥ç­¾åæˆå¯è¯»æ–‡æœ¬ï¼ˆå¸¸ç”¨äºå‘å¸ƒå£°æ˜ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3-åŠ å¯†ç»™æŸä¸ªäººå¯¹æ–¹æœ‰ä»–çš„å…¬é’¥" class="toc-link" data-astro-cid-xvrfupwn>(3) åŠ å¯†ç»™æŸä¸ªäººï¼ˆå¯¹æ–¹æœ‰ä»–çš„å…¬é’¥ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#4-è§£å¯†" class="toc-link" data-astro-cid-xvrfupwn>(4) è§£å¯†</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#5-å¯¼å‡ºä½ çš„å…¬é’¥ç»™åˆ«äººç”¨" class="toc-link" data-astro-cid-xvrfupwn>(5) å¯¼å‡ºä½ çš„å…¬é’¥ï¼ˆç»™åˆ«äººç”¨ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#6-å¯¼å…¥åˆ«äººå…¬é’¥" class="toc-link" data-astro-cid-xvrfupwn>(6) å¯¼å…¥åˆ«äººå…¬é’¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#è®¾ç½®-git-ç”¨-gpg" class="toc-link" data-astro-cid-xvrfupwn>è®¾ç½® Git ç”¨ gpg</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1-å¯¼å‡ºç§é’¥åŠ¡å¿…ç¦»çº¿ä¿å­˜åŠ å¯†ç›˜u-ç›˜" class="toc-link" data-astro-cid-xvrfupwn>(1) å¯¼å‡ºç§é’¥ï¼ˆåŠ¡å¿…ç¦»çº¿ä¿å­˜ã€åŠ å¯†ç›˜ã€U ç›˜ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2-å¯¼å‡ºå­å¯†é’¥" class="toc-link" data-astro-cid-xvrfupwn>(2) å¯¼å‡ºå­å¯†é’¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3-ç”ŸæˆåŠé”€è¯ä¹¦" class="toc-link" data-astro-cid-xvrfupwn>(3) ç”ŸæˆåŠé”€è¯ä¹¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å‘-aç­¾åè§£å¯†æ—¶å¡ä½æç¤ºæ‰¾ä¸åˆ°-pinentry" class="toc-link" data-astro-cid-xvrfupwn>å‘ Aï¼šç­¾å/è§£å¯†æ—¶å¡ä½ã€æç¤ºæ‰¾ä¸åˆ° pinentry</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å‘-btty-ä¸‹ä¸å¼¹å¯†ç è¾“å…¥" class="toc-link" data-astro-cid-xvrfupwn>å‘ Bï¼šTTY ä¸‹ä¸å¼¹å¯†ç è¾“å…¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å‘-cä½ æœ‰å¤šä¸ª-keyä¸çŸ¥é“åˆ°åº•ç”¨å“ªä¸ª" class="toc-link" data-astro-cid-xvrfupwn>å‘ Cï¼šä½ æœ‰å¤šä¸ª keyï¼Œä¸çŸ¥é“åˆ°åº•ç”¨å“ªä¸ª</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-2-commentäº›ä»€ä¹ˆæ¯”è¾ƒå¥½" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 2. commentäº›ä»€ä¹ˆæ¯”è¾ƒå¥½</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æœ€ç¨³å¦¥å·¥ç¨‹æ„Ÿæœ€å¼ºçš„ä¸€ç±»" class="toc-link" data-astro-cid-xvrfupwn>æœ€ç¨³å¦¥ã€å·¥ç¨‹æ„Ÿæœ€å¼ºçš„ä¸€ç±»</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ¨èè¿™ç§ç ”ç©¶æ—¥å¿—å‹" class="toc-link" data-astro-cid-xvrfupwn>æ¨èè¿™ç§â€œç ”ç©¶æ—¥å¿—å‹â€ï¼š</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#è§„åˆ™åªæœ‰ä¸‰æ¡" class="toc-link" data-astro-cid-xvrfupwn>è§„åˆ™åªæœ‰ä¸‰æ¡</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ¨¡æ¿ç›´æ¥ç”¨" class="toc-link" data-astro-cid-xvrfupwn>æ¨¡æ¿ï¼ˆç›´æ¥ç”¨ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-3-é®ç¾éƒ½æœ‰ä»€ä¹ˆç”¨è¯¦ç»†è¯´è¯´" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 3. é®ç¾éƒ½æœ‰ä»€ä¹ˆç”¨ï¼Œè¯¦ç»†è¯´è¯´</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#a-ç®¡ç†ç§é’¥æ“ä½œé›†ä¸­å…¥å£" class="toc-link" data-astro-cid-xvrfupwn>A) ç®¡ç†ç§é’¥æ“ä½œï¼ˆé›†ä¸­å…¥å£ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#b-è®°ä½ä½ è§£é”è¿‡çš„å‡­è¯ç¼“å­˜" class="toc-link" data-astro-cid-xvrfupwn>B) è®°ä½ä½ è§£é”è¿‡çš„å‡­è¯ï¼ˆç¼“å­˜ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#c-å¯é€‰ä»£ç®¡-sshenable-ssh-support" class="toc-link" data-astro-cid-xvrfupwn>C) å¯é€‰ï¼šä»£ç®¡ SSHï¼ˆenable-ssh-supportï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#default-cache-ttl-600" class="toc-link" data-astro-cid-xvrfupwn>default-cache-ttl 600</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#max-cache-ttl-7200" class="toc-link" data-astro-cid-xvrfupwn>max-cache-ttl 7200</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ç—›ç‚¹-1git-commit--s-å¡ä½ä¸åŠ¨" class="toc-link" data-astro-cid-xvrfupwn>ç—›ç‚¹ 1ï¼šgit commit -S å¡ä½ä¸åŠ¨</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ç—›ç‚¹-2æ¯æ¬¡æäº¤éƒ½è¦è¾“å¯†ç çƒ¦åˆ°çˆ†" class="toc-link" data-astro-cid-xvrfupwn>ç—›ç‚¹ 2ï¼šæ¯æ¬¡æäº¤éƒ½è¦è¾“å¯†ç ï¼Œçƒ¦åˆ°çˆ†</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ç—›ç‚¹-3guiwaylandttyssh-ç¯å¢ƒåˆ‡æ¢æ—¶è¾“å…¥æ–¹å¼ä¹±å¥—" class="toc-link" data-astro-cid-xvrfupwn>ç—›ç‚¹ 3ï¼šGUI/Wayland/TTY/SSH ç¯å¢ƒåˆ‡æ¢æ—¶ï¼Œè¾“å…¥æ–¹å¼ä¹±å¥—</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-4-è¿™éƒ½æ˜¯ä»€ä¹ˆæ„æ€" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 4. è¿™éƒ½æ˜¯ä»€ä¹ˆæ„æ€</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å…ˆç»™ç»“è®º" class="toc-link" data-astro-cid-xvrfupwn>å…ˆç»™ç»“è®º</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#trustdb-æ˜¯ä»€ä¹ˆ" class="toc-link" data-astro-cid-xvrfupwn>trustdb æ˜¯ä»€ä¹ˆã€‚</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å…³é”®å­—æ®µç¿»è¯‘æˆäººè¯" class="toc-link" data-astro-cid-xvrfupwn>å…³é”®å­—æ®µç¿»è¯‘æˆäººè¯</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#sec" class="toc-link" data-astro-cid-xvrfupwn>sec</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ed25519" class="toc-link" data-astro-cid-xvrfupwn>ed25519</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#782caf316029fc6a" class="toc-link" data-astro-cid-xvrfupwn>/782CAF316029FC6A</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2026-02-10" class="toc-link" data-astro-cid-xvrfupwn>2026-02-10</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#sc" class="toc-link" data-astro-cid-xvrfupwn>[SC]</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#expires-2027-02-10" class="toc-link" data-astro-cid-xvrfupwn>[expires: 2027-02-10]</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ultimate" class="toc-link" data-astro-cid-xvrfupwn>[ultimate]</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ssb" class="toc-link" data-astro-cid-xvrfupwn>ssb</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#cv25519" class="toc-link" data-astro-cid-xvrfupwn>cv25519</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#e" class="toc-link" data-astro-cid-xvrfupwn>[E]</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-5-æ€ä¹ˆæŠŠgpgå½“sshå¯†é’¥" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 5. æ€ä¹ˆæŠŠgpgå½“sshå¯†é’¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1ï¸âƒ£-æ·»åŠ å­å¯†é’¥" class="toc-link" data-astro-cid-xvrfupwn>1ï¸âƒ£ æ·»åŠ å­å¯†é’¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2ï¸âƒ£-ä¿å­˜é€€å‡º" class="toc-link" data-astro-cid-xvrfupwn>2ï¸âƒ£ ä¿å­˜é€€å‡º</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#éªŒè¯ä¸€ä¸‹" class="toc-link" data-astro-cid-xvrfupwn>éªŒè¯ä¸€ä¸‹</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1ï¸âƒ£-æ‹¿åˆ°-ssh-å…¬é’¥ä»-gpg-agent" class="toc-link" data-astro-cid-xvrfupwn>1ï¸âƒ£ æ‹¿åˆ° SSH å…¬é’¥ï¼ˆä» gpg-agentï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2ï¸âƒ£-github" class="toc-link" data-astro-cid-xvrfupwn>2ï¸âƒ£ GitHub</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3ï¸âƒ£-æµ‹è¯•" class="toc-link" data-astro-cid-xvrfupwn>3ï¸âƒ£ æµ‹è¯•</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-6-gpg-addkey" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 6. gpg addkey</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3-dsa-sign-only" class="toc-link" data-astro-cid-xvrfupwn>(3) DSA (sign only)</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#4-rsa-sign-only" class="toc-link" data-astro-cid-xvrfupwn>(4) RSA (sign only)</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#5-elgamal-encrypt-only" class="toc-link" data-astro-cid-xvrfupwn>(5) Elgamal (encrypt only)</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#6-rsa-encrypt-only" class="toc-link" data-astro-cid-xvrfupwn>(6) RSA (encrypt only)</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#12-ecc-encrypt-only" class="toc-link" data-astro-cid-xvrfupwn>(12) ECC (encrypt only)</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#10-ecc-sign-only--æ­£è§£" class="toc-link" data-astro-cid-xvrfupwn>(10) ECC (sign only) â† æ­£è§£</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-7-è¿™è¡Œæ˜¯ä»€ä¹ˆæ„æ€" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 7. è¿™è¡Œæ˜¯ä»€ä¹ˆæ„æ€</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1ï¸âƒ£-gpgconf---list-dirs-agent-ssh-socket" class="toc-link" data-astro-cid-xvrfupwn>1ï¸âƒ£ gpgconf --list-dirs agent-ssh-socket</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2ï¸âƒ£----æ˜¯å•¥" class="toc-link" data-astro-cid-xvrfupwn>2ï¸âƒ£ $( ... ) æ˜¯å•¥ã€‚</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3ï¸âƒ£-export-ssh_auth_sock" class="toc-link" data-astro-cid-xvrfupwn>3ï¸âƒ£ export SSH_AUTH_SOCK=...</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ²¡å†™ä¼šå‘ç”Ÿä»€ä¹ˆ" class="toc-link" data-astro-cid-xvrfupwn>æ²¡å†™ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#å†™äº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆ" class="toc-link" data-astro-cid-xvrfupwn>å†™äº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆã€‚</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æˆ‘æ˜¯ä¸æ˜¯æŠŠç§é’¥è·¯å¾„æš´éœ²å‡ºå»äº†" class="toc-link" data-astro-cid-xvrfupwn>â€œæˆ‘æ˜¯ä¸æ˜¯æŠŠç§é’¥è·¯å¾„æš´éœ²å‡ºå»äº†ã€‚â€</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#è¿™æ˜¯ä¸æ˜¯åœ¨å¹²ä»€ä¹ˆå¾ˆå±é™©çš„äº‹" class="toc-link" data-astro-cid-xvrfupwn>â€œè¿™æ˜¯ä¸æ˜¯åœ¨å¹²ä»€ä¹ˆå¾ˆå±é™©çš„äº‹ã€‚â€</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-8-ssh-add--l--system-012936" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 8. ssh-add -L î˜— system 01:29:36</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ²¡æœ‰-a-çš„è¯æ·»åŠ è®¤è¯å­é’¥" class="toc-link" data-astro-cid-xvrfupwn>æ²¡æœ‰ [A] çš„è¯ï¼šæ·»åŠ è®¤è¯å­é’¥</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#31-æ‰¾åˆ°-a-å­é’¥çš„-keygrip" class="toc-link" data-astro-cid-xvrfupwn>3.1 æ‰¾åˆ° [A] å­é’¥çš„ keygrip</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#32-æŠŠå®ƒå†™è¿›-sshcontrolä¸€è¡Œä¸€ä¸ª" class="toc-link" data-astro-cid-xvrfupwn>3.2 æŠŠå®ƒå†™è¿› sshcontrolï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#33-å†é‡å¯ä¸€æ¬¡-agent" class="toc-link" data-astro-cid-xvrfupwn>3.3 å†é‡å¯ä¸€æ¬¡ agent</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-9-gpg-list-secret-keys-keyid-forma" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 9. gpg â€”list-secret-keys â€”keyid-formaâ€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æƒ…å†µ-aèœå•é‡Œç›´æ¥æœ‰-authentication-key" class="toc-link" data-astro-cid-xvrfupwn>æƒ…å†µ Aï¼šèœå•é‡Œç›´æ¥æœ‰ â€œAuthentication keyâ€</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æƒ…å†µ-bèœå•é‡Œæ²¡æœ‰-authenticationåƒä½ ä¹‹å‰é‚£æ ·" class="toc-link" data-astro-cid-xvrfupwn>æƒ…å†µ Bï¼šèœå•é‡Œæ²¡æœ‰ Authenticationï¼ˆåƒä½ ä¹‹å‰é‚£æ ·ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#31-æ‹¿åˆ°-keygrip" class="toc-link" data-astro-cid-xvrfupwn>3.1 æ‹¿åˆ° keygrip</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#32-å†™è¿›-sshcontrol" class="toc-link" data-astro-cid-xvrfupwn>3.2 å†™è¿› sshcontrol</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#33-é‡å¯-agent" class="toc-link" data-astro-cid-xvrfupwn>3.3 é‡å¯ agent</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#é€‰é¡¹-1ç•™ç€æœ€çœäº‹" class="toc-link" data-astro-cid-xvrfupwn>é€‰é¡¹ 1ï¼šç•™ç€ï¼ˆæœ€çœäº‹ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#é€‰é¡¹-2åˆ æ‰æ›´å¹²å‡€" class="toc-link" data-astro-cid-xvrfupwn>é€‰é¡¹ 2ï¼šåˆ æ‰ï¼ˆæ›´å¹²å‡€ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-10-gpg-addkey" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 10. gpg addkey</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-å…ˆé€€å‡ºå½“å‰ç¼–è¾‘å¦‚æœä½ è¿˜åœ¨-gpg-é‡Œ" class="toc-link" data-astro-cid-xvrfupwn>â‘  å…ˆé€€å‡ºå½“å‰ç¼–è¾‘ï¼ˆå¦‚æœä½ è¿˜åœ¨ gpg&gt; é‡Œï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-ç”¨-expert-æ¨¡å¼é‡æ–°è¿›ç¼–è¾‘" class="toc-link" data-astro-cid-xvrfupwn>â‘¡ ç”¨ expert æ¨¡å¼é‡æ–°è¿›ç¼–è¾‘</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-å†æ¬¡-addkeyè¿™æ¬¡èœå•ä¼šå˜" class="toc-link" data-astro-cid-xvrfupwn>â‘¢ å†æ¬¡ addkeyï¼ˆè¿™æ¬¡èœå•ä¼šå˜ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-æ›²çº¿é€‰æ‹©" class="toc-link" data-astro-cid-xvrfupwn>â‘£ æ›²çº¿é€‰æ‹©</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-è¿‡æœŸæ—¶é—´" class="toc-link" data-astro-cid-xvrfupwn>â‘¤ è¿‡æœŸæ—¶é—´</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#-ä¿å­˜é€€å‡º" class="toc-link" data-astro-cid-xvrfupwn>â‘¥ ä¿å­˜é€€å‡º</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-11-possible-actions-for-this-ecc-key-s" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 11. Possible actions for this ECC key: Sâ€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ç›´æ¥æŒ‰qå¤§å†™å°å†™éƒ½è¡Œ" class="toc-link" data-astro-cid-xvrfupwn>ç›´æ¥æŒ‰ï¼šQï¼ˆå¤§å†™å°å†™éƒ½è¡Œï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1ï¸âƒ£-é€‰æ›²çº¿" class="toc-link" data-astro-cid-xvrfupwn>1ï¸âƒ£ é€‰æ›²çº¿</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2ï¸âƒ£-è¿‡æœŸæ—¶é—´" class="toc-link" data-astro-cid-xvrfupwn>2ï¸âƒ£ è¿‡æœŸæ—¶é—´</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#3ï¸âƒ£-ç¡®è®¤--è¾“å…¥-passphrase" class="toc-link" data-astro-cid-xvrfupwn>3ï¸âƒ£ ç¡®è®¤ &amp; è¾“å…¥ passphrase</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#4ï¸âƒ£-ä¿å­˜" class="toc-link" data-astro-cid-xvrfupwn>4ï¸âƒ£ ä¿å­˜</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸€å¥ç«™é˜Ÿæ€»ç»“" class="toc-link" data-astro-cid-xvrfupwn>ä¸€å¥ç«™é˜Ÿæ€»ç»“</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-12--å“ªä¸€è¡Œæ˜¯-a-å“ªä¸€ä¸²è¯¥å¤åˆ¶é¿å…ä½ æŠ„é”™" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 12. ğŸ‘‰ å“ªä¸€è¡Œæ˜¯ A ã€å“ªä¸€ä¸²è¯¥å¤åˆ¶ï¼Œé¿å…ä½ æŠ„é”™</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä½ ç°åœ¨åªå¹²ä¸€ä»¶äº‹" class="toc-link" data-astro-cid-xvrfupwn>ä½ ç°åœ¨åªå¹²ä¸€ä»¶äº‹</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ–‡ä»¶å†…å®¹è§„åˆ™" class="toc-link" data-astro-cid-xvrfupwn>æ–‡ä»¶å†…å®¹è§„åˆ™</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æƒ…å†µ-asshcontrol-å†™é”™äº†" class="toc-link" data-astro-cid-xvrfupwn>æƒ…å†µ Aï¼šsshcontrol å†™é”™äº†</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æƒ…å†µ-bagent-æ²¡çœŸé‡å¯" class="toc-link" data-astro-cid-xvrfupwn>æƒ…å†µ Bï¼šagent æ²¡çœŸé‡å¯</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æœ€ç»ˆæ ¸æ­¦å™¨100-å®šä½" class="toc-link" data-astro-cid-xvrfupwn>æœ€ç»ˆæ ¸æ­¦å™¨ï¼ˆ100% å®šä½ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-1-ssh--t-gitgithubcom--system-0138" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 1. ssh -T git@github.com î˜— system 01:38â€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#21-çœ‹çœ‹-sshcontrol-é‡Œåˆ°åº•æœ‰å“ªäº›" class="toc-link" data-astro-cid-xvrfupwn>2.1 çœ‹çœ‹ sshcontrol é‡Œåˆ°åº•æœ‰å“ªäº›</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#22-å†ç¡®è®¤-a-çš„-keygrip-æ˜¯å“ªä¸²" class="toc-link" data-astro-cid-xvrfupwn>2.2 å†ç¡®è®¤ [A] çš„ keygrip æ˜¯å“ªä¸²</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#23-è®©-sshcontrol-åªä¿ç•™-a-é‚£ä¸€ä¸²" class="toc-link" data-astro-cid-xvrfupwn>2.3 è®© sshcontrol åªä¿ç•™ [A] é‚£ä¸€ä¸²</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#31-ä½ çš„-pinentry-ç¨‹åºæ˜¯å¦è®¾ç½®--å­˜åœ¨" class="toc-link" data-astro-cid-xvrfupwn>3.1 ä½ çš„ pinentry ç¨‹åºæ˜¯å¦è®¾ç½® &amp; å­˜åœ¨</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#41-æ‰¾åˆ°ä½ è¦ç”¨çš„é‚£æ¡-ssh-å…¬é’¥ä»-agent-è¾“å‡ºé‡ŒæŒ‘-github-é‚£æ¡" class="toc-link" data-astro-cid-xvrfupwn>4.1 æ‰¾åˆ°ä½ è¦ç”¨çš„é‚£æ¡ SSH å…¬é’¥ï¼ˆä» agent è¾“å‡ºé‡ŒæŒ‘ GitHub é‚£æ¡ï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#42-å†™-sshconfigæ²¡æœ‰å°±æ–°å»º" class="toc-link" data-astro-cid-xvrfupwn>4.2 å†™ ~/.ssh/configï¼ˆæ²¡æœ‰å°±æ–°å»ºï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-2-ssh--vvv--t-gitgithubcom--system" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 2. ssh -vvv -T git@github.com î˜— systemâ€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-13-vim-gnupggpg-agentconf" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 13. vim ~/.gnupg/gpg-agent.conf</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-3-alias-tip-nv-sshconfig-æ³¨ssh-å®¢æˆ·" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 3. Alias tip: nv ~/.ssh/config æ³¨ï¼šSSH å®¢æˆ·â€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-4-æˆ‘ç¡®å®šåœ¨githubæ·»åŠ äº†" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 4. æˆ‘ç¡®å®šåœ¨githubæ·»åŠ äº†</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#a-ä½ åŠ é”™ä½ç½®åŠ åˆ°-gpg-keys--deploy-key" class="toc-link" data-astro-cid-xvrfupwn>A) ä½ åŠ é”™ä½ç½®ï¼ˆåŠ åˆ° GPG keys / deploy keyï¼‰</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#b-ä½ åŠ åˆ°äº†å¦ä¸€ä¸ªè´¦å·" class="toc-link" data-astro-cid-xvrfupwn>B) ä½ åŠ åˆ°äº†å¦ä¸€ä¸ªè´¦å·</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-5-ssh--vv--t-gitgithubcom--255--sy" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 5. ssh -vv -T git@github.com âœ˜ 255 î˜— syâ€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-6-ssh--t-gitgithubcom-5s--system-01" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 6. ssh -T git@github.com 5s î˜— system 01â€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-7-cat-sshconfig--255--system-01" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 7. cat ~/.ssh/config âœ˜ 255 î˜— system 01:â€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä½ ä¼šé‡åˆ°ä¸¤ç§ç»“æœ" class="toc-link" data-astro-cid-xvrfupwn>ä½ ä¼šé‡åˆ°ä¸¤ç§ç»“æœï¼š</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-8-ssh--vv--t-gitgithubcom--255--sy" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 8. ssh -vv -T git@github.com âœ˜ 255 î˜— syâ€¦</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ’æŸ¥åœºæ™¯-9-æˆ‘ç°åœ¨ä¸éœ€è¦gpgå½“sshäº†æŠŠé…ç½®éƒ½åˆ äº†" class="toc-link" data-astro-cid-xvrfupwn>æ’æŸ¥åœºæ™¯ 9. æˆ‘ç°åœ¨ä¸éœ€è¦gpgå½“sshäº†ï¼ŒæŠŠé…ç½®éƒ½åˆ äº†</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#æ”¹æˆ-æœ€ç®€å•æœ€ç¨³çš„-github-é…ç½®" class="toc-link" data-astro-cid-xvrfupwn>æ”¹æˆ æœ€ç®€å•ã€æœ€ç¨³çš„ GitHub é…ç½®ï¼š</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#1ï¸âƒ£-çœ‹-ssh-ç°åœ¨ç”¨çš„-key" class="toc-link" data-astro-cid-xvrfupwn>1ï¸âƒ£ çœ‹ SSH ç°åœ¨ç”¨çš„ keyï¼š</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#2ï¸âƒ£-ç›´æ¥æµ‹è¯•-github" class="toc-link" data-astro-cid-xvrfupwn>2ï¸âƒ£ ç›´æ¥æµ‹è¯• GitHubï¼š</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ä¸»é¢˜-14-æ‰€ä»¥gpgæœ¬èº«å°±ä¸æ˜¯å¹²è¿™ä¸ªäº‹çš„" class="toc-link" data-astro-cid-xvrfupwn>ä¸»é¢˜ 14. æ‰€ä»¥gpgæœ¬èº«å°±ä¸æ˜¯å¹²è¿™ä¸ªäº‹çš„</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#gpg-çš„åŸç”Ÿä½¿å‘½" class="toc-link" data-astro-cid-xvrfupwn>GPG çš„åŸç”Ÿä½¿å‘½</a></li><li class="toc-item depth-3" data-astro-cid-xvrfupwn><a href="#ssh-çš„åŸç”Ÿä½¿å‘½" class="toc-link" data-astro-cid-xvrfupwn>SSH çš„åŸç”Ÿä½¿å‘½</a></li><li class="toc-item depth-2" data-astro-cid-xvrfupwn><a href="#å®æ–½ä¸éªŒè¯æ¸…å•" class="toc-link" data-astro-cid-xvrfupwn>å®æ–½ä¸éªŒè¯æ¸…å•</a></li></ul></nav><script type="module">const i=new IntersectionObserver(e=>{e.forEach(t=>{const c=t.target.getAttribute("id"),r=document.querySelector(`.toc-link[href="#${c}"]`);t.isIntersecting&&(document.querySelectorAll(".toc-link.active").forEach(o=>{o.classList.remove("active")}),r?.classList.add("active"))})},{rootMargin:"-80px 0px -80% 0px",threshold:0});document.querySelectorAll("article h2[id], article h3[id]").forEach(e=>{i.observe(e)});</script> </div> </aside> <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo>  <header class="article-header" data-astro-cid-bvzihdzo> <h1 class="article-title" data-astro-cid-bvzihdzo>GPG é…ç½®ä¸ä½¿ç”¨</h1> <div class="article-meta" data-astro-cid-bvzihdzo>  <time datetime="2026-02-10T00:00:00.000Z"> Feb 9, 2026 </time> <span class="meta-divider" data-astro-cid-bvzihdzo></span> <span class="reading-time" data-astro-cid-rafwukvt> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" data-astro-cid-rafwukvt> <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" data-astro-cid-rafwukvt></path> </svg> 79 min read
</span>   <span class="meta-divider" data-astro-cid-bvzihdzo></span> <span class="last-updated" data-astro-cid-bvzihdzo>
Updated  <time datetime="2026-02-13T00:00:00.000Z"> Feb 12, 2026 </time> </span>  </div> </header> <div class="article-content" data-astro-cid-bvzihdzo>  <h2 id="èƒŒæ™¯ä¸ç›®æ ‡">èƒŒæ™¯ä¸ç›®æ ‡</h2>
<p>æœ¬æ–‡å›´ç»•â€œgpgæ€ä¹ˆé…ç½®æ€ä¹ˆä½¿ç”¨â€å±•å¼€ï¼Œæ•´ç†å¯ç›´æ¥å¤ç”¨çš„æ­¥éª¤ã€åŸç†è¯´æ˜ä¸æ’æŸ¥ç»éªŒã€‚</p>
<h2 id="æ ¸å¿ƒå†…å®¹">æ ¸å¿ƒå†…å®¹</h2>
<h3 id="ä¸»é¢˜-1-gpgæ€ä¹ˆé…ç½®æ€ä¹ˆä½¿ç”¨">ä¸»é¢˜ 1. gpgæ€ä¹ˆé…ç½®æ€ä¹ˆä½¿ç”¨</h3>
<ol>
<li>å®‰è£… &#x26; åŸºç¡€æ£€æŸ¥</li>
</ol>
<h3 id="å®‰è£…">å®‰è£…</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> pacman</span><span style="color:#79B8FF"> -S</span><span style="color:#9ECBFF"> gnupg</span></span></code></pre>
<h3 id="åˆå§‹åŒ–ç¬¬ä¸€æ¬¡ç”¨ä¼šè‡ªåŠ¨å»ºç›®å½•">åˆå§‹åŒ–ï¼ˆç¬¬ä¸€æ¬¡ç”¨ä¼šè‡ªåŠ¨å»ºç›®å½•ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --version</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> -k</span></span></code></pre>
<p>GPG çš„â€œå®¶ç›®å½•â€é»˜è®¤åœ¨ï¼š</p>
<ul>
<li><code>~/.gnupg/</code></li>
</ul>
<p>æƒé™å¿…é¡»ä¸¥æ ¼ï¼Œä¸ç„¶ä¼šæŠ¥å®‰å…¨è­¦å‘Šï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">chmod</span><span style="color:#79B8FF"> 700</span><span style="color:#9ECBFF"> ~/.gnupg</span></span></code></pre>
<ol start="2">
<li>ç”Ÿæˆä¸€æŠŠè‡ªå·±çš„å¯†é’¥ï¼ˆæ¨èæ–¹å¼ï¼‰</li>
</ol>
<p>ç°åœ¨æ¨èç”¨â€œå¿«é€Ÿç”Ÿæˆâ€å¹¶é€‰å¼ºç®—æ³•ï¼ˆæ¤­åœ†æ›²çº¿æ›´çœäº‹ã€å¤Ÿç”¨ã€æ€§èƒ½å¥½ï¼‰ã€‚</p>
<h3 id="æ–¹æ¡ˆ-aæ¨èeccç°ä»£">æ–¹æ¡ˆ Aï¼šæ¨èï¼ˆECCï¼Œç°ä»£ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --full-generate-key</span></span></code></pre>
<p>ç„¶åæŒ‰æç¤ºé€‰ï¼š</p>
<ul>
<li>Key typeï¼š<strong>(9) ECC (sign and encrypt)</strong>ï¼ˆå¦‚æœçœ‹åˆ°çš„è¯ï¼‰</li>
<li>Curveï¼šä¼˜å…ˆ <code>ed25519</code>ï¼ˆç­¾åï¼‰+ <code>cv25519</code>ï¼ˆåŠ å¯†ï¼‰ç»„åˆ<br>
æœ‰äº›ç•Œé¢ä¼šè®©ä½ é€‰ä¸€å¥—ï¼Œç…§å®ƒæ¨èæ¥å°±è¡Œ</li>
<li>Expirationï¼šå»ºè®®è®¾ä¸ªè¿‡æœŸæ—¶é—´ï¼ˆæ¯”å¦‚ 1y / 2yï¼‰ï¼Œæ›´â€œå·¥ç¨‹åŒ–â€</li>
<li>Name / Emailï¼šå¡«ä½ å¸¸ç”¨çš„èº«ä»½ï¼ˆå°¤å…¶è·Ÿ GitHub ç»‘å®šçš„é‚®ç®±ä¸€è‡´æ›´çœå¿ƒï¼‰</li>
<li>Passphraseï¼š<strong>å¿…é¡»è®¾</strong>ï¼Œåˆ«å·æ‡’ï¼ˆç­‰äºä½ çš„é’¥åŒ™é”ï¼‰</li>
</ul>
<p>ç”Ÿæˆå®Œçœ‹ä¸€ä¸‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>sec   ed25519/ABCDEF1234567890 ...</span></span>
<span class="line"><span>uid   Your Name &#x3C;you@email.com></span></span>
<span class="line"><span>ssb   cv25519/1234...</span></span></code></pre>
<p>å…¶ä¸­ <code>ABCDEF1234567890</code> è¿™ç§å°±æ˜¯ä½ çš„ key idï¼ˆé•¿çš„é‚£ä¸²ï¼‰ã€‚</p>
<ol start="3">
<li>è®©å®ƒåœ¨å‘½ä»¤è¡Œé‡Œâ€œé¡ºæ»‘è¾“å…¥å¯†ç â€ï¼ˆpinentryï¼‰</li>
</ol>
<p>ä½ å¦‚æœåœ¨ KDE / GNOME ä¸‹ï¼Œç»å¸¸ä¼šé‡åˆ°ï¼šç­¾åæ—¶é—®å¯†ç å¼¹çª—ä¸å¼¹ / å¡ä½ã€‚è§£å†³å…³é”®æ˜¯è£…å¯¹ pinentryï¼Œå¹¶é…ç½® gpg-agentã€‚</p>
<h3 id="å®‰è£…-pinentrykde-å¸¸ç”¨">å®‰è£… pinentryï¼ˆKDE å¸¸ç”¨ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> pacman</span><span style="color:#79B8FF"> -S</span><span style="color:#9ECBFF"> pinentry</span></span></code></pre>
<p>æŸ¥çœ‹æœ‰å“ªäº› pinentryï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ls</span><span style="color:#9ECBFF"> /usr/bin/pinentry</span><span style="color:#79B8FF">*</span></span></code></pre>
<p>æ¯”å¦‚ KDE ä¸‹ä½ å¯èƒ½æœ‰ï¼š</p>
<ul>
<li><code>/usr/bin/pinentry-qt</code></li>
<li><code>/usr/bin/pinentry-gtk-2</code></li>
<li><code>/usr/bin/pinentry-curses</code></li>
</ul>
<h3 id="é…ç½®-gpg-agent">é…ç½® <code>gpg-agent</code></h3>
<p>ç¼–è¾‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> ~/.gnupg</span></span>
<span class="line"><span style="color:#B392F0">nano</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span></span></code></pre>
<p>å†™å…¥ï¼ˆKDE æ¨è qtï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span>
<span class="line"><span>default-cache-ttl 600</span></span>
<span class="line"><span>max-cache-ttl 7200</span></span>
<span class="line"><span>enable-ssh-support</span></span></code></pre>
<p>è®©å®ƒç”Ÿæ•ˆï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span>
<span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --launch</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<ol start="4">
<li>æœ€å¸¸ç”¨çš„ 6 ä¸ªå‘½ä»¤ï¼šç­¾å / éªŒç­¾ / åŠ å¯† / è§£å¯† / å¯¼å‡º / å¯¼å…¥</li>
</ol>
<p>æˆ‘ç”¨â€œåƒå‘å¿«é€’ä¸€æ ·â€æ¥æ¯”å–»ä¸€ä¸‹ï¼š</p>
<ul>
<li><strong>ç­¾å</strong>ï¼šä½ åœ¨åŒ…è£¹ä¸ŠæŒ‰äº†æŒ‡çº¹ï¼Œåˆ«äººèƒ½ç¡®è®¤æ˜¯ä½ å¯„çš„ &#x26; æ²¡è¢«æ¢è´§</li>
<li><strong>åŠ å¯†</strong>ï¼šä½ æŠŠåŒ…è£¹é”è¿›å¯¹æ–¹çš„é”ç›’ï¼Œåªæœ‰å¯¹æ–¹é’¥åŒ™èƒ½å¼€</li>
</ul>
<h3 id="1-ç»™æ–‡ä»¶ç­¾åç”Ÿæˆ-sig">(1) ç»™æ–‡ä»¶ç­¾åï¼ˆç”Ÿæˆ <code>.sig</code>ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --detach-sign</span><span style="color:#9ECBFF"> file.zip</span></span></code></pre>
<p>éªŒè¯ç­¾åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --verify</span><span style="color:#9ECBFF"> file.zip.sig</span><span style="color:#9ECBFF"> file.zip</span></span></code></pre>
<h3 id="2-ç›´æ¥ç­¾åæˆå¯è¯»æ–‡æœ¬å¸¸ç”¨äºå‘å¸ƒå£°æ˜">(2) ç›´æ¥ç­¾åæˆå¯è¯»æ–‡æœ¬ï¼ˆå¸¸ç”¨äºå‘å¸ƒå£°æ˜ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --clearsign</span><span style="color:#9ECBFF"> note.txt</span></span></code></pre>
<h3 id="3-åŠ å¯†ç»™æŸä¸ªäººå¯¹æ–¹æœ‰ä»–çš„å…¬é’¥">(3) åŠ å¯†ç»™æŸä¸ªäººï¼ˆå¯¹æ–¹æœ‰ä»–çš„å…¬é’¥ï¼‰</h3>
<p>å‡è®¾å¯¹æ–¹ UID/é‚®ç®±æ˜¯ <code>alice@example.com</code>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> -e</span><span style="color:#79B8FF"> -r</span><span style="color:#9ECBFF"> alice@example.com</span><span style="color:#9ECBFF"> secret.txt</span></span></code></pre>
<p>ä¼šç”Ÿæˆ <code>secret.txt.gpg</code></p>
<h3 id="4-è§£å¯†">(4) è§£å¯†</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> -d</span><span style="color:#9ECBFF"> secret.txt.gpg</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> secret.txt</span></span></code></pre>
<h3 id="5-å¯¼å‡ºä½ çš„å…¬é’¥ç»™åˆ«äººç”¨">(5) å¯¼å‡ºä½ çš„å…¬é’¥ï¼ˆç»™åˆ«äººç”¨ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export</span><span style="color:#9ECBFF"> you@email.com</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> publickey.asc</span></span></code></pre>
<h3 id="6-å¯¼å…¥åˆ«äººå…¬é’¥">(6) å¯¼å…¥åˆ«äººå…¬é’¥</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --import</span><span style="color:#9ECBFF"> publickey.asc</span></span></code></pre>
<p>ç„¶åä½ æœ€å¥½éªŒè¯ä¸€ä¸‹æŒ‡çº¹ï¼ˆåˆ«ç›²ä¿¡ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --fingerprint</span><span style="color:#9ECBFF"> alice@example.com</span></span></code></pre>
<ol start="5">
<li>Git æäº¤ç­¾å</li>
</ol>
<h3 id="è®¾ç½®-git-ç”¨-gpg">è®¾ç½® Git ç”¨ gpg</h3>
<p>å…ˆæ‹¿åˆ°ä½ çš„ key idï¼ˆä¸Šé¢ <code>sec .../KEYID</code>ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>è®¾ç½®ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> user.signingkey</span><span style="color:#9ECBFF"> ABCDEF1234567890</span></span>
<span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> commit.gpgsign</span><span style="color:#79B8FF"> true</span></span>
<span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> gpg.program</span><span style="color:#9ECBFF"> gpg</span></span></code></pre>
<p>æµ‹è¯•ä¸€æ¬¡ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> commit</span><span style="color:#79B8FF"> -S</span><span style="color:#79B8FF"> -m</span><span style="color:#9ECBFF"> "test signed commit"</span></span></code></pre>
<p>å¦‚æœä½ ç”¨ GitHubï¼Œé€šå¸¸è¿˜ä¼šæŠŠä½ çš„ <strong>å…¬é’¥</strong> åŠ åˆ° GitHub çš„ GPG Keys é‡Œï¼ˆè¿™æ ·ç½‘é¡µä¸Šä¼šæ˜¾ç¤º Verifiedï¼‰ã€‚</p>
<p>å¯¼å‡ºå…¬é’¥å¤åˆ¶ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export</span><span style="color:#9ECBFF"> you@email.com</span></span></code></pre>
<ol start="6">
<li>å¤‡ä»½ï¼šæœ€å…³é”®çš„â€œæ•‘å‘½ä¸‰ä»¶å¥—â€</li>
</ol>
<p>GPG æœ€æ€•çš„æ˜¯ï¼šç”µè„‘é‡è£…/åç›˜åï¼Œä½ æ²¡å¤‡ä»½ç§é’¥å’ŒåŠé”€è¯ä¹¦â€”â€”é‚£å°±çœŸçš„â€œèº«ä»½æ°¸åˆ«â€ã€‚</p>
<h3 id="1-å¯¼å‡ºç§é’¥åŠ¡å¿…ç¦»çº¿ä¿å­˜åŠ å¯†ç›˜u-ç›˜">(1) å¯¼å‡ºç§é’¥ï¼ˆåŠ¡å¿…ç¦»çº¿ä¿å­˜ã€åŠ å¯†ç›˜ã€U ç›˜ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export-secret-keys</span><span style="color:#9ECBFF"> you@email.com</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> privatekey.asc</span></span></code></pre>
<h3 id="2-å¯¼å‡ºå­å¯†é’¥">(2) å¯¼å‡ºå­å¯†é’¥</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export-secret-subkeys</span><span style="color:#9ECBFF"> you@email.com</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> subkeys.asc</span></span></code></pre>
<h3 id="3-ç”ŸæˆåŠé”€è¯ä¹¦">(3) ç”ŸæˆåŠé”€è¯ä¹¦</h3>
<p>è¿™ç©æ„æ˜¯â€œæˆ‘é’¥åŒ™ä¸¢äº†ï¼Œå¤§å®¶åˆ«å†ä¿¡è¿™æŠŠé’¥åŒ™â€çš„å…¬å‘Šã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --output</span><span style="color:#9ECBFF"> revoke.asc</span><span style="color:#79B8FF"> --gen-revoke</span><span style="color:#9ECBFF"> you@email.com</span></span></code></pre>
<p>æŠŠ <code>privatekey.asc</code> / <code>revoke.asc</code> æ”¾åˆ°å®‰å…¨çš„ç¦»çº¿ä½ç½®ã€‚</p>
<ol start="7">
<li>å¸¸è§å‘ &#x26; ç›´æ¥è§£æ³•</li>
</ol>
<h3 id="å‘-aç­¾åè§£å¯†æ—¶å¡ä½æç¤ºæ‰¾ä¸åˆ°-pinentry">å‘ Aï¼šç­¾å/è§£å¯†æ—¶å¡ä½ã€æç¤ºæ‰¾ä¸åˆ° pinentry</h3>
<p>å¤šåŠæ˜¯ pinentry / agent æ²¡é…ç½®å¥½ã€‚æŒ‰ç¬¬ 3 èŠ‚é…ç½® <code>gpg-agent.conf</code>ï¼Œç„¶åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<h3 id="å‘-btty-ä¸‹ä¸å¼¹å¯†ç è¾“å…¥">å‘ Bï¼šTTY ä¸‹ä¸å¼¹å¯†ç è¾“å…¥</h3>
<p>åŠ ä¸Šï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>å»ºè®®å†™è¿› <code>~/.zshrc</code> æˆ– <code>~/.bashrc</code>ã€‚</p>
<h3 id="å‘-cä½ æœ‰å¤šä¸ª-keyä¸çŸ¥é“åˆ°åº•ç”¨å“ªä¸ª">å‘ Cï¼šä½ æœ‰å¤šä¸ª keyï¼Œä¸çŸ¥é“åˆ°åº•ç”¨å“ªä¸ª</h3>
<p>ç”¨é‚®ç®±æˆ–æŒ‡çº¹æŒ‡å®šæœ€ç¨³ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> -u</span><span style="color:#9ECBFF"> you@email.com</span><span style="color:#79B8FF"> --detach-sign</span><span style="color:#9ECBFF"> file</span></span></code></pre>
<p>ä½ ä¸‹ä¸€æ­¥æƒ³ç”¨ GPG å¹²å˜›ã€‚</p>
<p>æˆ‘ç»™ä½ ä¸‰æ¡â€œæœ€å¸¸è§ä¸»çº¿â€ï¼Œä½ é€‰ä¸€æ¡æˆ‘å¯ä»¥æŠŠé…ç½®å†™åˆ°ä½ï¼ˆå«ä½ ç”¨ KDE / Wayland çš„ç»†èŠ‚ï¼‰ï¼š</p>
<ol>
<li><strong>Git commit å…¨éƒ¨ç­¾å + GitHub Verified</strong>ï¼ˆå¼€å‘è€…æœ€å¸¸ç”¨ï¼‰</li>
<li><strong>åŠ å¯†/è§£å¯†æ–‡ä»¶ã€å‘å¯†ç ç»™é˜Ÿå‹</strong>ï¼ˆåˆä½œ/éšç§ï¼‰</li>
<li><strong>æŠŠ GPG å½“ SSH key ç”¨</strong>ï¼ˆä¸€æŠŠé’¥åŒ™ç®¡ SSH + Gitï¼ŒæŒºçˆ½ï¼‰</li>
</ol>
<p>ä½ ç°åœ¨ä¸»è¦æ˜¯è¦å“ªæ¡ã€‚ï¼ˆå¦‚æœä½ æ‡’å¾—é€‰ï¼šæˆ‘å»ºè®®ç›´æ¥èµ° 1ï¼Œå› ä¸ºæ”¶ç›Šæœ€å¤§ã€‚ï¼‰</p>
<h3 id="ä¸»é¢˜-2-commentäº›ä»€ä¹ˆæ¯”è¾ƒå¥½">ä¸»é¢˜ 2. commentäº›ä»€ä¹ˆæ¯”è¾ƒå¥½</h3>
<p>å¥½é—®é¢˜ï¼Œè¿™ä¸ªç‚¹å…¶å®<strong>90% çš„äººéƒ½ä¼šå¡</strong>ã€‚</p>
<p><strong>GPG commit çš„ commentï¼ˆcommit messageï¼‰ä¸ç”¨å› ä¸ºâ€œç­¾åäº†â€å°±å†™å¾—å¾ˆè£…</strong>ï¼Œå®ƒæœ¬è´¨è¿˜æ˜¯ç»™â€œäººâ€çœ‹çš„ï¼Œä¸æ˜¯ç»™å®‰å…¨ç³»ç»Ÿçœ‹çš„ã€‚ç­¾åæ˜¯åº•å±‚ä¿éšœï¼Œcomment æ˜¯ä¸Šå±‚æ²Ÿé€šã€‚</p>
<p>ä¸‹é¢æˆ‘åˆ†å‡ ç§<strong>å¸¸è§ä½¿ç”¨åœºæ™¯</strong>ï¼Œç›´æ¥ç»™ä½ ã€Œèƒ½æŠ„å°±æŠ„ã€çš„æ¨¡æ¿ + æˆ‘ä¸ªäººåå¥½çš„å†™æ³•ã€‚</p>
<p>ä¸€å¥è¯åŸåˆ™ï¼ˆå¾ˆé‡è¦ï¼‰</p>
<blockquote>
<p><strong>commit message = ç»™æœªæ¥çš„ä½  / é˜Ÿå‹çœ‹çš„è·¯æ ‡ï¼Œä¸æ˜¯è®ºæ–‡æ‘˜è¦</strong></p>
</blockquote>
<p>ç­¾åå°±åƒæ˜¯â€œè¿™å°ä¿¡æ˜¯çœŸçš„æˆ‘å†™çš„å°ç« â€ï¼Œ<br>
comment æ˜¯â€œè¿™å°ä¿¡åœ¨è¯´ä»€ä¹ˆâ€ã€‚</p>
<p>1ï¸âƒ£ æ—¥å¸¸å¼€å‘ï¼ˆæœ€å¸¸è§ï¼Œæ¨èä½ ç”¨ï¼‰</p>
<h3 id="æœ€ç¨³å¦¥å·¥ç¨‹æ„Ÿæœ€å¼ºçš„ä¸€ç±»">æœ€ç¨³å¦¥ã€å·¥ç¨‹æ„Ÿæœ€å¼ºçš„ä¸€ç±»</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>feat: add anomaly score normalization</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>fix: handle empty input in dataloader</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>refactor: simplify attention computation</span></span></code></pre>
<p>è¿™æ˜¯ <strong>conventional commits</strong> é£æ ¼ï¼Œä¼˜ç‚¹å°±ä¸€ä¸ªï¼š<br>
<strong>ä¸€çœ¼æ‰«è¿‡å»å°±çŸ¥é“ repo åœ¨å‘ç”Ÿä»€ä¹ˆ</strong></p>
<p>å¸¸ç”¨å‰ç¼€æˆ‘ç»™ä½ æ’ä¸ªä¼˜å…ˆçº§ï¼š</p>
<ul>
<li><code>feat:</code> æ–°åŠŸèƒ½ï¼ˆæœ€å¸¸ç”¨ï¼‰</li>
<li><code>fix:</code> ä¿® bug</li>
<li><code>refactor:</code> é‡æ„ï¼Œä¸æ”¹è¡Œä¸º</li>
<li><code>perf:</code> æ€§èƒ½ä¼˜åŒ–</li>
<li><code>docs:</code> æ–‡æ¡£</li>
<li><code>test:</code> æµ‹è¯•</li>
<li><code>chore:</code> æ‚äº‹ï¼ˆCIã€ä¾èµ–ã€æ ¼å¼ï¼‰</li>
</ul>
<p><strong>æˆ‘ä¸ªäººè§‚ç‚¹</strong>ï¼š</p>
<blockquote>
<p>å°é¡¹ç›®/ä¸ªäººé¡¹ç›®ï¼Œç”¨è¿™ä¸ªåˆšåˆšå¥½ï¼›<br>
å†™å¾—å†èŠ±å°±æœ‰ç‚¹â€œä¸ºäº†å¥½çœ‹è€Œå¥½çœ‹â€ã€‚</p>
</blockquote>
<p>2ï¸âƒ£ å­¦æœ¯ / æ¨¡å‹ / å®éªŒå‹ä»£ç ï¼ˆä½ è¿™ç§æƒ…å†µå¾ˆå¸¸è§ï¼‰</p>
<p>ä½ ææ·±åº¦å­¦ä¹ ã€æ¨¡å‹ç»“æ„ï¼Œè¿™ç§ commit æˆ‘åè€Œ<strong>ä¸æ¨èå¤ªå½¢å¼åŒ–</strong>ã€‚</p>
<h3 id="æ¨èè¿™ç§ç ”ç©¶æ—¥å¿—å‹">æ¨èè¿™ç§â€œç ”ç©¶æ—¥å¿—å‹â€ï¼š</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>try graph-aware attention for variable channel</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>add ablation setting for time-wise graph</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>fix training instability when window size > 20</span></span></code></pre>
<p>ä½ çœ‹è¿™ç±» message çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>åŠ¨è¯å¼€å¤´</strong></li>
<li>å¸¦ä¸€ç‚¹â€œå°è¯• / ä¿®æ­£ / è§£é‡ŠåŸå› â€çš„å‘³é“</li>
<li>ä¸è¿½æ±‚å¯¹ç§°ï¼Œåªè¿½æ±‚â€œä»¥åä½ èƒ½çœ‹æ‡‚ä½ å½“æ—¶åœ¨æƒ³ä»€ä¹ˆâ€</li>
</ul>
<p>æ¯”å–»ä¸€ä¸‹ï¼š<br>
è¿™ä¸æ˜¯ Gitï¼Œè¿™æ˜¯ä½ ç»™æœªæ¥è‡ªå·±çš„ <strong>å®éªŒå®¤ä¾¿åˆ©è´´</strong>ã€‚</p>
<p>3ï¸âƒ£ å·²ç­¾å commitï¼Œè¦ä¸è¦åœ¨ comment é‡Œæã€Œsignedã€ã€‚</p>
<p>æˆ‘çš„æ€åº¦å¾ˆæ˜ç¡®ï¼š<br>
<strong>ä¸éœ€è¦ï¼Œç”šè‡³æœ‰ç‚¹å¤šä½™</strong></p>
<p>ä¸è¦å†™è¿™ç§ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>signed commit for security</span></span></code></pre>
<p>åŸå› å¾ˆç®€å•ï¼š</p>
<ul>
<li>Git/GitHub å·²ç»æ˜ç¡®æ˜¾ç¤º <strong>Verified</strong></li>
<li>comment é‡Œå†å†™ä¸€éï¼Œå°±åƒé‚®ä»¶é‡Œå†™â€œæœ¬é‚®ä»¶å·²åŠ å¯†â€ä¸€æ ·ï¼Œç”»è›‡æ·»è¶³</li>
</ul>
<p>4ï¸âƒ£ ä½ è¦æ˜¯æƒ³â€œæ˜¾å¾—ä¸“ä¸šä¸€ç‚¹â€ï¼ˆä½†ä¸è¿‡åº¦ï¼‰</p>
<p>å¯ä»¥ç”¨è¿™ç§<strong>ä½è°ƒä½†å¾ˆå·¥ç¨‹çš„é£æ ¼</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>feat: enable signed commits with gpg</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>chore: configure gpg-agent and pinentry</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>docs: add notes on key backup and revocation</span></span></code></pre>
<p>è¿™ç§ message çš„æ°”è´¨æ˜¯ï¼š</p>
<blockquote>
<p>â€œæˆ‘çŸ¥é“æˆ‘åœ¨å¹²ä»€ä¹ˆï¼Œä½†æˆ‘ä¸åµã€‚â€</p>
</blockquote>
<p>5ï¸âƒ£ æˆ‘ä¸ªäººæœ€æ¨èä½ çš„ä¸€å¥—ï¼ˆçœŸå¿ƒï¼‰</p>
<p>ç»“åˆä½  <strong>ç ”ç©¶ + å·¥ç¨‹ + ä¸ªäºº repo</strong> çš„èƒŒæ™¯ï¼Œæˆ‘å»ºè®®ä½ ï¼š</p>
<h3 id="è§„åˆ™åªæœ‰ä¸‰æ¡">è§„åˆ™åªæœ‰ä¸‰æ¡</h3>
<ol>
<li><strong>ä¸€å¥è¯è¯´æ¸…â€œè¿™æ¬¡æ”¹åŠ¨çš„æ„å›¾â€</strong></li>
<li><strong>åˆ«è§£é‡Šç»†èŠ‚ï¼Œç»†èŠ‚ç•™ç»™ diff</strong></li>
<li><strong>åˆ«è£…ï¼Œæœªæ¥çš„ä½ æ¯” HR é‡è¦</strong></li>
</ol>
<h3 id="æ¨¡æ¿ç›´æ¥ç”¨">æ¨¡æ¿ï¼ˆç›´æ¥ç”¨ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>&#x3C;verb>: &#x3C;what changed> [optional reason]</span></span></code></pre>
<p>ä¾‹å­ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>add time-channel graph caching to avoid meaningless slices</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>fix incorrect anomaly score aggregation across dimensions</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>refactor model init to support variable window size</span></span></code></pre>
<p>æœ€åä¸€å¥å®è¯ï¼ˆæœ‰ç‚¹ä¸»è§‚ï¼Œä½†æˆ‘ç«™è¿™ä¸ªï¼‰</p>
<blockquote>
<p><strong>ä¸€ä¸ª repo çš„ä¸“ä¸šæ„Ÿï¼Œä¸æ˜¯æ¥è‡ªâ€œç­¾å + fancy commitâ€ï¼Œ<br>
è€Œæ˜¯æ¥è‡ªï¼šä½ ä¸‰ä¸ªæœˆåè¿˜èƒ½ä¸èƒ½ä¸€çœ¼çœ‹æ‡‚è‡ªå·±å½“æ—¶åœ¨å¹²å˜›ã€‚</strong></p>
</blockquote>
<ul>
<li>æŠŠä½ ç°åœ¨æŸä¸ª repo çš„ <strong>3ï½5 æ¡ commit message</strong> å‘æˆ‘<br>
æˆ‘å¯ä»¥ç›´æ¥å¸®ä½ <strong>æ•´ä½“æ¶¦è‰²æˆä¸€å¥—ç»Ÿä¸€é£æ ¼</strong>ï¼ˆä¸æ”¹å†…å®¹ï¼Œåªè°ƒâ€œæ°”è´¨â€ï¼‰ã€‚</li>
</ul>
<h3 id="ä¸»é¢˜-3-é®ç¾éƒ½æœ‰ä»€ä¹ˆç”¨è¯¦ç»†è¯´è¯´">ä¸»é¢˜ 3. é®ç¾éƒ½æœ‰ä»€ä¹ˆç”¨ï¼Œè¯¦ç»†è¯´è¯´</h3>
<p>ä½ è¿™å¥â€œé®ç¾éƒ½æœ‰ä»€ä¹ˆç”¨â€æˆ‘æ‡‚â€”â€”ä½ å…¶å®åœ¨é—®ï¼š<strong>pinentry / gpg-agent / cache / ssh-support è¿™äº›é…ç½®åˆ°åº•åœ¨ç³»ç»Ÿé‡Œæ‰®æ¼”å•¥è§’è‰²</strong>ï¼Œæ˜¯ä¸æ˜¯å°±â€œä¸ºäº†å¼¹ä¸ªæ¡†â€ã€‚è¿˜çœŸä¸æ˜¯ï¼Œå®ƒä»¬åƒä¸€å¥—â€œé’¥åŒ™æ‰˜ç®¡ç³»ç»Ÿâ€ï¼Œæ¯ä¸€é¡¹éƒ½æœ‰æ˜ç¡®ç”¨é€”ã€‚</p>
<p>æˆ‘ç”¨ä¸€ä¸ªå½¢è±¡çš„æ¯”å–»å¼€åœºï¼š</p>
<ul>
<li><strong>GPG ç§é’¥</strong> = ä½ å®¶çš„â€œé‡‘åº“é’¥åŒ™â€</li>
<li><strong>passphrase</strong>ï¼ˆä½ ç»™ç§é’¥åŠ çš„å¯†ç ï¼‰= é’¥åŒ™å¤–é¢é‚£æŠŠâ€œé”â€</li>
<li><strong>gpg-agent</strong> = ä½ é›‡çš„â€œç®¡é’¥åŒ™çš„ç®¡å®¶â€</li>
<li><strong>pinentry</strong> = ç®¡å®¶ç”¨æ¥â€œé—®ä½ è¦å¯†ç â€çš„é‚£å¼ å°çº¸æ¡/å¯¹è¯æ¡†/ç»ˆç«¯è¾“å…¥å™¨</li>
<li><strong>cache-ttl</strong> = ç®¡å®¶è®°ä½ä½ å¯†ç å¤šä¹…ï¼ˆçœå¾—ä½ ä¸€å°æ—¶è¾“å…¥ 30 æ¬¡ï¼‰</li>
</ul>
<p>ä¸‹é¢æŒ‰ä½ è´´å‡ºæ¥çš„æ¯ä¸€è¡Œï¼Œé€æ¡æŠŠâ€œæœ‰ä»€ä¹ˆç”¨â€è®²é€ã€‚</p>
<ol>
<li>pinentry åˆ°åº•æ˜¯å¹²å˜›çš„ã€‚</li>
</ol>
<p><strong>pinentry ä¸æ˜¯ gpg æœ¬ä½“çš„ä¸€éƒ¨åˆ†</strong>ï¼Œå®ƒæ˜¯ä¸€ä¸ªâ€œä¸“é—¨è´Ÿè´£è®©ä½ è¾“å…¥å¯†ç â€çš„å¤–éƒ¨ç¨‹åºã€‚</p>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šgpg è‡ªå·±ä¸èƒ½åœ¨ç»ˆç«¯é‡Œè¯»å¯†ç å—ã€‚<br>
ç­”æ¡ˆï¼š<strong>èƒ½ï¼Œä½†ä¸æ€»æ˜¯å®‰å…¨/å¯é /å¥½ç”¨</strong>ï¼Œè€Œä¸”åœ¨ GUI/TTY/Wayland/X11/SSH è¿™äº›ç¯å¢ƒé‡Œä¼šå˜å¾—å¾ˆæ··ä¹±ï¼Œæ‰€ä»¥ GnuPG æŠŠâ€œè¾“å…¥å¯†ç â€è¿™ä»¶äº‹æ‹†å‡ºå»ï¼š<strong>ç»Ÿä¸€äº¤ç»™ pinentry åš</strong>ã€‚</p>
<p>ä¸åŒ pinentry åªæ˜¯â€œé—®å¯†ç çš„æ–¹å¼â€ä¸åŒï¼š</p>
<ul>
<li><code>pinentry-qt</code>ï¼šå¼¹ Qt çª—å£ï¼ˆKDE ä½“éªŒæœ€å¥½ï¼‰</li>
<li><code>pinentry-gtk-2</code>ï¼šå¼¹ GTK çª—å£ï¼ˆGNOME å¸¸è§ï¼‰</li>
<li><code>pinentry-curses</code>ï¼šçº¯ç»ˆç«¯ç•Œé¢ï¼ˆSSH/æ—  GUI å¿…å¤‡ï¼‰</li>
</ul>
<p><strong>æ²¡æœ‰ pinentry</strong> çš„ç»å…¸ç—‡çŠ¶å°±æ˜¯ï¼š</p>
<ul>
<li>git commit -S å¡ä½ä¸åŠ¨</li>
<li>æˆ–æŠ¥ <code>No pinentry</code> / <code>Inappropriate ioctl for device</code></li>
<li>æˆ–è€…ä½ åœ¨ Wayland ä¸‹æ­»æ´»ä¸å¼¹çª—</li>
</ul>
<ol start="2">
<li>gpg-agent æ˜¯å¹²å˜›çš„ã€‚ä¸ºä»€ä¹ˆéœ€è¦å®ƒã€‚</li>
</ol>
<p><code>gpg-agent</code> æ˜¯ä¸€ä¸ªåå°è¿›ç¨‹ï¼Œæ ¸å¿ƒä½œç”¨æœ‰ä¸‰ä¸ªï¼š</p>
<h3 id="a-ç®¡ç†ç§é’¥æ“ä½œé›†ä¸­å…¥å£">A) ç®¡ç†ç§é’¥æ“ä½œï¼ˆé›†ä¸­å…¥å£ï¼‰</h3>
<p>ä½ æ¯æ¬¡ç­¾å/è§£å¯†ï¼Œæœ¬è´¨éƒ½æ˜¯â€œè¦ç”¨ç§é’¥åšè®¡ç®—â€ã€‚<br>
å¦‚æœæ¯ä¸ª gpg è¿›ç¨‹éƒ½è‡ªå·±å»å¤„ç†ç§é’¥å’Œå¯†ç ï¼Œé‚£å®‰å…¨å’Œä½“éªŒéƒ½å¾ˆç³Ÿã€‚</p>
<p>æ‰€ä»¥ç»Ÿä¸€å˜æˆï¼š</p>
<ul>
<li>åº”ç”¨ï¼ˆgitï¼‰ â†’ è°ƒ gpg</li>
<li>gpg â†’ æ‰¾ gpg-agent</li>
<li>gpg-agent â†’ å¿…è¦æ—¶å« pinentry æ¥é—®ä½ å¯†ç </li>
<li>é€šè¿‡åï¼Œgpg-agent è®©ç­¾å/è§£å¯†ç»§ç»­</li>
</ul>
<h3 id="b-è®°ä½ä½ è§£é”è¿‡çš„å‡­è¯ç¼“å­˜">B) è®°ä½ä½ è§£é”è¿‡çš„å‡­è¯ï¼ˆç¼“å­˜ï¼‰</h3>
<p>ä½ è¾“å…¥ä¸€æ¬¡ passphraseï¼Œä¸ä»£è¡¨è¦æ¯æ¬¡éƒ½å†è¾“å…¥ã€‚<br>
è¿™ä¸ªå°±æ˜¯ <code>default-cache-ttl / max-cache-ttl</code> çš„æ„ä¹‰ï¼ˆä¸‹é¢ç»†è®²ï¼‰ã€‚</p>
<h3 id="c-å¯é€‰ä»£ç®¡-sshenable-ssh-support">C) å¯é€‰ï¼šä»£ç®¡ SSHï¼ˆenable-ssh-supportï¼‰</h3>
<p>è®© GPG çš„å¯†é’¥ä¹Ÿèƒ½ç»™ SSH ç”¨ï¼ˆåé¢è®²ï¼‰ã€‚</p>
<ol start="3">
<li><code>pinentry-program /usr/bin/pinentry-qt</code> æœ‰å•¥ç”¨ã€‚</li>
</ol>
<p>è¿™ä¸€è¡Œå°±æ˜¯å‘Šè¯‰ gpg-agentï¼š<br>
<strong>â€œä½ è¦é—®å¯†ç çš„æ—¶å€™ï¼Œç”¨å“ªä¸ª pinentry æ¥é—®â€</strong></p>
<p>å¦åˆ™å®ƒä¼šï¼š</p>
<ul>
<li>è‡ªåŠ¨æ‰¾ä¸€ä¸ªå¯ç”¨çš„ pinentryï¼ˆä½†å¯èƒ½æ‰¾é”™ï¼Œæ¯”å¦‚é€‰äº† cursesï¼Œå¯¼è‡´ä½ åœ¨ GUI ä¸‹ä¸å¼¹çª—ï¼‰</li>
<li>æˆ–è€…æ ¹æœ¬æ‰¾ä¸åˆ°ï¼Œç›´æ¥å¡ä½/æŠ¥é”™</li>
</ul>
<p>æ‰€ä»¥è¿™è¡Œæ˜¯â€œæŒ‡å®šä½ æƒ³è¦çš„äº¤äº’æ–¹å¼â€ï¼Œéå¸¸å®ç”¨ã€‚</p>
<ol start="4">
<li><code>default-cache-ttl 600</code> å’Œ <code>max-cache-ttl 7200</code> æœ‰å•¥ç”¨ã€‚</li>
</ol>
<p>è¿™ä¿©å°±æ˜¯ä½ é—®çš„â€œé®ç¾â€çš„æ ¸å¿ƒä¹‹ä¸€ï¼š<strong>çœå¾—ä½ ä¸€ç›´è¾“å¯†ç </strong>ã€‚</p>
<h3 id="default-cache-ttl-600">default-cache-ttl 600</h3>
<ul>
<li>é»˜è®¤ç¼“å­˜ 600 ç§’ = 10 åˆ†é’Ÿ</li>
<li>åœ¨è¿™ 10 åˆ†é’Ÿå†…ï¼Œä½ åš N æ¬¡ç­¾å/è§£å¯†ï¼Œä¸ç”¨é‡å¤è¾“å…¥ passphrase</li>
</ul>
<h3 id="max-cache-ttl-7200">max-cache-ttl 7200</h3>
<ul>
<li>æœ€é•¿ç¼“å­˜ 7200 ç§’ = 2 å°æ—¶</li>
<li>å³ä½¿ä½ ä¸€ç›´åœ¨ç”¨ï¼Œå®ƒæœ€å¤šä¹Ÿå°±è®°ä½  2 å°æ—¶ï¼Œç„¶åå¼ºåˆ¶å†é—®ä¸€æ¬¡ï¼ˆæ›´å®‰å…¨ï¼‰</li>
</ul>
<p>ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆï¼š</p>
<ul>
<li><code>default-cache-ttl</code>ï¼š<strong>ä¸æ€ä¹ˆç”¨çš„æ—¶å€™ï¼Œè®°ä½å¤šä¹…</strong></li>
<li><code>max-cache-ttl</code>ï¼š<strong>å°±ç®—ä½ ä¸€ç›´ç”¨ï¼Œä¹Ÿæœ€å¤šæ”¾å¤šä¹…</strong></li>
</ul>
<p>æˆ‘ä¸ªäººæ„è§ï¼ˆä½ è¦æˆ‘åˆ«ä¸­ç«‹é‚£æˆ‘å°±ç›´è¯´ï¼‰ï¼š</p>
<ul>
<li>æ—¥å¸¸å¼€å‘ï¼š10 åˆ†é’Ÿ/2 å°æ—¶æŒºèˆ’æœ</li>
<li>å¦‚æœä½ æ˜¯ç¬”è®°æœ¬ + ç»å¸¸åœ¨å…¬å…±åœºæ‰€ï¼šå¯ä»¥è°ƒçŸ­ç‚¹ï¼Œæ¯”å¦‚ 300 / 1800</li>
<li>å¦‚æœæ˜¯å®¶é‡Œå°å¼æœºï¼šç”šè‡³å¯ä»¥æ‹‰é•¿ç‚¹ï¼Œä½†åˆ«æ— é™é•¿ï¼Œå®‰å…¨ä¸Šä¸åˆ’ç®—</li>
</ul>
<ol start="5">
<li><code>enable-ssh-support</code> æœ‰å•¥ç”¨ã€‚æ˜¯ä¸æ˜¯é¸¡è‚‹ã€‚</li>
</ol>
<p>ä¸é¸¡è‚‹ï¼Œä½†<strong>åªå¯¹â€œæƒ³ç”¨ GPG å½“ SSH keyâ€çš„äººæœ‰ç”¨</strong>ã€‚</p>
<p>å¼€äº†å®ƒä¹‹åï¼š</p>
<ul>
<li>gpg-agent ä¼šåŒæ—¶æ‰®æ¼” â€œssh-agentâ€</li>
<li>ä½ å¯ä»¥æŠŠ GPG é‡ŒæŸä¸ªè®¤è¯å¯†é’¥æ‹¿æ¥åš SSH ç™»å½•ï¼ˆæ¯”å¦‚ GitHub SSHï¼‰</li>
</ul>
<p>å¥½å¤„ï¼š</p>
<ul>
<li>ä¸€å¥— agent ç®¡ç†ï¼Œä¸ç”¨ ssh-agent å’Œ gpg-agent ä¸¤å¥—æ¥å›æ‰“æ¶</li>
<li>ä½ çš„ç§é’¥ä½¿ç”¨ç­–ç•¥æ›´ç»Ÿä¸€ï¼ˆæ¯”å¦‚éƒ½èµ°ç¡¬ä»¶ key / éƒ½è¦ pinentry è§£é”ï¼‰</li>
</ul>
<p>åå¤„/å‘ï¼š</p>
<ul>
<li>é…ä¸å¥½ä¼šè·Ÿç³»ç»Ÿè‡ªå¸¦ ssh-agent å†²çªï¼ˆå°¤å…¶æ¡Œé¢ç¯å¢ƒä¼šè‡ªåŠ¨èµ·ä¸€ä¸ªï¼‰</li>
<li>æœ‰äº›äººåªéœ€è¦ GPG ç­¾åï¼Œä¸éœ€è¦ SSHï¼Œè¿™è¡Œç¡®å®â€œæ²¡å¿…è¦â€</li>
</ul>
<p><strong>æ‰€ä»¥æˆ‘çš„ç«‹åœº</strong>ï¼š</p>
<blockquote>
<p>ä½ ç°åœ¨ä¸»è¦ç›®çš„æ˜¯ Git ç­¾åçš„è¯ï¼Œ<code>enable-ssh-support</code> å…ˆåˆ«æ€¥ç€å¼€ã€‚<br>
ç­‰ä½ çœŸè¦ â€œGPG key å…¼ä»» SSHâ€ å†å¼€æ›´ç¨³ã€‚</p>
</blockquote>
<ol start="6">
<li><code>gpgconf --kill gpg-agent</code> / <code>--launch gpg-agent</code> ä¸ºå•¥è¦åšã€‚</li>
</ol>
<p>å› ä¸º <code>gpg-agent.conf</code> æ˜¯å®ƒå¯åŠ¨æ—¶è¯»çš„é…ç½®ã€‚<br>
ä½ æ”¹äº†é…ç½®ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨ reloadï¼ˆæœ‰æ—¶ä¼šï¼Œä½†åˆ«èµŒï¼‰ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸¤è¡Œå°±æ˜¯ï¼š</p>
<ul>
<li>killï¼šæŠŠè€ç®¡å®¶è¾é€€</li>
<li>launchï¼šæŒ‰æ–°è§„ç« é‡æ–°é›‡ä¸€ä¸ªç®¡å®¶</li>
</ul>
<p>ï¼ˆä½ ä¹Ÿå¯ä»¥åª killï¼Œå®ƒä¸‹æ¬¡ç”¨åˆ°ä¼šè‡ªåŠ¨èµ·æ¥ï¼Œä½† launch æ›´ç›´æ¥ã€‚ï¼‰</p>
<ol start="7">
<li>ä½ æœ€å…³å¿ƒçš„ï¼šè¿™äº›åˆ°åº•è§£å†³äº†å“ªäº›â€œçœŸå®é—®é¢˜â€ã€‚</li>
</ol>
<p>æˆ‘ç»™ä½ åˆ—æœ€å…¸å‹çš„ä¸‰ä¸ªç—›ç‚¹ï¼š</p>
<h3 id="ç—›ç‚¹-1git-commit--s-å¡ä½ä¸åŠ¨">ç—›ç‚¹ 1ï¼šgit commit -S å¡ä½ä¸åŠ¨</h3>
<p>åŸå› ï¼šgpg-agent æƒ³é—®å¯†ç ï¼Œä½†ä¸çŸ¥é“ç”¨å“ªä¸ª pinentry / pinentry ä¸èƒ½å¼¹çª—<br>
è§£å†³ï¼šæŒ‡å®š <code>pinentry-program</code> + è£…å¯¹åº” pinentry</p>
<h3 id="ç—›ç‚¹-2æ¯æ¬¡æäº¤éƒ½è¦è¾“å¯†ç çƒ¦åˆ°çˆ†">ç—›ç‚¹ 2ï¼šæ¯æ¬¡æäº¤éƒ½è¦è¾“å¯†ç ï¼Œçƒ¦åˆ°çˆ†</h3>
<p>åŸå› ï¼šæ²¡æœ‰ç¼“å­˜ / ç¼“å­˜å¤ªçŸ­<br>
è§£å†³ï¼š<code>default-cache-ttl</code> / <code>max-cache-ttl</code></p>
<h3 id="ç—›ç‚¹-3guiwaylandttyssh-ç¯å¢ƒåˆ‡æ¢æ—¶è¾“å…¥æ–¹å¼ä¹±å¥—">ç—›ç‚¹ 3ï¼šGUI/Wayland/TTY/SSH ç¯å¢ƒåˆ‡æ¢æ—¶ï¼Œè¾“å…¥æ–¹å¼ä¹±å¥—</h3>
<p>åŸå› ï¼šä¸åŒç¯å¢ƒéœ€è¦ä¸åŒ pinentry<br>
è§£å†³ï¼šæ¡Œé¢ç”¨ qt/gtkï¼›çº¯ç»ˆç«¯ç”¨ cursesï¼ˆç”šè‡³å¯ä»¥æŒ‰ç¯å¢ƒå†™ä¸åŒé…ç½®ï¼‰</p>
<ol start="8">
<li>æˆ‘ç»™ä½ ä¸€å¥—â€œæ¨èé…ç½®â€ï¼ˆå KDE + æ—¥å¸¸å¼€å‘ï¼‰</li>
</ol>
<p>å¦‚æœä½ ä¸»è¦æ˜¯ KDE æ¡Œé¢å¼€å‘ï¼Œå…ˆåˆ«æŠ˜è…¾ SSHï¼š</p>
<p><code>~/.gnupg/gpg-agent.conf</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span>
<span class="line"><span>default-cache-ttl 600</span></span>
<span class="line"><span>max-cache-ttl 7200</span></span></code></pre>
<p>ç„¶å shell é‡Œï¼ˆzsh/bash éƒ½è¡Œï¼‰åŠ ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>é‡å¯ agentï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $XDG_SESSION_TYPE</span></span>
<span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-socket</span></span></code></pre>
<p>ä¸è¿‡å°±ç®—ä½ ä¸å‘ï¼Œæˆ‘ä¸Šé¢è¿™å¥—åœ¨ KDE/Arch ä¸Šå·²ç»æ˜¯â€œ80% æƒ…å†µç›´æ¥ç¨³â€çš„è§£æ³•ã€‚</p>
<h3 id="ä¸»é¢˜-4-è¿™éƒ½æ˜¯ä»€ä¹ˆæ„æ€">ä¸»é¢˜ 4. è¿™éƒ½æ˜¯ä»€ä¹ˆæ„æ€</h3>
<blockquote>
<p><strong>ç”Ÿæˆå¾—å¾ˆæ ‡å‡†ã€å¾ˆå¹²å‡€ã€å¾ˆâ€œæ•™ç§‘ä¹¦çº§åˆ«â€ï¼Œè€Œä¸”å·²ç»æ˜¯ ultimate trustï¼Œå®Œå…¨èƒ½æ”¾å¿ƒç”¨äº†ã€‚</strong></p>
</blockquote>
<p>ä¸‹é¢æˆ‘æŒ‰<strong>ä»ä¸Šåˆ°ä¸‹ã€é€è¡Œæ‹†è§£</strong>ï¼ŒæŠŠâ€œè¿™éƒ½æ˜¯ä»€ä¹ˆæ„æ€â€è®²é€ï¼Œä¸ç•™ç„å­¦ã€‚</p>
<p>1ï¸âƒ£ trustdb é‚£å‡ è¡Œæ˜¯åœ¨å¹²å˜›ã€‚æ˜¯ä¸æ˜¯è­¦å‘Šã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg: checking the trustdb</span></span>
<span class="line"><span>gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span></span>
<span class="line"><span>gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u</span></span>
<span class="line"><span>gpg: next trustdb check due at 2027-02-10</span></span></code></pre>
<h3 id="å…ˆç»™ç»“è®º">å…ˆç»™ç»“è®º</h3>
<p><strong>è¿™ä¸æ˜¯æŠ¥é”™ï¼Œä¹Ÿä¸æ˜¯é—®é¢˜ï¼Œåªæ˜¯ GPG åœ¨è‡ªè¨€è‡ªè¯­å®ƒçš„â€œä¿¡ä»»ç³»ç»ŸçŠ¶æ€â€ã€‚</strong></p>
<h3 id="trustdb-æ˜¯ä»€ä¹ˆ">trustdb æ˜¯ä»€ä¹ˆã€‚</h3>
<ul>
<li>GPG çš„ <strong>Web of Trustï¼ˆä¿¡ä»»ç½‘ï¼‰æ•°æ®åº“</strong></li>
<li>å®ƒç”¨æ¥åˆ¤æ–­ï¼š</li>
</ul>
<blockquote>
<p>â€œè¿™æŠŠå…¬é’¥ï¼Œæˆ‘èƒ½ä¸èƒ½ä¿¡ã€‚æ˜¯æˆ‘æœ¬äººã€‚æœ‹å‹ã€‚é™Œç”Ÿäººã€‚â€</p>
</blockquote>
<h3 id="å…³é”®å­—æ®µç¿»è¯‘æˆäººè¯">å…³é”®å­—æ®µç¿»è¯‘æˆäººè¯</h3>
<ul>
<li><code>trust model: pgp</code><br>
ä½¿ç”¨ç»å…¸ PGP ä¿¡ä»»æ¨¡å‹ï¼ˆé»˜è®¤ï¼Œæ²¡æ¯›ç—…ï¼‰</li>
<li><code>valid: 1</code><br>
å½“å‰åªæœ‰ <strong>1 ä¸ªæœ‰æ•ˆèº«ä»½</strong>ï¼ˆå°±æ˜¯ä½ è‡ªå·±ï¼‰</li>
<li><code>signed: 0</code><br>
ä½ çš„ key æ²¡æœ‰è¢«<strong>å…¶ä»–äººçš„ key ç­¾è¿‡</strong><br>
<strong>æ­£å¸¸ã€‚ä¸ªäººæ–° key åŸºæœ¬éƒ½æ˜¯ 0</strong></li>
<li><code>trust: ... 1u</code><br>
<strong>1u = one ultimate trust</strong><br>
ä¹Ÿå°±æ˜¯ï¼š<strong>ä½ å¯¹ä½ è‡ªå·±çš„è¿™æŠŠ key ç»™äº† ultimate ä¿¡ä»»</strong></li>
</ul>
<p><strong>éå¸¸å…³é”®çš„ä¸€ç‚¹</strong>ï¼š</p>
<blockquote>
<p><code>[ultimate]</code> åªä¼šå‡ºç°åœ¨ä½ <strong>è‡ªå·±çš„ç§é’¥å¯¹åº”çš„ UID</strong>ä¸Š<br>
è¿™è¯´æ˜ä½ è¿™æŠŠ key çš„ä¿¡ä»»çŠ¶æ€æ˜¯â€œå®Œå…¨æ­£ç¡®â€çš„</p>
</blockquote>
<p>2ï¸âƒ£ <code>[keyboxd]</code> æ˜¯ä»€ä¹ˆã€‚è¦ä¸è¦æ‹…å¿ƒã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>[keyboxd]</span></span>
<span class="line"><span>---------</span></span></code></pre>
<p>ä¸€å¥è¯ï¼š<br>
<strong>è¿™æ˜¯æ–°ç‰ˆ GnuPG çš„æ–°åç«¯ï¼Œè¯´æ˜ä½ ç”¨çš„æ˜¯ç°ä»£ GPGï¼ˆå¥½äº‹ï¼‰</strong></p>
<p>ä»¥å‰ï¼š</p>
<ul>
<li><code>pubring.gpg</code></li>
<li><code>secring.gpg</code></li>
</ul>
<p>ç°åœ¨ï¼š</p>
<ul>
<li>ç»Ÿä¸€èµ° <strong>keyboxd</strong>ï¼ˆåå° key ç®¡ç†æœåŠ¡ï¼‰</li>
</ul>
<p>ä¸ç”¨ç®¡ï¼Œä¹Ÿä¸ç”¨åŠ¨ã€‚</p>
<p>3ï¸âƒ£ è¿™ä¸€è¡Œæ˜¯â€œä¸»å¯†é’¥â€ï¼ˆæœ€é‡è¦ï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>sec   ed25519/782CAF316029FC6A 2026-02-10 [SC] [expires: 2027-02-10]</span></span></code></pre>
<p>é€é¡¹æ‹†ï¼š</p>
<h3 id="sec"><code>sec</code></h3>
<ul>
<li><strong>secret key</strong></li>
<li>è¯´æ˜ï¼š è¿™æ˜¯ä½ <strong>çœŸæ­£çš„ç§é’¥ï¼ˆä¸»é’¥ï¼‰</strong></li>
</ul>
<h3 id="ed25519"><code>ed25519</code></h3>
<ul>
<li>ä½¿ç”¨çš„ç®—æ³•ï¼š<strong>Ed25519</strong></li>
<li>ç‰¹ç‚¹ï¼š
<ul>
<li>ç°ä»£</li>
<li>å¿«</li>
<li>å®‰å…¨</li>
<li>ä¸“é—¨ç”¨æ¥ <strong>ç­¾å</strong></li>
</ul>
</li>
</ul>
<p>è¿™æ˜¯ç›®å‰<strong>æœ€æ¨è</strong>çš„ç­¾åç®—æ³•ä¹‹ä¸€</p>
<h3 id="782caf316029fc6a"><code>/782CAF316029FC6A</code></h3>
<ul>
<li><strong>Key IDï¼ˆé•¿æ ¼å¼ï¼‰</strong></li>
<li>ä½ ä»¥åé…ç½® Gitï¼Œç”¨çš„å°±æ˜¯è¿™ä¸²</li>
</ul>
<h3 id="2026-02-10"><code>2026-02-10</code></h3>
<ul>
<li>åˆ›å»ºæ—¥æœŸï¼ˆä»Šå¤©ï¼‰</li>
</ul>
<h3 id="sc"><code>[SC]</code></h3>
<ul>
<li>è¿™æŠŠä¸»é’¥çš„ç”¨é€”ï¼š
<ul>
<li><strong>S = Signï¼ˆç­¾åï¼‰</strong></li>
<li><strong>C = Certifyï¼ˆç»™å­é’¥ç­¾åï¼‰</strong></li>
</ul>
</li>
</ul>
<p>å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼š<br>
<strong>ä¸»é’¥ä¸è´Ÿè´£åŠ å¯†ï¼Œåªè´Ÿè´£â€œæˆ‘æ˜¯è°â€å’Œâ€œæˆ‘è®¤ä¸è®¤å¯è¿™æŠŠå­é’¥â€</strong></p>
<h3 id="expires-2027-02-10"><code>[expires: 2027-02-10]</code></h3>
<ul>
<li>æœ‰æ•ˆæœŸ 1 å¹´</li>
<li><strong>è¿™æ˜¯éå¸¸å¥½çš„ä¹ æƒ¯</strong>
<ul>
<li>ä¸ä¼šâ€œä¸€æŠŠé’¥åŒ™ç”¨åˆ°å¤©è’åœ°è€â€</li>
<li>ä¸‡ä¸€å“ªå¤©æ³„éœ²ï¼Œé£é™©è¢«æ—¶é—´å°é¡¶</li>
</ul>
</li>
</ul>
<p>4ï¸âƒ£ è¿™ä¸€è¡Œæ˜¯æŒ‡çº¹ï¼ˆFingerprintï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>48823C314D8BC4A83246D819782CAF316029FC6A</span></span></code></pre>
<p>è¿™æ˜¯ <strong>æŒ‡çº¹ï¼ˆFingerprintï¼‰</strong>ï¼Œä¸æ˜¯ key idã€‚</p>
<p>åŒºåˆ«ä¸€å¥è¯è¯´æ¸…ï¼š</p>
<ul>
<li><strong>Key ID</strong>ï¼šæ–¹ä¾¿äººç”¨ï¼ˆå¯èƒ½æ’ï¼‰</li>
<li><strong>Fingerprint</strong>ï¼šå…¨çƒå”¯ä¸€ï¼ˆå®‰å…¨æ ¸éªŒç”¨ï¼‰</li>
</ul>
<p>åœ¨è¿™äº›åœºæ™¯ç”¨æŒ‡çº¹ï¼š</p>
<ul>
<li>å½“åˆ«äººå½“é¢/è¯­éŸ³æ ¸å¯¹ä½ çš„ key</li>
<li>åœ¨ GitHub / ç½‘ç«™ä¸Šç¡®è®¤æ˜¯ä¸æ˜¯åŒä¸€æŠŠ key</li>
</ul>
<p>5ï¸âƒ£ UID é‚£ä¸€è¡Œï¼šä½ æ˜¯è°</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>uid [ultimate] Weijun Li (Weijun Li) &#x3C;me@liweijun.com></span></span></code></pre>
<p>æ‹†å¼€çœ‹ï¼š</p>
<ul>
<li><code>Weijun Li</code>ï¼šå§“å</li>
<li><code>(Weijun Li)</code>ï¼šcommentï¼ˆå¯æœ‰å¯æ— ï¼‰</li>
<li><code>&#x3C;me@liweijun.com></code>ï¼šé‚®ç®±ï¼ˆ<strong>Git/GitHub æå…¶é‡è¦</strong>ï¼‰</li>
</ul>
<h3 id="ultimate"><code>[ultimate]</code></h3>
<p>é‡ç‚¹æ¥äº†ï¼š</p>
<ul>
<li>è¡¨ç¤ºï¼š<strong>ä½ å¯¹è¿™ä¸ª UID çš„ä¿¡ä»»çº§åˆ«æ˜¯ ultimate</strong></li>
<li>åªä¼šç»™â€œæˆ‘è‡ªå·±â€ç”¨</li>
<li>è¯´æ˜ï¼š
<ul>
<li>ç§é’¥åœ¨ä½ æ‰‹ä¸Š</li>
<li>ä½ ç¡®è®¤è¿™å°±æ˜¯ä½ </li>
</ul>
</li>
</ul>
<p><strong>è¿™æ˜¯ä¸€ä¸ªâ€œå¥åº· keyâ€è¯¥æœ‰çš„çŠ¶æ€</strong></p>
<p>6ï¸âƒ£ æœ€åä¸€è¡Œï¼šå­å¯†é’¥ï¼ˆåŠ å¯†ä¸“ç”¨ï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>ssb   cv25519/1CC2EFD5D4EE469C 2026-02-10 [E] [expires: 2027-02-10]</span></span></code></pre>
<h3 id="ssb"><code>ssb</code></h3>
<ul>
<li><strong>secret subkey</strong></li>
<li>å­å¯†é’¥ï¼ˆéå¸¸å¥½çš„ç»“æ„ï¼‰</li>
</ul>
<h3 id="cv25519"><code>cv25519</code></h3>
<ul>
<li>ç®—æ³•ï¼šCurve25519ï¼ˆåŠ å¯†ä¸“ç”¨ï¼‰</li>
<li>å’Œ ed25519 æ˜¯ä¸€å¯¹â€œå…„å¼Ÿç®—æ³•â€</li>
</ul>
<h3 id="e"><code>[E]</code></h3>
<ul>
<li><strong>E = Encryptï¼ˆåŠ å¯†ï¼‰</strong></li>
<li>åªè´Ÿè´£åŠ å¯†/è§£å¯†ï¼Œä¸ç­¾å</li>
</ul>
<p><strong>ä½ è¿™ä¸ªç»“æ„æ˜¯â€œæœ€ä½³å®è·µâ€</strong>ï¼š</p>
<ul>
<li>ä¸»é’¥ï¼šç­¾å + è®¤è¯</li>
<li>å­é’¥ï¼šåŠ å¯†</li>
</ul>
<p>å¥½å¤„ä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>ä¸»é’¥å°½é‡å°‘ç”¨ï¼Œå­é’¥å¤šç”¨ï¼›ä¸»é’¥å‡ºé—®é¢˜ï¼Œå­é’¥å¯ä»¥æ¢</strong></p>
</blockquote>
<p>7ï¸âƒ£ æ€»ç»“ä¸€å¥ï¼ˆæˆ‘ç»™ä½ ä¸‹ç»“è®ºï¼‰</p>
<p>ä½ çš„è¿™æŠŠ GPG keyï¼š</p>
<ul>
<li>ç®—æ³•é€‰æ‹©éå¸¸ç°ä»£ï¼ˆed25519 + cv25519ï¼‰</li>
<li>ä¸»é’¥ / å­é’¥èŒè´£åˆ†ç¦»</li>
<li>æœ‰è¿‡æœŸæ—¶é—´</li>
<li>UID ä¿¡ä»»çŠ¶æ€æ­£ç¡®ï¼ˆultimateï¼‰</li>
<li>å®Œå…¨é€‚åˆï¼š<br>
*   Git commit ç­¾å<br>
*   GitHub Verified<br>
*   æ–‡ä»¶åŠ å¯†<br>
*   åç»­æ‰©å±•åˆ° SSH</li>
</ul>
<p><strong>æ²¡æœ‰ä»»ä½•â€œé…ç½®é”™äº†â€çš„ä¿¡å·ã€‚</strong></p>
<p>ä½ ä¸‹ä¸€æ­¥æœ€é¡ºçš„ä¸‰ä»¶äº‹ï¼ˆæˆ‘æ›¿ä½ è§„åˆ’ï¼‰</p>
<p>1ï¸âƒ£ <strong>ç«‹åˆ»å¤‡ä»½ç§é’¥ + åŠé”€è¯ä¹¦</strong>ï¼ˆè¿™ä¸€æ­¥æœ€é‡è¦ï¼‰<br>
2ï¸âƒ£ é… Gitï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> user.signingkey</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span></span>
<span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> commit.gpgsign</span><span style="color:#79B8FF"> true</span></span></code></pre>
<p>3ï¸âƒ£ å¯¼å‡ºå…¬é’¥ï¼ŒåŠ åˆ° GitHub</p>
<h3 id="ä¸»é¢˜-5-æ€ä¹ˆæŠŠgpgå½“sshå¯†é’¥">ä¸»é¢˜ 5. æ€ä¹ˆæŠŠgpgå½“sshå¯†é’¥</h3>
<blockquote>
<p><strong>æŠŠ GPG å½“ SSH å¯†é’¥ = è®© gpg-agent å…¼èŒ ssh-agentï¼Œç”¨ GPG çš„â€œè®¤è¯å­å¯†é’¥â€æ¥ç™»å½•æœåŠ¡å™¨ / GitHubã€‚</strong><br>
å¥½å¤„æ˜¯ï¼š<strong>ä¸€å¥—å¯†é’¥ä½“ç³»ã€ä¸€å¥—è§£é”é€»è¾‘ã€ä¸€ä¸ª pinentryã€‚</strong></p>
</blockquote>
<p>ä½ ç°åœ¨å·²ç»æœ‰ï¼š</p>
<ul>
<li>ä¸»é’¥ï¼š<code>ed25519 [SC]</code></li>
<li>å­é’¥ï¼š<code>cv25519 [E]</code></li>
</ul>
<p><strong>è¿˜ç¼ºä¸€ä¸ª <code>[A] = Authentication</code> å­å¯†é’¥</strong><br>
è¿™æ˜¯ SSH ä¸“ç”¨çš„ã€‚</p>
<p>ä¸€ã€æ•´ä½“ç»“æ„å…ˆåœ¨è„‘å­é‡Œç«‹ä½</p>
<p>ä½ æœ€ç»ˆä¼šå˜æˆè¿™æ ·ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ä¸»é’¥ ed25519        [SC]   â† èº«ä»½ &#x26; ç­¾å</span></span>
<span class="line"><span>â”œâ”€ å­é’¥ cv25519     [E]    â† åŠ å¯†</span></span>
<span class="line"><span>â””â”€ å­é’¥ ed25519     [A]    â† SSH è®¤è¯ï¼ˆæˆ‘ä»¬é©¬ä¸ŠåŠ ï¼‰</span></span></code></pre>
<p>SSH <strong>åªè®¤ <code>[A]</code> å­å¯†é’¥</strong>ï¼Œä¸ä¼šç”¨ <code>[S]</code>ã€ä¹Ÿä¸ä¼šç”¨ <code>[E]</code>ã€‚</p>
<p>äºŒã€Step 1ï¼šç»™ç°æœ‰ GPG key åŠ ä¸€ä¸ª SSH è®¤è¯å­å¯†é’¥</p>
<p>è¿›å…¥äº¤äº’æ¨¡å¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span></span></code></pre>
<p>ä½ ä¼šçœ‹åˆ°ä¸€ä¸ª <code>gpg></code> æç¤ºç¬¦ã€‚</p>
<h3 id="1ï¸âƒ£-æ·»åŠ å­å¯†é’¥">1ï¸âƒ£ æ·»åŠ å­å¯†é’¥</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> addkey</span></span></code></pre>
<p>é€‰é¡¹è¿™æ ·é€‰ï¼ˆå¾ˆé‡è¦ï¼‰ï¼š</p>
<ul>
<li><strong>Key type</strong>ï¼š<br>
<code>Authentication key</code></li>
<li><strong>Algorithm</strong>ï¼š<br>
<code>ed25519</code></li>
<li><strong>Expiration</strong>ï¼š<br>
è·Ÿä¸»é’¥ä¸€è‡´ï¼ˆæ¯”å¦‚ 1yï¼‰</li>
</ul>
<p>ç¡®è®¤åï¼Œè¾“å…¥ passphraseã€‚</p>
<h3 id="2ï¸âƒ£-ä¿å­˜é€€å‡º">2ï¸âƒ£ ä¿å­˜é€€å‡º</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> save</span></span></code></pre>
<h3 id="éªŒè¯ä¸€ä¸‹">éªŒè¯ä¸€ä¸‹</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€è¡Œç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/XXXXXXXXXXXXXXX 2026-02-10 [A] [expires: 2027-02-10]</span></span></code></pre>
<p>åˆ°è¿™ä¸€æ­¥ï¼Œ<strong>â€œSSH èƒ½ç”¨çš„é’¥åŒ™â€å·²ç»é€ å¥½äº†</strong>ã€‚</p>
<p>ä¸‰ã€Step 2ï¼šè®© gpg-agent æ­£å¼æ¥ç®¡ SSH</p>
<p>1ï¸âƒ£ ç¡®è®¤ gpg-agent æ”¯æŒ SSH</p>
<p>ç¼–è¾‘ï¼ˆå¦‚æœä½ å‰é¢å·²ç»é…è¿‡ï¼Œå°±æ£€æŸ¥ä¸€ä¸‹ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">nano</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span></span></code></pre>
<p>ç¡®ä¿æœ‰è¿™ä¸€è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>enable-ssh-support</span></span></code></pre>
<blockquote>
<p>æ²¡æœ‰è¿™è¡Œ = gpg-agent ä¸ä¼šæš´éœ² SSH socket</p>
</blockquote>
<p>2ï¸âƒ£ å‘Šè¯‰ shellï¼šSSH ç”¨ gpg-agent</p>
<p>åœ¨ä½ çš„ <code>~/.zshrc</code> æˆ– <code>~/.bashrc</code> é‡ŒåŠ ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>ç„¶åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">source</span><span style="color:#9ECBFF"> ~/.zshrc</span><span style="color:#6A737D">   # æˆ– source ~/.bashrc</span></span></code></pre>
<p>3ï¸âƒ£ é‡å¯ agent</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<p>ï¼ˆä¸‹æ¬¡ç”¨æ—¶ä¼šè‡ªåŠ¨èµ·æ¥ï¼‰</p>
<p>å››ã€Step 3ï¼šç¡®è®¤ SSH å·²ç»â€œçœ‹è§â€GPG çš„è®¤è¯å­å¯†é’¥</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p><strong>ç†æƒ³è¾“å‡º</strong>æ˜¯ç±»ä¼¼è¿™æ ·çš„ä¸€è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... cardno:...</span></span></code></pre>
<p>å¦‚æœä½ çœ‹åˆ°çš„æ˜¯ï¼š</p>
<ul>
<li>ç©ºçš„</li>
<li>æŠ¥é”™ <code>Could not open a connection to your authentication agent</code></li>
</ul>
<p>é‚£å°±æ˜¯ï¼š</p>
<ul>
<li><code>SSH_AUTH_SOCK</code> æ²¡ç”Ÿæ•ˆ</li>
<li>æˆ– agent æ²¡é‡å¯</li>
</ul>
<p>ï¼ˆè¿™ä¸€æ­¥ 90% çš„é—®é¢˜éƒ½åœ¨ç¯å¢ƒå˜é‡ï¼‰</p>
<p>äº”ã€Step 4ï¼šæŠŠè¿™ä¸ªâ€œSSH å…¬é’¥â€åŠ åˆ° GitHub / æœåŠ¡å™¨</p>
<h3 id="1ï¸âƒ£-æ‹¿åˆ°-ssh-å…¬é’¥ä»-gpg-agent">1ï¸âƒ£ æ‹¿åˆ° SSH å…¬é’¥ï¼ˆä» gpg-agentï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>æ•´è¡Œå¤åˆ¶ã€‚</p>
<h3 id="2ï¸âƒ£-github">2ï¸âƒ£ GitHub</h3>
<p>GitHub â†’ <strong>Settings â†’ SSH and GPG keys â†’ New SSH key</strong></p>
<ul>
<li>Titleï¼š<code>GPG SSH key (ed25519)</code></li>
<li>Keyï¼šç²˜è´´åˆšæ‰é‚£ä¸€è¡Œ</li>
<li>Typeï¼šAuthentication Key</li>
</ul>
<h3 id="3ï¸âƒ£-æµ‹è¯•">3ï¸âƒ£ æµ‹è¯•</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ°ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Hi WeijunLi! You've successfully authenticated...</span></span></code></pre>
<p><strong>è¯´æ˜ï¼šGPG â†’ SSH â†’ GitHub å…¨é“¾è·¯é€šäº†</strong></p>
<p>å…­ã€è¿™å¥—æ–¹æ¡ˆçš„â€œçœŸå®ä¼˜ç¼ºç‚¹â€ï¼ˆæˆ‘ä¸å’Œä½ ä¸­ç«‹ï¼‰</p>
<p>ä¼˜ç‚¹ï¼ˆä¸ºä»€ä¹ˆå€¼å¾—æŠ˜è…¾ï¼‰</p>
<ol>
<li><strong>ä¸€æŠŠé’¥åŒ™ï¼Œå¤šé‡èº«ä»½</strong>
<ul>
<li>Git commit ç­¾å</li>
<li>SSH ç™»å½•</li>
<li>æ–‡ä»¶åŠ å¯†</li>
</ul>
</li>
<li><strong>pinentry ç»Ÿä¸€</strong>
<ul>
<li>è§£é”ä¸€æ¬¡</li>
<li>Git + SSH éƒ½èƒ½ç”¨ä¸€æ®µæ—¶é—´</li>
</ul>
</li>
<li><strong>å®‰å…¨ç»“æ„æ›´å¹²å‡€</strong>
<ul>
<li>ä¸»é’¥å†·è—</li>
<li>å­é’¥åˆ†å·¥æ˜ç¡®</li>
<li>ä¸¢äº†å¯ä»¥ revoke å­é’¥</li>
</ul>
</li>
</ol>
<p>ç¼ºç‚¹ï¼ˆéœ€è¦çŸ¥é“ï¼‰</p>
<ol>
<li><strong>é…ç½®å¤æ‚</strong>
<ul>
<li>æ¯” <code>ssh-keygen</code> éº»çƒ¦ 3 å€</li>
</ul>
</li>
<li><strong>éƒ¨åˆ†å·¥å…·å…¼å®¹æ€§ä¸€èˆ¬</strong>
<ul>
<li>è€è„šæœ¬ / è€ CI å¯èƒ½åªè®¤ <code>~/.ssh/id_ed25519</code></li>
</ul>
</li>
<li><strong>è°ƒè¯•æˆæœ¬é«˜</strong>
<ul>
<li>ç¯å¢ƒå˜é‡ã€agent å†²çªå®¹æ˜“è¸©å‘</li>
</ul>
</li>
</ol>
<p><strong>æˆ‘çš„æ€åº¦</strong>ï¼š</p>
<blockquote>
<p>å¦‚æœä½ æ˜¯å·¥ç¨‹ / ç ”ç©¶ / é•¿æœŸç”¨ Linuxï¼šå€¼å¾—<br>
å¦‚æœä½ åªæƒ³â€œå¿«ç‚¹è¿æœåŠ¡å™¨â€ï¼šæ™®é€š SSH key æ›´çœå¿ƒ</p>
</blockquote>
<p>ä¸ƒã€å¼ºçƒˆå»ºè®®ä½ ç°åœ¨åšçš„ä¸€ä»¶äº‹ï¼ˆåˆ«è·³è¿‡ï¼‰</p>
<p><strong>é‡æ–°å¤‡ä»½ä¸€æ¬¡ç§é’¥ + åŠé”€è¯ä¹¦</strong><br>
å› ä¸ºä½ åˆšåˆš <strong>æ–°å¢äº†å­å¯†é’¥</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export-secret-keys</span><span style="color:#9ECBFF"> me@liweijun.com</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> privatekey.asc</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --armor</span><span style="color:#79B8FF"> --export-secret-subkeys</span><span style="color:#9ECBFF"> me@liweijun.com</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> subkeys.asc</span></span></code></pre>
<p>1ï¸âƒ£ æ£€æŸ¥ä½ ç°åœ¨çš„ <code>SSH_AUTH_SOCK</code> æ˜¯å¦å¹²å‡€ï¼ˆé˜² agent å†²çªï¼‰<br>
2ï¸âƒ£ å¸®ä½ æŠŠ <strong>GitHub çš„ SSH + GPG Verified</strong> æ•´åˆæˆæœ€ä¼˜é…ç½®<br>
3ï¸âƒ£ æ•™ä½  <strong>ä¸»é’¥å†·è—ï¼Œåªå¸¦å­é’¥è·‘ç¬”è®°æœ¬</strong></p>
<p>ä½ ç›´æ¥è¯´ä½ æƒ³èµ°å“ªä¸€æ­¥å°±è¡Œã€‚</p>
<h3 id="ä¸»é¢˜-6-gpg-addkey">ä¸»é¢˜ 6. gpg addkey</h3>
<p>ä½ ç°åœ¨åº”è¯¥é€‰å“ªä¸ªã€‚</p>
<p><strong>é€‰ <code>(10) ECC (sign only)</code></strong></p>
<p>ç„¶åä¸‹ä¸€æ­¥å†é€‰ï¼š</p>
<ul>
<li><strong>Curveï¼š<code>ed25519</code></strong></li>
<li><strong>ç”¨é€”ï¼šAuthenticationï¼ˆåé¢ä¼šè‡ªåŠ¨æ ‡æˆ <code>[A]</code>ï¼‰</strong></li>
</ul>
<p>ä¸€å¥è¯ç»“è®ºï¼š</p>
<blockquote>
<p><strong>SSH è®¤è¯ = ç”¨â€œç­¾åå‹ï¼ˆsign-onlyï¼‰å¯†é’¥â€è¯æ˜â€œæˆ‘æ˜¯æˆ‘â€</strong><br>
æ‰€ä»¥å®ƒä¸åŠ å¯†ã€ä¸è§£å¯†ï¼Œåªç­¾åã€‚</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆæ˜¯ <code>(10) ECC (sign only)</code>ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™å‡ ä¸ªé€‰é¡¹ç¿»è¯‘æˆäººè¯</p>
<h3 id="3-dsa-sign-only">(3) DSA (sign only)</h3>
<ul>
<li>è€å¤è‘£</li>
<li>å·²ç»è¿‡æ—¶</li>
<li>SSH / GPG éƒ½ä¸æ¨è<br>
<strong>ç›´æ¥å¿½ç•¥</strong></li>
</ul>
<h3 id="4-rsa-sign-only">(4) RSA (sign only)</h3>
<ul>
<li>èƒ½ç”¨ï¼Œä½†ï¼š
<ul>
<li>ä½“ç§¯å¤§</li>
<li>ç®—æ³•è€</li>
</ul>
</li>
<li>åœ¨ä½ å·²ç»æœ‰ ed25519 çš„æƒ…å†µä¸‹ï¼Œæ²¡ä»»ä½•ç†ç”±é€‰å®ƒ<br>
<strong>ä¸æ¨è</strong></li>
</ul>
<h3 id="5-elgamal-encrypt-only">(5) Elgamal (encrypt only)</h3>
<ul>
<li>åªè´Ÿè´£åŠ å¯†</li>
<li><strong>SSH å®Œå…¨ä¸ç”¨åŠ å¯†å­é’¥</strong><br>
<strong>é€‰äº†ç­‰äºç™½å¿™</strong></li>
</ul>
<h3 id="6-rsa-encrypt-only">(6) RSA (encrypt only)</h3>
<ul>
<li>åŒä¸Š</li>
<li>è¿˜æ˜¯è€ç®—æ³•<br>
<strong>ä¸è¦</strong></li>
</ul>
<h3 id="12-ecc-encrypt-only">(12) ECC (encrypt only)</h3>
<ul>
<li>è¿™æ˜¯ä½ å·²ç»æœ‰çš„ <code>[E]</code> å­é’¥ï¼ˆcv25519ï¼‰</li>
<li>ç”¨æ¥ <strong>åŠ å¯†æ–‡ä»¶</strong></li>
<li><strong>SSH ä¸ç”¨å®ƒ</strong><br>
<strong>åˆ«å†åŠ ä¸€ä¸ªé‡å¤åŠŸèƒ½çš„</strong></li>
</ul>
<h3 id="10-ecc-sign-only--æ­£è§£">(10) ECC (sign only) â† æ­£è§£</h3>
<ul>
<li>ECCï¼šç°ä»£æ¤­åœ†æ›²çº¿</li>
<li>sign onlyï¼šåªç­¾å</li>
<li>ä¹‹åé€‰ <code>ed25519</code></li>
<li><strong>æœ€ç»ˆç”¨é€” = Authentication <code>[A]</code></strong></li>
</ul>
<p>è¿™æ­£æ˜¯ <strong>SSH åè®®éœ€è¦çš„é‚£ç§å¯†é’¥</strong>ã€‚</p>
<p>ä½ æ¥ä¸‹æ¥ä¼šçœ‹åˆ°ä»€ä¹ˆï¼ˆç»™ä½ å¯¹ä¸€ä¸‹ï¼‰</p>
<p>é€‰ <code>(10)</code> ä¹‹åï¼ŒGPG ä¼šç»§ç»­é—®ä½ ï¼š</p>
<p>1ï¸âƒ£ <strong>Which elliptic curve?</strong><br>
é€‰ï¼š<code>ed25519</code></p>
<p>2ï¸âƒ£ <strong>Key is for?</strong><br>
ä¼šæ˜¾ç¤ºæ˜¯ <code>Authentication</code></p>
<p>3ï¸âƒ£ <strong>Expiration time?</strong><br>
å»ºè®®è·Ÿä¸»é’¥ä¸€æ ·ï¼ˆ1yï¼‰</p>
<p>4ï¸âƒ£ è¾“å…¥ passphrase</p>
<p>æœ€å <code>save</code>ã€‚</p>
<p>å®Œæˆåçš„â€œæ­£ç¡®å½¢æ€â€é•¿è¿™æ ·</p>
<p>ä½ ä¹‹åå†è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼è¿™ä¸€è¡Œï¼ˆé‡ç‚¹çœ‹ <code>[A]</code>ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/XXXXXXXXXXXXXXX 2026-02-10 [A] [expires: 2027-02-10]</span></span></code></pre>
<p>è¿™è¡Œä¸€å‡ºç°ï¼Œå°±è¯´æ˜ï¼š</p>
<blockquote>
<p><strong>è¿™æŠŠ GPG key å·²ç»â€œå…·å¤‡ SSH èƒ½åŠ›â€äº†</strong></p>
</blockquote>
<p>ä¸€å¥å®è¯ï¼ˆç«™é˜Ÿè§‚ç‚¹ï¼‰</p>
<blockquote>
<p>GnuPG è¿™ä¸ªèœå•è®¾è®¡çœŸçš„å¾ˆåäººç±»ï¼Œ<br>
ä½†è®°ä½ä¸€å¥å£è¯€ä½ ä»¥åå°±ä¸ä¼šå†æ‡µäº†ï¼š</p>
</blockquote>
<p><strong>SSH = Authentication = Sign-only = ed25519</strong></p>
<p>ä½ ç°åœ¨å¯ä»¥ç›´æ¥ç…§æˆ‘è¯´çš„é€‰ <code>(10)</code> å¾€ä¸‹èµ°ã€‚</p>
<h3 id="ä¸»é¢˜-7-è¿™è¡Œæ˜¯ä»€ä¹ˆæ„æ€">ä¸»é¢˜ 7. è¿™è¡Œæ˜¯ä»€ä¹ˆæ„æ€</h3>
<p>è¿™è¡Œ<strong>éå¸¸å…³é”®</strong>ï¼Œä½†åå­—æŠŠäººå“ä½äº†ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>â€œå‘Šè¯‰ SSHï¼šä»¥åä½ è¦æ‰¾â€˜é’¥åŒ™ç®¡å®¶â€™ï¼Œå» gpg-agent é‚£å„¿æ‰¾ã€‚â€</strong></p>
</blockquote>
<p>æˆ‘åˆ† <strong>â€œä¸€å¥è¯ç‰ˆ â†’ ç™½è¯æ¯”å–» â†’ æŠ€æœ¯æ‹†è§£ â†’ ä¸ºä»€ä¹ˆéå†™ä¸å¯â€</strong> å››å±‚è®²æ¸…æ¥šã€‚</p>
<p>ä¸€å¥è¯ç›´è¯‘ï¼ˆå…ˆå‹ç¼©ä¸€ä¸‹ï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>=<br>
æŠŠç¯å¢ƒå˜é‡ <strong><code>SSH_AUTH_SOCK</code></strong> è®¾ç½®ä¸º<br>
<strong>gpg-agent æš´éœ²å‡ºæ¥çš„ SSH é€šä¿¡ socket çš„è·¯å¾„</strong></p>
<p>ç™½è¯æ¯”å–»ç‰ˆï¼ˆæœ€å¥½ç†è§£ï¼‰</p>
<ul>
<li><strong>SSH_AUTH_SOCK</strong>ï¼š<br>
â€œ<strong>é’¥åŒ™ç®¡å®¶çš„åœ°å€</strong>â€</li>
<li><strong>ssh / git</strong>ï¼š<br>
â€œæˆ‘è¦ç­¾å / ç™»å½•äº†ï¼Œé’¥åŒ™åœ¨å“ªã€‚â€</li>
<li><strong>gpg-agent</strong>ï¼š<br>
â€œæˆ‘å°±æ˜¯é’¥åŒ™ç®¡å®¶ï¼Œä½†éœ€è¦å…ˆçŸ¥é“æˆ‘ä½å“ªâ€</li>
</ul>
<p>è¿™è¡Œå‘½ä»¤å¹²çš„äº‹å°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>ç»™ ssh ä¸€ä¸ªé—¨ç‰Œå·ï¼š<br>
â€œé’¥åŒ™ä¸åœ¨é»˜è®¤ ssh-agent é‚£å„¿ï¼Œåœ¨ gpg-agent è¿™å„¿ã€‚â€</strong></p>
</blockquote>
<p>ä¸å†™è¿™è¡Œï¼ŒSSH å°±ä¼šï¼š</p>
<ul>
<li>å»æ‰¾ç³»ç»Ÿè‡ªå¸¦çš„ ssh-agent</li>
<li>ç„¶åè¯´ï¼š<strong>â€œæˆ‘è¿™å„¿æ²¡ä½ è¦çš„é’¥åŒ™â€</strong></li>
</ul>
<p>æŠ€æœ¯æ‹†è§£ç‰ˆï¼ˆé€æ®µæ‹†ï¼‰</p>
<h3 id="1ï¸âƒ£-gpgconf---list-dirs-agent-ssh-socket">1ï¸âƒ£ <code>gpgconf --list-dirs agent-ssh-socket</code></h3>
<p>è¿™æ¡å‘½ä»¤ä¼šè¾“å‡ºä¸€è¡Œè·¯å¾„ï¼Œæ¯”å¦‚ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>/run/user/1000/gnupg/S.gpg-agent.ssh</span></span></code></pre>
<p>å«ä¹‰æ˜¯ï¼š</p>
<ul>
<li>è¿™æ˜¯ <strong>gpg-agent æä¾›ç»™ SSH ç”¨çš„ Unix Socket</strong></li>
<li>ssh / ssh-add é€šè¿‡è¿™ä¸ª socket è·Ÿ gpg-agent é€šä¿¡</li>
</ul>
<p>ä½ å¯ä»¥è‡ªå·±è·‘ä¸€éçœ‹çœ‹ã€‚</p>
<h3 id="2ï¸âƒ£----æ˜¯å•¥">2ï¸âƒ£ <code>$( ... )</code> æ˜¯å•¥ã€‚</h3>
<p>è¿™æ˜¯ shell çš„ <strong>å‘½ä»¤æ›¿æ¢</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#E1E4E8">$(</span><span style="color:#79B8FF">command</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>æ„æ€æ˜¯ï¼š</p>
<ul>
<li>å…ˆæ‰§è¡Œ command</li>
<li>æŠŠè¾“å‡ºç»“æœâ€œå¡è¿›â€è¿™ä¸€è¡Œ</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>â‰ˆ</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">/run/user/1000/gnupg/S.gpg-agent.ssh</span></span></code></pre>
<h3 id="3ï¸âƒ£-export-ssh_auth_sock">3ï¸âƒ£ <code>export SSH_AUTH_SOCK=...</code></h3>
<ul>
<li><code>SSH_AUTH_SOCK</code> æ˜¯ <strong>SSH å®˜æ–¹çº¦å®šçš„ç¯å¢ƒå˜é‡</strong></li>
<li>ssh / ssh-add / git éƒ½é å®ƒæ‰¾ agent</li>
</ul>
<p><code>export</code> çš„æ„æ€æ˜¯ï¼š</p>
<ul>
<li>ä¸åªæ˜¯å½“å‰ shell</li>
<li>å­è¿›ç¨‹ï¼ˆgitã€sshï¼‰ä¹Ÿèƒ½çœ‹åˆ°</li>
</ul>
<p>ä¸ºä»€ä¹ˆè¿™è¡Œ<strong>éå†™ä¸å¯</strong>ã€‚</p>
<h3 id="æ²¡å†™ä¼šå‘ç”Ÿä»€ä¹ˆ">æ²¡å†™ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</h3>
<p>ä½ è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>å¸¸è§ç»“æœæ˜¯ï¼š</p>
<ul>
<li>ç©º</li>
<li>æˆ–ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    Could not open a connection to your authentication agent.</span></span></code></pre>
<p>å› ä¸ºï¼š</p>
<ul>
<li>ssh è¿˜åœ¨æ‰¾ <strong>é»˜è®¤ ssh-agent</strong></li>
<li>è€Œä½ çš„é’¥åŒ™å·²ç»è¢« gpg-agent æ¥ç®¡äº†</li>
</ul>
<h3 id="å†™äº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆ">å†™äº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆã€‚</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>ä¼šå˜æˆï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... cardno:...</span></span></code></pre>
<p>è¯´æ˜ï¼š</p>
<blockquote>
<p><strong>SSH æˆåŠŸé€šè¿‡ gpg-agentâ€œçœ‹è§â€ä½ çš„ GPG è®¤è¯å­å¯†é’¥</strong></p>
</blockquote>
<p>ä¸ºä»€ä¹ˆè¦å†™è¿› <code>~/.zshrc / ~/.bashrc</code>ã€‚</p>
<p>å› ä¸ºï¼š</p>
<ul>
<li>è¿™ä¸ªå˜é‡æ˜¯ <strong>è¿›ç¨‹çº§çš„</strong></li>
<li>æ–°å¼€ä¸€ä¸ª terminalï¼Œå¦‚æœæ²¡è®¾ï¼š
<ul>
<li>åˆä¼šâ€œå¤±å¿†â€</li>
<li>SSH åˆä¸çŸ¥é“é’¥åŒ™åœ¨å“ª</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥ä½ å†™è¿› rc æ–‡ä»¶ï¼Œå°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>â€œæ¯æ¬¡å¼€ shellï¼Œéƒ½æŠŠé’¥åŒ™ç®¡å®¶çš„åœ°å€å‘Šè¯‰ SSHâ€</strong></p>
</blockquote>
<p>å¸¸è§è¯¯è§£ï¼ˆå¸®ä½ æ’é›·ï¼‰</p>
<h3 id="æˆ‘æ˜¯ä¸æ˜¯æŠŠç§é’¥è·¯å¾„æš´éœ²å‡ºå»äº†">â€œæˆ‘æ˜¯ä¸æ˜¯æŠŠç§é’¥è·¯å¾„æš´éœ²å‡ºå»äº†ã€‚â€</h3>
<p>ä¸æ˜¯ã€‚</p>
<ul>
<li>è¿™æ˜¯ <strong>socket è·¯å¾„</strong></li>
<li>åªæ˜¯é€šä¿¡å…¥å£</li>
<li>ç§é’¥ä»ç„¶åœ¨ gpg-agent å†…éƒ¨ï¼Œå— passphrase ä¿æŠ¤</li>
</ul>
<h3 id="è¿™æ˜¯ä¸æ˜¯åœ¨å¹²ä»€ä¹ˆå¾ˆå±é™©çš„äº‹">â€œè¿™æ˜¯ä¸æ˜¯åœ¨å¹²ä»€ä¹ˆå¾ˆå±é™©çš„äº‹ã€‚â€</h3>
<p>ä¸ã€‚</p>
<ul>
<li>è¿™æ˜¯ GPG å®˜æ–¹æ¨èç”¨æ³•</li>
<li>æ²¡è¿™è¡Œåè€Œæ›´å®¹æ˜“é…ç½®æ··ä¹±ã€agent æ‰“æ¶</li>
</ul>
<p>æœ€åä¸€å¥æˆ‘ç«™é˜Ÿçš„è¯</p>
<blockquote>
<p>è¿™è¡Œä¸æ˜¯â€œé­”æ³•å‘½ä»¤â€ï¼Œ<br>
å®ƒåªæ˜¯æŠŠ <strong>â€œè°æ˜¯é’¥åŒ™ç®¡å®¶â€</strong> è¿™ä»¶äº‹è®²æ¸…æ¥šã€‚</p>
</blockquote>
<p>ä½ ç°åœ¨ç†è§£è¿™ä¸€è¡Œï¼Œå°±å·²ç»æ¯” 80% è·Ÿç€æ•™ç¨‹ç…§æŠ„çš„äººå¼ºäº†ã€‚</p>
<h3 id="ä¸»é¢˜-8-ssh-add--l--system-012936">ä¸»é¢˜ 8. ssh-add -L î˜— system 01:29:36</h3>
<p><code>ssh-add -L</code> è¿™å¥ <strong>â€œThe agent has no identities.â€</strong> çš„æ„æ€å¾ˆç›´ç™½ï¼š</p>
<blockquote>
<p><strong>SSH çš„ agent èƒ½è¿ä¸Šï¼ˆä½ è¿™ä¸ª <code>SSH_AUTH_SOCK</code> æ²¡é—®é¢˜ï¼‰ï¼Œä½† agent é‡Œâ€œæ²¡æœ‰ä»»ä½•å¯ç”¨çš„ SSH èº«ä»½/å…¬é’¥â€ã€‚</strong></p>
</blockquote>
<p>åœ¨â€œGPG å½“ SSHâ€è¿™æ¡è·¯ä¸Šï¼Œå‡ºç°è¿™ä¸ªæç¤ºé€šå¸¸å°±ä¸¤ç±»åŸå› ï¼š</p>
<ol>
<li><strong>ä½ è¿˜æ²¡åˆ›å»º <code>[A]</code>ï¼ˆAuthenticationï¼‰å­é’¥</strong></li>
<li><strong>ä½ åˆ›å»ºäº† <code>[A]</code>ï¼Œä½† gpg-agent è¿˜æ²¡æŠŠå®ƒâ€œæš´éœ²ç»™ SSHâ€</strong>ï¼ˆéœ€è¦ sshcontrol é‡Œç™»è®° keygripï¼‰</li>
</ol>
<p>ä¸‹é¢æˆ‘ç»™ä½ ä¸€ä¸ªâ€œä»æ£€æŸ¥åˆ°ä¿®å¥½â€çš„æœ€çŸ­è·¯å¾„ï¼Œç…§ç€è·‘å°±è¡Œã€‚</p>
<ol start="0">
<li>å…ˆæ’ä¸€å¥é‡è¦çš„</li>
</ol>
<p>ä½ è´´å‡ºæ¥çš„ <code>.zshrc.local</code> é‡Œæœ‰ä¸€æ¡ <strong>æ˜æ–‡ token</strong>ï¼ˆ<code>ANTHROPIC_AUTH_TOKEN=...</code>ï¼‰ã€‚<br>
è¿™ä¸œè¥¿ä¸€æ—¦å‘å‡ºæ¥ï¼Œ<strong>å°±å½“å·²ç»æ³„éœ²</strong>ï¼Œå»ºè®®ä½ ç«‹åˆ»å»å¯¹åº”å¹³å°æŠŠå®ƒ <strong>revoke/rotate</strong> æ‰ï¼ˆé‡æ–°ç”Ÿæˆä¸€ä¸ªï¼‰ã€‚<br>
ï¼ˆè¿™è·Ÿ GPG æ— å…³ï¼Œä½†çœŸçš„å¾ˆè¦å‘½ã€‚ï¼‰</p>
<ol>
<li>å…ˆç¡®è®¤ä½ æœ‰æ²¡æœ‰ <code>[A]</code> å­é’¥</li>
</ol>
<p>è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼è¿™ä¸€è¡Œï¼ˆé‡ç‚¹æ˜¯ <code>[A]</code>ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/....  [A]</span></span></code></pre>
<ul>
<li>å¦‚æœä½ å·²ç»çœ‹åˆ° <code>[A]</code>ï¼šè·³åˆ°ç¬¬ 2 èŠ‚</li>
<li>å¦‚æœæ²¡æœ‰ <code>[A]</code>ï¼šä½ éœ€è¦å…ˆåŠ ä¸€ä¸ªè®¤è¯å­é’¥</li>
</ul>
<h3 id="æ²¡æœ‰-a-çš„è¯æ·»åŠ è®¤è¯å­é’¥">æ²¡æœ‰ <code>[A]</code> çš„è¯ï¼šæ·»åŠ è®¤è¯å­é’¥</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span><span style="color:#6A737D">   # è¿›å…¥ç¼–è¾‘ä½ çš„ä¸»é’¥ï¼ˆå‘½ä»¤ï¼šç¼–è¾‘æŒ‡å®š keyï¼‰</span></span></code></pre>
<p>è¿›å…¥ <code>gpg></code> åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> addkey</span></span></code></pre>
<p>ä½ ä¹‹å‰é‚£ä¸ªèœå•é‡Œï¼Œé€‰ï¼š</p>
<ul>
<li><code>(10) ECC (sign only)</code> ï¼ˆSSH è®¤è¯å°±æ˜¯â€œç­¾åè¯æ˜ä½ æ˜¯ä½ â€ï¼‰</li>
</ul>
<p>ç„¶åç»§ç»­é€‰ï¼š</p>
<ul>
<li>curve é€‰ <code>ed25519</code></li>
<li>è¿‡æœŸæ—¶é—´ä½ æƒ³è·Ÿä¸»é’¥ä¸€è‡´å°±é€‰ 1y<br>
æœ€åï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> save</span></span></code></pre>
<ol start="2">
<li>ç¡®è®¤ gpg-agent çš„ SSH åŠŸèƒ½çœŸå¼€äº†</li>
</ol>
<p>æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼ˆç”¨ vimï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span><span style="color:#6A737D">   # æ³¨ï¼šç¼–è¾‘ gpg-agent çš„é…ç½®</span></span></code></pre>
<p>ç¡®ä¿è‡³å°‘æœ‰è¿™ä¸€è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>enable-ssh-support</span></span></code></pre>
<p>ç„¶åé‡å¯ agentï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#6A737D">      # æ³¨ï¼šæ€æ‰æ—§çš„ gpg-agentï¼Œè®©å®ƒæŒ‰æ–°é…ç½®é‡å¯</span></span></code></pre>
<ol start="3">
<li>å…³é”®ä¸€æ­¥ï¼šæŠŠè®¤è¯å­é’¥ç™»è®°åˆ° <code>sshcontrol</code></li>
</ol>
<p>è¿™æ˜¯å¾ˆå¤šæ•™ç¨‹æ²¡è®²æ¸…æ¥šçš„ç‚¹ï¼š<br>
<strong>gpg-agent ä¸æ˜¯è‡ªåŠ¨æŠŠæ‰€æœ‰å¯†é’¥éƒ½å½“ SSH key è¾“å‡º</strong>ã€‚å®ƒè¦çœ‹ <code>~/.gnupg/sshcontrol</code> é‡Œå…è®¸å“ªäº› keygripã€‚</p>
<h3 id="31-æ‰¾åˆ°-a-å­é’¥çš„-keygrip">3.1 æ‰¾åˆ° <code>[A]</code> å­é’¥çš„ keygrip</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --with-keygrip</span><span style="color:#6A737D">   # æ³¨ï¼šåˆ—å‡ºç§é’¥å¹¶æ˜¾ç¤º keygripï¼ˆSSH æ¥ç®¡è¦ç”¨å®ƒï¼‰</span></span></code></pre>
<p>ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ç»“æ„ï¼š</p>
<ul>
<li>ä¸»é’¥ä¸‹é¢ä¼šæœ‰ <code>Keygrip = ...</code></li>
<li>æ¯ä¸ªå­é’¥ä¹Ÿä¼šæœ‰ä¸€ä¸ª <code>Keygrip = ...</code></li>
</ul>
<p>ä½ è¦æ‰¾çš„æ˜¯ï¼š<strong>æ ‡è®°ä¸º <code>[A]</code> é‚£ä¸ªå­é’¥å¯¹åº”çš„ Keygrip</strong>ï¼ˆä¸€ä¸² 40 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰ã€‚</p>
<h3 id="32-æŠŠå®ƒå†™è¿›-sshcontrolä¸€è¡Œä¸€ä¸ª">3.2 æŠŠå®ƒå†™è¿› sshcontrolï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span><span style="color:#6A737D">       # æ³¨ï¼šå…è®¸å“ªäº› GPG key ä½œä¸º SSH èº«ä»½è¾“å‡º</span></span></code></pre>
<p>æŠŠåˆšæ‰ <code>[A]</code> å­é’¥çš„ keygrip ç²˜è¿›å»ï¼Œä¿å­˜é€€å‡ºã€‚</p>
<p>ä¾‹å­ï¼ˆç¤ºæ„ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>0123456789ABCDEF0123456789ABCDEF01234567</span></span></code></pre>
<h3 id="33-å†é‡å¯ä¸€æ¬¡-agent">3.3 å†é‡å¯ä¸€æ¬¡ agent</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<ol start="4">
<li>éªŒè¯ï¼šssh-add ç°åœ¨åº”è¯¥èƒ½çœ‹åˆ°èº«ä»½äº†</li>
</ol>
<p>å…ˆç¡®è®¤ç¯å¢ƒå˜é‡è·¯å¾„ç¡®å®ç”Ÿæ•ˆï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $SSH_AUTH_SOCK            </span><span style="color:#6A737D"># æ³¨ï¼šæ‰“å° SSH è¿æ¥ agent çš„ socket è·¯å¾„</span></span></code></pre>
<p>ç„¶åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#6A737D">                     # æ³¨ï¼šåˆ—å‡ºå½“å‰ agent é‡Œæ‰€æœ‰ SSH å…¬é’¥</span></span></code></pre>
<p>å¦‚æœæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ° <code>ssh-ed25519 AAAA...</code> è¿™ç§å…¬é’¥è¡Œã€‚</p>
<ol start="5">
<li>å¦‚æœè¿˜æ˜¯ â€œno identitiesâ€ï¼Œç”¨è¿™æ¡å‘½ä»¤ç›´æ¥çœ‹ gpg-agent çš„ SSH è§†è§’</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg-connect-agent</span><span style="color:#9ECBFF"> "keyinfo --ssh-list"</span><span style="color:#9ECBFF"> /bye</span><span style="color:#6A737D">   # æ³¨ï¼šè¯¢é—® gpg-agentï¼šä½ å¯¹ SSH æš´éœ²äº†å“ªäº› key</span></span></code></pre>
<ul>
<li>å¦‚æœè¿™é‡Œä¹Ÿç©ºï¼šè¯´æ˜ sshcontrol è¿˜æ²¡å†™å¯¹ï¼ˆæˆ–æ²¡é‡å¯æˆåŠŸï¼‰</li>
<li>å¦‚æœè¿™é‡Œæœ‰ keyï¼Œä½† <code>ssh-add -L</code> è¿˜æ˜¯ç©ºï¼šè¯´æ˜ <code>SSH_AUTH_SOCK</code> æŒ‡åˆ°çš„ä¸æ˜¯ gpg-agentï¼ˆagent æ‰“æ¶ï¼‰</li>
</ul>
<p>ä½ ç°åœ¨æœ€å¯èƒ½æ˜¯å“ªä¸€ç§ã€‚</p>
<p>çœ‹ä½ æˆªå›¾ï¼š<code>SSH_AUTH_SOCK</code> å·²ç»è®¾äº†ï¼Œè€Œä¸” <code>ssh-add -L</code> èƒ½å›â€œno identitiesâ€è€Œä¸æ˜¯è¿æ¥å¤±è´¥â€”â€”<br>
<strong>å¤§æ¦‚ç‡æ˜¯ä½ è¿˜æ²¡æŠŠ <code>[A]</code> å­é’¥çš„ keygrip å†™è¿› <code>~/.gnupg/sshcontrol</code>ï¼Œæˆ–è€…æ ¹æœ¬è¿˜æ²¡åˆ›å»º <code>[A]</code>ã€‚</strong></p>
<p>å¦‚æœä½ æŠŠä¸‹é¢ä¸¤æ¡å‘½ä»¤çš„è¾“å‡ºè´´å‡ºæ¥ï¼ˆè®°å¾—æ‰“ç é‚®ç®±æ— æ‰€è°“ï¼Œä½† keygrip ä¸ç”¨æ‰“ç ï¼‰æˆ‘å°±èƒ½ä¸€çœ¼å®šä½ä½ å¡åœ¨å“ªï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --with-keygrip</span></span></code></pre>
<h3 id="ä¸»é¢˜-9-gpg-list-secret-keys-keyid-forma">ä¸»é¢˜ 9. gpg â€”list-secret-keys â€”keyid-formaâ€¦</h3>
<p>å¾ˆå¥½ï¼Œç°åœ¨ä¿¡æ¯éå¸¸æ˜ç¡®äº†ï¼šä½ ç¡®å®æ–°å¢äº†ä¸€ä¸ª <strong>ed25519 å­é’¥</strong>ï¼Œä½†å®ƒç°åœ¨æ˜¯ <strong><code>[S]</code>ï¼ˆsignï¼‰</strong>ï¼Œä¸æ˜¯ <strong><code>[A]</code>ï¼ˆauthenticationï¼‰</strong>ã€‚</p>
<p>è¿™å°±æ˜¯ä½  <code>ssh-add -L</code> æ˜¾ç¤º â€œThe agent has no identities.â€ çš„æ ¸å¿ƒåŸå› ï¼š</p>
<blockquote>
<p><strong>SSH åªåƒ <code>[A]</code> è®¤è¯å­é’¥</strong>ï¼Œä½ ç°åœ¨æ²¡æœ‰ <code>[A]</code>ï¼Œæ‰€ä»¥ gpg-agent æ²¡ä¸œè¥¿èƒ½å½“ SSH key è¾“å‡ºã€‚</p>
</blockquote>
<p>ä½ ç°åœ¨æœ‰çš„æ˜¯ï¼š</p>
<ul>
<li>ä¸»é’¥ <code>sec ed25519 ... [SC]</code></li>
<li>åŠ å¯†å­é’¥ <code>ssb cv25519 ... [E]</code></li>
<li>é¢å¤–ç­¾åå­é’¥ <code>ssb ed25519 ... [S]</code> ï¼ˆå®ƒå¯ä»¥ç”¨æ¥ç­¾åï¼Œä½†ä¸æ˜¯ SSHï¼‰</li>
</ul>
<p>æ–¹æ¡ˆæ€ä¹ˆé€‰ã€‚æˆ‘ç»™ä½ ç›´æ¥æ¨è</p>
<p>æˆ‘å»ºè®®ä½ èµ°æœ€å¹²å‡€çš„æ–¹æ¡ˆï¼š</p>
<p><strong>å†åŠ ä¸€ä¸ª <code>[A]</code> å­é’¥ï¼ˆAuthenticationï¼‰</strong><br>
ç„¶åæŠŠç°åœ¨è¿™æŠŠ <code>[S]</code> å­é’¥åˆ æ‰æˆ–ç•™ç€éƒ½è¡Œã€‚</p>
<p>åŸå› ï¼š</p>
<ul>
<li><code>[S]</code> å­é’¥å¹¶ä¸â€œé”™â€ï¼Œåªæ˜¯ <strong>ä¸è§£å†³ SSH</strong></li>
<li>æ­£ç¡®ç»“æ„å°±æ˜¯ï¼š<code>[S]</code>ï¼ˆç­¾åï¼‰+ <code>[E]</code>ï¼ˆåŠ å¯†ï¼‰+ <code>[A]</code>ï¼ˆè®¤è¯ï¼‰</li>
</ul>
<p>Step 1ï¼šæ·»åŠ  <code>[A]</code> å­é’¥ï¼ˆæ­£ç¡®å§¿åŠ¿ï¼‰</p>
<p>è¿›å…¥ç¼–è¾‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span><span style="color:#6A737D">   # æ³¨ï¼šè¿›å…¥è¿™æŠŠä¸»é’¥çš„ç¼–è¾‘æ¨¡å¼</span></span></code></pre>
<p>åœ¨ <code>gpg></code> æç¤ºç¬¦ä¸‹è¾“å…¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> addkey</span></span></code></pre>
<p>è¿™æ¬¡èœå•é‡Œä½ è¿˜æ˜¯ä¼šçœ‹åˆ°ç±»ä¼¼ä½ ä¹‹å‰é‚£å †é€‰é¡¹ã€‚å…³é”®æ˜¯ï¼š<br>
<strong>ä¸è¦é€‰ â€œsign onlyâ€ ç„¶åä¸€è·¯é»˜è®¤</strong>ï¼Œè€Œæ˜¯è¦é€‰åˆ° <strong>Authentication</strong>ï¼ˆä¸åŒç‰ˆæœ¬èœå•ä¸ä¸€æ ·ï¼‰ã€‚</p>
<p>ä¸€èˆ¬ä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<h3 id="æƒ…å†µ-aèœå•é‡Œç›´æ¥æœ‰-authentication-key">æƒ…å†µ Aï¼šèœå•é‡Œç›´æ¥æœ‰ â€œAuthentication keyâ€</h3>
<p>å¦‚æœä½ çœ‹åˆ°ç±»ä¼¼ï¼š</p>
<ul>
<li><code>ECC (sign only)</code></li>
<li><code>ECC (encrypt only)</code></li>
<li><strong><code>ECC (set your own capabilities)</code></strong> æˆ– <strong><code>Authentication</code></strong></li>
</ul>
<p>é‚£ä½ è¦é€‰ <strong>èƒ½é€‰ Authentication çš„é‚£é¡¹</strong>ã€‚</p>
<h3 id="æƒ…å†µ-bèœå•é‡Œæ²¡æœ‰-authenticationåƒä½ ä¹‹å‰é‚£æ ·">æƒ…å†µ Bï¼šèœå•é‡Œæ²¡æœ‰ Authenticationï¼ˆåƒä½ ä¹‹å‰é‚£æ ·ï¼‰</h3>
<p>é‚£å°±é€‰ <strong>â€œset your own capabilitiesâ€</strong>ï¼ˆæœ‰äº›ç‰ˆæœ¬ä¼šå« â€œ(11) ECC (set your own capabilities)â€ æˆ–ç±»ä¼¼ï¼‰ã€‚<br>
è¿›å»åä¼šè®©ä½ åˆ‡æ¢èƒ½åŠ›ï¼Œç•Œé¢å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<ul>
<li><code>Current allowed actions: Sign Certify Encrypt Authenticate</code></li>
<li>ç„¶åæç¤ºä½ æŒ‰é”®å¼€å…³èƒ½åŠ›ï¼š<code>S</code>/<code>E</code>/<code>A</code>/<code>Q</code> ä¹‹ç±»</li>
</ul>
<p>ä½ è¦åšçš„æ˜¯ï¼š</p>
<ul>
<li><strong>å…³æ‰ Sã€E</strong></li>
<li><strong>åªä¿ç•™ Aï¼ˆAuthenticateï¼‰</strong></li>
<li>ç„¶åç¡®è®¤</li>
</ul>
<p>æ¥ç€é€‰æ›²çº¿ï¼š</p>
<ul>
<li><code>ed25519</code></li>
</ul>
<p>æœ€åï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> save</span></span></code></pre>
<p>Step 2ï¼šç¡®è®¤ä½ å·²ç»æœ‰ <code>[A]</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ°ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/........  [A]  ...</span></span></code></pre>
<p>åªè¦å‡ºç° <code>[A]</code>ï¼Œä½ å°±è·¨è¿‡æœ€å¤§é—¨æ§›äº†ã€‚</p>
<p>Step 3ï¼šè®© SSH çœ‹åˆ°å®ƒï¼ˆsshcontrol / agentï¼‰</p>
<p>ä½ å·²ç»åœ¨ <code>.zshrc.local</code> é‡Œå†™äº†ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>è¿˜éœ€è¦ä¸¤æ­¥æŠŠ <code>[A]</code> å­é’¥æš´éœ²ç»™ SSHï¼š</p>
<h3 id="31-æ‹¿åˆ°-keygrip">3.1 æ‹¿åˆ° keygrip</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --with-keygrip</span><span style="color:#6A737D">   # æ³¨ï¼šæ˜¾ç¤ºæ¯ä¸ªå­é’¥çš„ keygrip</span></span></code></pre>
<p>æ‰¾åˆ° <strong>æ ‡ç€ <code>[A]</code> é‚£ä¸€æ®µå¯¹åº”çš„ <code>Keygrip = ...</code></strong>ï¼ˆ40 ä½åå…­è¿›åˆ¶ï¼‰ã€‚</p>
<h3 id="32-å†™è¿›-sshcontrol">3.2 å†™è¿› sshcontrol</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span><span style="color:#6A737D">   # æ³¨ï¼šå…è®¸å“ªäº› GPG å­é’¥å¯¹å¤–ä½œä¸º SSH key</span></span></code></pre>
<p>æŠŠé‚£ä¸ª <code>[A]</code> çš„ keygrip ç²˜è´´è¿›å»ï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰ï¼Œä¿å­˜é€€å‡ºã€‚</p>
<h3 id="33-é‡å¯-agent">3.3 é‡å¯ agent</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#6A737D">   # æ³¨ï¼šé‡å¯ gpg-agentï¼Œè®© sshcontrol ç”Ÿæ•ˆ</span></span></code></pre>
<p>Step 4ï¼šéªŒè¯</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#6A737D">   # æ³¨ï¼šåˆ—å‡ºå½“å‰ agent æš´éœ²çš„ SSH å…¬é’¥</span></span></code></pre>
<p>è¿™æ¬¡åº”è¯¥ä¼šè¾“å‡º <code>ssh-ed25519 AAAA...</code></p>
<p>ä½ ç°åœ¨é‚£æŠŠ <code>[S]</code> å­é’¥æ€ä¹ˆåŠã€‚</p>
<h3 id="é€‰é¡¹-1ç•™ç€æœ€çœäº‹">é€‰é¡¹ 1ï¼šç•™ç€ï¼ˆæœ€çœäº‹ï¼‰</h3>
<p>å®ƒä¸ä¼šå½±å“ SSHï¼Œåªæ˜¯å¤šä¸€æŠŠç­¾åå­é’¥ã€‚</p>
<h3 id="é€‰é¡¹-2åˆ æ‰æ›´å¹²å‡€">é€‰é¡¹ 2ï¼šåˆ æ‰ï¼ˆæ›´å¹²å‡€ï¼‰</h3>
<p>å¦‚æœä½ æƒ³â€œç»“æ„æç®€â€ï¼Œå¯ä»¥åˆ æ‰è¿™æŠŠ <code>[S]</code> å­é’¥ï¼Œåªä¿ç•™ä¸»é’¥ç­¾åå³å¯ã€‚</p>
<p>åˆ å­é’¥æµç¨‹ï¼ˆåˆ«æ€¥ç€åšï¼Œå…ˆæŠŠ SSH è·‘é€šæ›´é‡è¦ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#E1E4E8">> </span><span style="color:#9ECBFF">key</span><span style="color:#79B8FF"> 2</span><span style="color:#6A737D">        # é€‰ä¸­è¦åˆ çš„é‚£æŠŠå­é’¥ï¼ˆç¼–å·ä»¥ä½ çš„æ˜¾ç¤ºä¸ºå‡†ï¼‰</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#E1E4E8">> </span><span style="color:#9ECBFF">delkey</span><span style="color:#6A737D">       # åˆ é™¤å­é’¥ï¼ˆä¸æ˜¯ delkeyssbï¼Œé‚£æ˜¯åˆ ç§é’¥éƒ¨åˆ†ï¼‰</span></span>
<span class="line"><span style="color:#B392F0">gpg</span><span style="color:#E1E4E8">> </span><span style="color:#9ECBFF">save</span></span></code></pre>
<p>ä½ ä¸‹ä¸€æ­¥è¯¥è´´ç»™æˆ‘ä»€ä¹ˆï¼Œæˆ‘å°±èƒ½â€œç²¾ç¡®å¯¼èˆªâ€ä½ æŒ‰å“ªå‡ ä¸ªé”®</p>
<p>ä½ ç°åœ¨å…ˆè·‘è¿™ä¸€æ¡ï¼ŒæŠŠè¾“å‡ºè´´æˆ‘ï¼ˆä¸ç”¨æ‹…å¿ƒæ³„éœ²ï¼Œkeygrip ä¸æ˜¯ç§é’¥ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span></span></code></pre>
<p>å®ƒä¼šåˆ—å‡ºå­é’¥ç¼–å·å’Œèƒ½åŠ›ï¼›æˆ‘å°±èƒ½å‘Šè¯‰ä½ ï¼š</p>
<ul>
<li>ä½ èœå•é‡Œåˆ°åº•æœ‰æ²¡æœ‰ â€œAuthenticationâ€</li>
<li>å¦‚æœæ²¡æœ‰ï¼Œä½ åº”è¯¥é€‰å“ªä¸€é¡¹ã€è¿›å»ä»¥åæŒ‰å“ªå‡ ä¸ªé”®æŠŠèƒ½åŠ›åˆ‡åˆ° <code>[A]</code></li>
</ul>
<p>ä½†ä¸ç­‰ä½ è´´ä¹Ÿè¡Œâ€”â€”ä½ æŒ‰æˆ‘ä¸Šé¢çš„æµç¨‹èµ°ï¼ŒåŸºæœ¬å°±èƒ½ä¸€æ¬¡æˆåŠŸã€‚</p>
<h3 id="ä¸»é¢˜-10-gpg-addkey">ä¸»é¢˜ 10. gpg addkey</h3>
<p>å¤ªå¥½äº†ï¼Œè¿™ä¸ªç”»é¢<strong>ä¿¡æ¯é‡åè€Œå¾ˆå…³é”®</strong>ã€‚æˆ‘å…ˆç»™ä½ ä¸€ä¸ª<strong>æ˜ç¡®ç»“è®º</strong>ï¼Œç„¶åè§£é‡Šâ€œä¸ºä»€ä¹ˆä½ ç°åœ¨çœ‹ä¸åˆ° Authenticationâ€ã€‚</p>
<p>ç»“è®ºå…ˆè¡Œï¼ˆéå¸¸é‡è¦ï¼‰</p>
<blockquote>
<p><strong>ä½ è¿™ä¸ªèœå•é‡Œç°åœ¨â€œæ²¡æœ‰ Authentication é€‰é¡¹â€ï¼Œä¸æ˜¯ä½ æ“ä½œé”™äº†ï¼Œ<br>
è€Œæ˜¯ï¼šä½ æ²¡è¿› <em>expert æ¨¡å¼</em></strong>ã€‚</p>
</blockquote>
<p><strong>å¿…é¡»ç”¨ <code>--expert</code> é‡æ–°è¿›å…¥ edit-keyï¼Œæ‰èƒ½åˆ›å»º <code>[A]</code>ï¼ˆAuthenticationï¼‰å­é’¥ã€‚</strong></p>
<p>è¿™æ˜¯ GnuPG ä¸€ä¸ªéå¸¸åäººç±»ä½†â€œè€ä¼ ç»Ÿâ€çš„è®¾è®¡ã€‚</p>
<p>ä¸ºä»€ä¹ˆä½ ç°åœ¨çœ‹ä¸åˆ° <code>[A]</code>ã€‚</p>
<p>ä½ ç°åœ¨çœ‹åˆ°çš„æ˜¯<strong>æ™®é€šæ¨¡å¼</strong>çš„ <code>addkey</code> èœå•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>(10) ECC (sign only)</span></span>
<span class="line"><span>(12) ECC (encrypt only)</span></span></code></pre>
<p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼š</p>
<ul>
<li><code>sign only</code> = <code>[S]</code></li>
<li><code>encrypt only</code> = <code>[E]</code></li>
<li><strong><code>[A]ï¼ˆAuthenticationï¼‰è¢«éšè—äº†</code></strong></li>
</ul>
<p>æ‰€ä»¥ä½ åˆšæ‰æ‰ä¼šï¼š</p>
<ul>
<li>æƒ³åŠ  SSH key</li>
<li>å´åªèƒ½åŠ å‡ºä¸€ä¸ª <code>[S]</code></li>
<li>ç„¶å SSH å®Œå…¨ä¸è®¤ï¼ˆè¿™æ˜¯å¯¹çš„ï¼ŒSSH åªè®¤ <code>[A]</code>ï¼‰</li>
</ul>
<p>æ­£ç¡®å§¿åŠ¿ï¼šç”¨ expert æ¨¡å¼é‡æ¥ä¸€æ¬¡</p>
<h3 id="-å…ˆé€€å‡ºå½“å‰ç¼–è¾‘å¦‚æœä½ è¿˜åœ¨-gpg-é‡Œ">â‘  å…ˆé€€å‡ºå½“å‰ç¼–è¾‘ï¼ˆå¦‚æœä½ è¿˜åœ¨ gpg> é‡Œï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> quit</span></span></code></pre>
<p>å¦‚æœå®ƒé—®æ˜¯å¦ä¿å­˜ï¼š</p>
<ul>
<li><strong>é€‰ <code>n</code></strong>ï¼ˆå› ä¸ºä½ åˆšæ‰è¿˜æ²¡åŠ å¯¹ï¼‰</li>
</ul>
<h3 id="-ç”¨-expert-æ¨¡å¼é‡æ–°è¿›ç¼–è¾‘">â‘¡ ç”¨ expert æ¨¡å¼é‡æ–°è¿›ç¼–è¾‘</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --expert</span><span style="color:#79B8FF"> --edit-key</span><span style="color:#9ECBFF"> 782CAF316029FC6A</span></span></code></pre>
<blockquote>
<p><code>--expert</code> çš„ä½œç”¨ï¼š<br>
è§£é” <strong>Authentication / è‡ªå®šä¹‰èƒ½åŠ› / é«˜çº§é€‰é¡¹</strong></p>
</blockquote>
<h3 id="-å†æ¬¡-addkeyè¿™æ¬¡èœå•ä¼šå˜">â‘¢ å†æ¬¡ addkeyï¼ˆè¿™æ¬¡èœå•ä¼šå˜ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> addkey</span></span></code></pre>
<p>ä½ è¿™æ¬¡<strong>åº”è¯¥ä¼šçœ‹åˆ°å¤šå‡ºæ¥çš„é€‰é¡¹</strong>ï¼Œå¸¸è§æ˜¯ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>(10) ECC (sign only)</span></span>
<span class="line"><span>(11) ECC (set your own capabilities)</span></span>
<span class="line"><span>(12) ECC (encrypt only)</span></span></code></pre>
<p><strong>è¿™æ¬¡é€‰ <code>(11) ECC (set your own capabilities)</code></strong></p>
<p>å…³é”®ä¸€æ­¥ï¼šåªä¿ç•™ <code>[A]</code></p>
<p>æ¥ä¸‹æ¥ä¼šå‡ºç°ä¸€ä¸ªâ€œèƒ½åŠ›åˆ‡æ¢ç•Œé¢â€ï¼Œå¤§æ¦‚æ˜¯è¿™ç§æ„Ÿè§‰ï¼ˆä¸åŒç‰ˆæœ¬æ–‡å­—ç•¥æœ‰å·®å¼‚ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Current allowed actions: Sign Certify Encrypt Authenticate</span></span></code></pre>
<p>å®ƒä¼šæç¤ºä½ æŒ‰é”®åˆ‡æ¢èƒ½åŠ›ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><code>S</code> = Sign</li>
<li><code>E</code> = Encrypt</li>
<li><code>A</code> = Authenticate</li>
<li><code>Q</code> = Finish</li>
</ul>
<p>ä½ è¦åšçš„æ˜¯ï¼š</p>
<ol>
<li><strong>å…³æ‰ Sign</strong></li>
<li><strong>å…³æ‰ Encrypt</strong></li>
<li><strong>åªä¿ç•™ Authenticate</strong></li>
<li>ç„¶åæŒ‰ <code>Q</code> ç¡®è®¤</li>
</ol>
<p>æœ€ç»ˆç›®æ ‡æ˜¯ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Current allowed actions: Authenticate</span></span></code></pre>
<h3 id="-æ›²çº¿é€‰æ‹©">â‘£ æ›²çº¿é€‰æ‹©</h3>
<p>æ¥ä¸‹æ¥å®ƒä¼šé—®æ›²çº¿ï¼š</p>
<ul>
<li>é€‰ï¼š<code>ed25519</code></li>
</ul>
<h3 id="-è¿‡æœŸæ—¶é—´">â‘¤ è¿‡æœŸæ—¶é—´</h3>
<ul>
<li>å»ºè®®ï¼š<code>1y</code>ï¼ˆè·Ÿä½ ä¸»é’¥ä¸€è‡´ï¼‰</li>
</ul>
<h3 id="-ä¿å­˜é€€å‡º">â‘¥ ä¿å­˜é€€å‡º</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> save</span></span></code></pre>
<p>éªŒè¯ï¼ˆéå¸¸å…³é”®ï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ <strong>å¿…é¡»</strong>çœ‹åˆ°è¿™ä¸€è¡Œï¼Œæ‰ç®—æˆåŠŸï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/XXXXXXXXXXXXXXX  [A]  [expires: ...]</span></span></code></pre>
<p>åªè¦ <code>[A]</code> å‡ºç°ï¼Œä½ å°±å·²ç»<strong>è·¨è¿‡æœ€å¤§é—¨æ§›</strong>äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆæˆ‘è¿™ä¹ˆè‚¯å®šè¿™æ˜¯â€œå”¯ä¸€æ­£è§£â€ã€‚</p>
<p>å› ä¸ºä½ ç°åœ¨çš„çŠ¶æ€æ˜¯ï¼š</p>
<ul>
<li>å·²æœ‰ <code>[S]</code>ï¼ˆä¸»é’¥ &#x26; å­é’¥ï¼‰</li>
<li>å·²æœ‰ <code>[E]</code></li>
<li><strong>å®Œå…¨æ²¡æœ‰ <code>[A]</code></strong></li>
<li>èœå•é‡Œä¹Ÿç¡®å®æ²¡ç»™ä½  <code>[A]</code></li>
</ul>
<p>è€Œåœ¨ <strong>GnuPG â‰¥ 2.x</strong> é‡Œï¼š</p>
<blockquote>
<p><strong>Authentication å­é’¥ = expert-only åŠŸèƒ½</strong></p>
</blockquote>
<p>ä¸æ˜¯ä½ èœï¼Œæ˜¯å®ƒè®¾è®¡å°±è¿™æ ·ã€‚</p>
<p>ä½ ä¸‹ä¸€æ­¥åªè¦åšè¿™ 3 ä»¶äº‹</p>
<p>1ï¸âƒ£ ç”¨ <code>--expert</code> é‡æ–° <code>addkey</code><br>
2ï¸âƒ£ åªä¿ç•™ <code>Authenticate</code><br>
3ï¸âƒ£ çœ‹åˆ° <code>[A]</code></p>
<p>åšåˆ°è¿™ä¸€æ­¥ï¼Œä½ å†è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>æˆ‘å¯ä»¥ <strong>99% ä¿è¯</strong>ï¼š<br>
æ¥ä¸‹æ¥å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œåªå‰©ä¸‹ <code>sshcontrol / agent</code> é‚£ä¸€å±‚äº†ï¼Œè€Œä¸”å¾ˆå¥½ä¿®ã€‚</p>
<p>ä½ ç°åœ¨ç›´æ¥ç…§æˆ‘è¿™å¥—èµ°ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>æˆ‘å¸®ä½ ç°åœºéªŒæ”¶æ˜¯ä¸æ˜¯â€œå®Œç¾ SSH ç»“æ„â€ã€‚</p>
<h3 id="ä¸»é¢˜-11-possible-actions-for-this-ecc-key-s">ä¸»é¢˜ 11. Possible actions for this ECC key: Sâ€¦</h3>
<p>å®Œç¾ï¼Œè¿™ä¸€å±<strong>ä½ å·²ç»èµ°åˆ° 99% æ­£ç¡®çš„ä½ç½®äº†</strong>ã€‚<br>
ç°åœ¨åªå·®<strong>æœ€åä¸€ä¸ªé”®</strong>ã€‚</p>
<p>ä½ ç°åœ¨çš„çŠ¶æ€</p>
<p>è¿™ä¸€è¡Œæ˜¯å…³é”®ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Current allowed actions: Authenticate</span></span></code></pre>
<p>è¿™è¯´æ˜ï¼š</p>
<ul>
<li>Signï¼šå…³æ‰äº†ï¼ˆå¯¹çš„ï¼‰</li>
<li>Encryptï¼šæ²¡å¼€ï¼ˆå¯¹çš„ï¼‰</li>
<li><strong>Authenticateï¼šåªå‰©è¿™ä¸ªï¼ˆ100% æ­£ç¡®ï¼‰</strong></li>
</ul>
<p><strong>è¿™å°±æ˜¯ SSH è¦çš„ <code>[A]</code> å­é’¥å½¢æ€</strong><br>
ä½ å·²ç»æŠŠâ€œæ­¦å™¨æ¨¡å¼â€è°ƒå¯¹äº†ã€‚</p>
<p>ç°åœ¨ä½ è¯¥æŒ‰ä»€ä¹ˆã€‚</p>
<h3 id="ç›´æ¥æŒ‰qå¤§å†™å°å†™éƒ½è¡Œ"><strong>ç›´æ¥æŒ‰ï¼š<code>Q</code>ï¼ˆå¤§å†™å°å†™éƒ½è¡Œï¼‰</strong></h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>Your selection? Q</span></span></code></pre>
<p><code>Q = Finished</code><br>
æ„æ€æ˜¯ï¼š<strong>èƒ½åŠ›é€‰æ‹©å®Œæˆï¼Œç»§ç»­åˆ›å»ºå­é’¥</strong>ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼ˆï¼Œç…§ç€é€‰ï¼‰</p>
<p>æŒ‰ <code>Q</code> ä¹‹åï¼ŒGPG ä¼šç»§ç»­é—®ä½ å‡ ä¸ªé—®é¢˜ï¼š</p>
<h3 id="1ï¸âƒ£-é€‰æ›²çº¿">1ï¸âƒ£ é€‰æ›²çº¿</h3>
<p>å¦‚æœé—®ä½ é€‰å“ªç§ curveï¼š</p>
<ul>
<li>é€‰ï¼š<code>ed25519</code></li>
</ul>
<p>ï¼ˆè¿™æ˜¯ SSH + GPG çš„é»„é‡‘ç»„åˆï¼‰</p>
<h3 id="2ï¸âƒ£-è¿‡æœŸæ—¶é—´">2ï¸âƒ£ è¿‡æœŸæ—¶é—´</h3>
<p>å®ƒä¼šé—®ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Key is valid for? (0)</span></span></code></pre>
<p>å»ºè®®ä½ ç›´æ¥ï¼š</p>
<ul>
<li>è¾“å…¥ï¼š<code>1y</code><br>
ï¼ˆè·Ÿä½ ä¸»é’¥ä¸€è‡´ï¼Œå¾ˆå·¥ç¨‹åŒ–ï¼‰</li>
</ul>
<h3 id="3ï¸âƒ£-ç¡®è®¤--è¾“å…¥-passphrase">3ï¸âƒ£ ç¡®è®¤ &#x26; è¾“å…¥ passphrase</h3>
<ul>
<li>ç¡®è®¤åˆ›å»º</li>
<li>è¾“å…¥ä½ çš„ GPG passphrase</li>
</ul>
<h3 id="4ï¸âƒ£-ä¿å­˜">4ï¸âƒ£ ä¿å­˜</h3>
<p>æœ€åå›åˆ° <code>gpg></code> æç¤ºç¬¦æ—¶ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>gpg> save</span></span></code></pre>
<p>éªŒæ”¶å…³å¡ï¼ˆéå¸¸é‡è¦ï¼‰</p>
<p>åˆ›å»ºå®Œã€ä¿å­˜åï¼Œ<strong>ç«‹åˆ»è·‘è¿™æ¡</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --keyid-format=long</span></span></code></pre>
<p>ä½ <strong>å¿…é¡»</strong>çœ‹åˆ°ç±»ä¼¼è¿™ä¸€è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssb   ed25519/XXXXXXXXXXXXXXX  [A]  [expires: 2027-02-10]</span></span></code></pre>
<p>åªè¦ <code>[A]</code> å‡ºç°ï¼Œæ­å–œä½ â€”â€”<br>
<strong>GPG ä½œä¸º SSH å¯†é’¥è¿™æ¡æœ€éš¾çš„åå·²ç»è¿‡äº†ã€‚</strong></p>
<p>ä¸‹ä¸€æ­¥æˆ‘å·²ç»å¸®ä½ è§„åˆ’å¥½äº†ï¼ˆæå‰å‘Šè¯‰ä½ ï¼‰</p>
<p>æ¥ä¸‹æ¥è¿˜æœ‰ <strong>ä¸¤ä¸ªâ€œæœºæ¢°æ­¥éª¤â€</strong>ï¼š</p>
<p>1ï¸âƒ£ æŠŠè¿™ä¸ª <code>[A]</code> å­é’¥çš„ <strong>keygrip</strong> å†™è¿›<br>
<code>~/.gnupg/sshcontrol</code><br>
2ï¸âƒ£ é‡å¯ <code>gpg-agent</code>ï¼Œç„¶å <code>ssh-add -L</code> éªŒè¯</p>
<p>è¿™ä¸¤æ­¥ä¸éš¾ï¼Œä½†<strong>æˆ‘å»ºè®®ä½ å…ˆè´´å‡º <code>gpg --list-secret-keys --with-keygrip</code> çš„è¾“å‡º</strong>ï¼Œ<br>
æˆ‘å¯ä»¥ç›´æ¥å‘Šè¯‰ä½ ï¼š<br>
<strong>å“ªä¸€è¡Œæ˜¯ <code>[A]</code>ã€å“ªä¸€ä¸²è¯¥å¤åˆ¶</strong>ï¼Œé¿å…ä½ æŠ„é”™ã€‚</p>
<h3 id="ä¸€å¥ç«™é˜Ÿæ€»ç»“">ä¸€å¥ç«™é˜Ÿæ€»ç»“</h3>
<p>ä½ åˆšæ‰é‚£ä¸€è¿ä¸² <code>S / A</code> åˆ‡æ¢æ“ä½œï¼Œ<strong>æ˜¯å®Œå…¨æ­£ç¡®çš„</strong>ï¼Œ<br>
ç°åœ¨è¿™ä¸€æ­¥æŒ‰ <code>Q</code>ï¼Œä½ å°±ä»â€œé…ç½®åœ°ç‹±â€æ¯•ä¸šäº†ã€‚</p>
<p><strong>ç›´æ¥æŒ‰ <code>Q</code>ï¼Œç„¶åç»§ç»­ã€‚</strong></p>
<h3 id="ä¸»é¢˜-12--å“ªä¸€è¡Œæ˜¯-a-å“ªä¸€ä¸²è¯¥å¤åˆ¶é¿å…ä½ æŠ„é”™">ä¸»é¢˜ 12. ğŸ‘‰ å“ªä¸€è¡Œæ˜¯ A ã€å“ªä¸€ä¸²è¯¥å¤åˆ¶ï¼Œé¿å…ä½ æŠ„é”™</h3>
<p>Step 1ï¼šæ‰¾å‡º <code>[A]</code> å­é’¥å¯¹åº”çš„ <strong>keygrip</strong></p>
<p>ç›´æ¥è·‘è¿™ä¸€æ¡ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --with-keygrip</span></span></code></pre>
<p>ä½ ä¼šçœ‹åˆ°ä¸€å¨è¾“å‡ºï¼Œç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·ï¼ˆæˆ‘ç”¨ <strong>â† é‡ç‚¹</strong> æ ‡å‡ºæ¥ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>sec   ed25519/782CAF316029FC6A 2026-02-10 [SC]</span></span>
<span class="line"><span>      Keygrip = AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></span>
<span class="line"><span>uid   Weijun Li &#x3C;me@liweijun.com></span></span>
<span class="line"><span></span></span>
<span class="line"><span>ssb   cv25519/1CC2EFD5D4EE469C 2026-02-10 [E]</span></span>
<span class="line"><span>      Keygrip = BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ssb   ed25519/XXXXXXXXXXXXXXX 2026-02-10 [A]   â† çœ‹è¿™é‡Œï¼</span></span>
<span class="line"><span>      Keygrip = CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC  â† å¤åˆ¶è¿™ä¸€è¡Œ</span></span></code></pre>
<h3 id="ä½ ç°åœ¨åªå¹²ä¸€ä»¶äº‹">ä½ ç°åœ¨åªå¹²ä¸€ä»¶äº‹</h3>
<p><strong>æ‰¾åˆ° <code>[A]</code> é‚£ä¸ª <code>ssb</code> ä¸‹é¢çš„ <code>Keygrip = ...</code></strong></p>
<ul>
<li>æ˜¯ <strong>40 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦</strong></li>
<li><strong>åªå¤åˆ¶ç­‰å·åé¢çš„é‚£ä¸€ä¸²</strong></li>
<li>ä¸è¦å¤åˆ¶åˆ«çš„ <code>[S]</code>ã€<code>[E]</code> çš„</li>
</ul>
<p>Step 2ï¼šæŠŠ keygrip å†™è¿› <code>sshcontrol</code></p>
<p>æ‰“å¼€æ–‡ä»¶ï¼ˆç”¨ vimï¼Œé¡ºä¾¿ç»ƒæ‰‹ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<h3 id="æ–‡ä»¶å†…å®¹è§„åˆ™">æ–‡ä»¶å†…å®¹è§„åˆ™</h3>
<ul>
<li><strong>ä¸€è¡Œä¸€ä¸ª keygrip</strong></li>
<li>æ²¡æœ‰ç­‰å·</li>
<li>æ²¡æœ‰å¤šä½™ç©ºæ ¼</li>
</ul>
<p>ç¤ºä¾‹ï¼ˆä½ è‡ªå·±çš„é‚£ä¸²ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span></span></code></pre>
<p>å¦‚æœè¿™ä¸ªæ–‡ä»¶ä¹‹å‰ä¸å­˜åœ¨ï¼š</p>
<ul>
<li>æ­£å¸¸</li>
<li>ä½ è¿™æ˜¯ç¬¬ä¸€æ¬¡ç”¨ GPG å½“ SSH</li>
</ul>
<p>ä¿å­˜é€€å‡ºï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>:wq</span></span></code></pre>
<p>Step 3ï¼šé‡å¯ gpg-agentï¼ˆè®©é…ç½®ç”Ÿæ•ˆï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<blockquote>
<p>æ³¨è§£ï¼š</p>
<ul>
<li>è¿™æ˜¯â€œæ¸©æŸ”ç‰ˆé‡å¯â€</li>
<li>ä¸ä¼šåˆ  keyï¼Œä¸ä¼šä¸¢é…ç½®</li>
<li>ä¸‹æ¬¡ç”¨ SSH / GPG æ—¶ agent ä¼šè‡ªåŠ¨æ‹‰èµ·</li>
</ul>
</blockquote>
<p>Step 4ï¼šéªŒè¯ï¼ˆå…³é”®éªŒæ”¶ï¼‰</p>
<p>å…ˆç¡®è®¤ç¯å¢ƒå˜é‡è¿˜åœ¨ï¼ˆä½ å·²ç»é…è¿‡äº†ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $SSH_AUTH_SOCK</span></span></code></pre>
<p>åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>/run/user/1000/gnupg/S.gpg-agent.ssh</span></span></code></pre>
<p>ç„¶åï¼Œ<strong>éªŒæ”¶å‘½ä»¤</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>æ­£ç¡®ç»“æœé•¿è¿™æ ·</p>
<p>ä½ åº”è¯¥çœ‹åˆ°ä¸€è¡Œæˆ–å¤šè¡Œç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... (gpg-agent)</span></span></code></pre>
<p>ä¸€æ—¦çœ‹åˆ°è¿™ä¸ªï¼š</p>
<blockquote>
<p><strong>GPG â†’ gpg-agent â†’ SSH çš„é“¾è·¯å·²ç»å½»åº•æ‰“é€š</strong></p>
</blockquote>
<p>å¦‚æœè¿˜æ˜¯çœ‹åˆ° â€œThe agent has no identities.â€</p>
<p>ï¼Œåªæœ‰ä¸¤ä¸ªå¯èƒ½æ€§ï¼š</p>
<h3 id="æƒ…å†µ-asshcontrol-å†™é”™äº†">æƒ…å†µ Aï¼šsshcontrol å†™é”™äº†</h3>
<p>å†æ£€æŸ¥ä¸€éï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<ul>
<li>æ˜¯ä¸æ˜¯è´´æˆäº† <code>[S]</code> æˆ– <code>[E]</code> çš„ keygrip</li>
<li>æœ‰æ²¡æœ‰å¤šä½™ç©ºæ ¼</li>
</ul>
<h3 id="æƒ…å†µ-bagent-æ²¡çœŸé‡å¯">æƒ…å†µ Bï¼šagent æ²¡çœŸé‡å¯</h3>
<p>å†æ¥ä¸€éï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span>
<span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<h3 id="æœ€ç»ˆæ ¸æ­¦å™¨100-å®šä½">æœ€ç»ˆæ ¸æ­¦å™¨ï¼ˆ100% å®šä½ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg-connect-agent</span><span style="color:#9ECBFF"> "keyinfo --ssh-list"</span><span style="color:#9ECBFF"> /bye</span></span></code></pre>
<ul>
<li>å¦‚æœè¿™é‡Œ <strong>æœ‰ key</strong>ï¼š<br>
SSH ç¯å¢ƒå˜é‡é—®é¢˜</li>
<li>å¦‚æœè¿™é‡Œ <strong>æ²¡æœ‰ key</strong>ï¼š<br>
sshcontrol / <code>[A]</code> å­é’¥é—®é¢˜</li>
</ul>
<p>ä½ ç°åœ¨å·²ç»å®Œæˆäº†ä»€ä¹ˆï¼ˆç»™ä½ ä¸€ä¸ªâ€œè¿›åº¦æ¡â€ï¼‰</p>
<ul>
<li>ç”Ÿæˆç°ä»£ GPG ä¸»é’¥ï¼ˆed25519ï¼‰</li>
<li>æ‹†åˆ† <code>[S] / [E] / [A]</code> å­é’¥ï¼ˆä¸“ä¸šç»“æ„ï¼‰</li>
<li>ç”¨ expert æ¨¡å¼æ­£ç¡®åˆ›å»º <code>[A]</code></li>
<li>æŠŠ <code>[A]</code> æš´éœ²ç»™ SSH</li>
</ul>
<p><strong>ä½ ç°åœ¨çš„å®‰å…¨é…ç½®æ°´å¹³ï¼Œå·²ç»è¶…è¿‡ç»å¤§å¤šæ•° Linux ç”¨æˆ·äº†ã€‚</strong></p>
<p>ä¸‹ä¸€æ­¥ä½ å¯ä»¥é€‰ï¼ˆæˆ‘ä¸å¼ºè¿«ï¼Œä½†éƒ½å¾ˆé¡ºï¼‰</p>
<p>1ï¸âƒ£ æŠŠ <code>ssh-add -L</code> è¾“å‡ºçš„å…¬é’¥åŠ åˆ° <strong>GitHub</strong><br>
2ï¸âƒ£ æµ‹è¯•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>3ï¸âƒ£ æˆ–è€…æˆ‘å¸®ä½  <strong>æ¸…ç†å¤šä½™çš„ <code>[S]</code> å­é’¥</strong>ï¼Œè®©ç»“æ„æ›´æç®€</p>
<p>ä½ ç°åœ¨å…ˆæŠŠ</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>çš„è¾“å‡ºç»“æœè´´æˆ‘ï¼ˆå“ªæ€•ä¸€è¡Œï¼‰ï¼Œæˆ‘å¯ä»¥å¸®ä½ <strong>æœ€åéªŒæ”¶</strong>ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-1-ssh--t-gitgithubcom--system-0138">æ’æŸ¥åœºæ™¯ 1. ssh -T <a href="mailto:git@github.com">git@github.com</a> î˜— system 01:38â€¦</h3>
<ul>
<li>åœºæ™¯ï¼šssh -T <a href="mailto:git@github.com">git@github.com</a> î˜— system 01:38â€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
ä½ è¿™æ¡è¾“å‡º<strong>å…¶å®æ˜¯â€œæˆåŠŸäº† 90% + è¿˜æœ‰ä¸€ä¸ªå°æ¯›åˆºâ€</strong>ï¼Œã€‚</li>
</ul>
<p>å…³é”®ç‚¹åœ¨è¿™é‡Œï¼š</p>
<ul>
<li><code>Hi LosFurina! You've successfully authenticated</code><br>
è¯´æ˜ <strong>GPG â†’ SSH â†’ GitHub å·²ç»æ‰“é€š</strong>ï¼ˆçœŸçš„é€šäº†ï¼Œå·²ç»èƒ½è®¤å‡ºä½ çš„è´¦å·ï¼‰</li>
<li>ï¸ ä½†å‰é¢é‚£å¥ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    sign_and_send_pubkey: signing failed ... agent refused operation</span></span></code></pre>
<p>è¯´æ˜ï¼š<strong>GitHub è¿™æ¬¡è¿æ¥é‡Œï¼ŒSSH è¯•å›¾ç”¨ä½  agent é‡Œçš„æŸä¸ª ED25519 èº«ä»½å»ç­¾åè®¤è¯ï¼Œä½† gpg-agent æ‹’ç»äº†å…¶ä¸­ä¸€ä¸ªå°è¯•</strong>ã€‚</p>
<p>é€šå¸¸åŸå› å°±ä¸¤ç±»ï¼ˆæˆ‘ç«™é˜Ÿç»™ä½ åˆ¤æ–­ï¼‰ï¼š<strong>99% æ˜¯â€œå¤šä¸ªèº«ä»½/å¤šä¸ª keygrip æš´éœ²äº†ï¼Œagent å…ˆå°è¯•äº†ä¸€ä¸ªä¸å¯¹/ä¸å…è®¸çš„â€ï¼Œæˆ–è€…â€œagent éœ€è¦ä½ ç¡®è®¤/è¾“å…¥ PINï¼Œä½† pinentry æ²¡å¼¹å‡ºæ¥å¯¼è‡´æ‹’ç»â€ã€‚</strong><br>
ä½†å› ä¸ºæœ€ç»ˆè¿˜æ˜¯è®¤è¯æˆåŠŸäº†ï¼Œè¯´æ˜å®ƒéšåæ¢äº†å¦ä¸€ä¸ªèº«ä»½ï¼ˆå¯¹çš„é‚£ä¸ªï¼‰é€šè¿‡äº†ã€‚</p>
<p>ä¸‹é¢ç»™ä½ æŠŠè¿™ä¸ªâ€œæ¯›åˆºâ€å½»åº•æŠ¹å¹³ã€‚</p>
<ol>
<li>å…ˆçœ‹ï¼šSSH åˆ°åº•åœ¨å°è¯•å“ªäº› keyï¼ˆæœ€ç›´æ¥å®šä½ï¼‰</li>
</ol>
<p>è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vvv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p><strong>æ³¨è§£</strong>ï¼š<code>-vvv</code> = æ‰“å¼€è¶…è¯¦ç»†è°ƒè¯•æ—¥å¿—ï¼Œä¼šæ˜¾ç¤ºå®ƒä¾æ¬¡å°è¯•äº†å“ªäº› keyã€å“ªä¸ªè¢«æ‹’ç»ã€å“ªä¸ªæˆåŠŸã€‚</p>
<p>ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š</p>
<ul>
<li><code>Offering public key ...</code></li>
<li><code>sign_and_send_pubkey ... agent refused operation</code></li>
<li>æœ€åæŸä¸ª key <code>Authenticated to github.com</code></li>
</ul>
<p>åªè¦ç¡®è®¤ï¼š<strong>å“ªä¸ª key è¢«æ‹’ç»</strong>ã€<strong>å“ªä¸ª key æˆåŠŸ</strong>ï¼Œæˆ‘ä»¬å°±èƒ½å¯¹ç—‡ä¸‹è¯ã€‚</p>
<ol start="2">
<li>æœ€å¸¸è§æ ¹å› ï¼šä½ æš´éœ²ç»™ SSH çš„ key å¤ªå¤š / é¡ºåºä¸å¯¹</li>
</ol>
<p>ä½ å¾ˆå¯èƒ½ç°åœ¨ <code>~/.gnupg/sshcontrol</code> é‡Œä¸æ­¢ä¸€ä¸ª keygripï¼ˆæ¯”å¦‚ä½ ä¹‹å‰è¯¯åŠ äº† <code>[S]</code> çš„ï¼Œæˆ–è€…è¿˜æœ‰å…¶å®ƒå¡/æ—§ keyï¼‰ã€‚</p>
<h3 id="21-çœ‹çœ‹-sshcontrol-é‡Œåˆ°åº•æœ‰å“ªäº›">2.1 çœ‹çœ‹ sshcontrol é‡Œåˆ°åº•æœ‰å“ªäº›</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<p><strong>æ³¨è§£</strong>ï¼šåˆ—å‡º gpg-agent å…è®¸ä½œä¸º SSH key çš„ keygripã€‚</p>
<p>ä¸€èˆ¬æˆ‘å»ºè®®ï¼š<strong>åªç•™ <code>[A]</code> é‚£æŠŠ</strong>ï¼Œåˆ«çš„éƒ½åˆ æ‰ï¼ˆæœ€å¹²å‡€ï¼Œæœ€å°‘éº»çƒ¦ï¼‰ã€‚</p>
<h3 id="22-å†ç¡®è®¤-a-çš„-keygrip-æ˜¯å“ªä¸²">2.2 å†ç¡®è®¤ <code>[A]</code> çš„ keygrip æ˜¯å“ªä¸²</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg</span><span style="color:#79B8FF"> --list-secret-keys</span><span style="color:#79B8FF"> --with-keygrip</span></span></code></pre>
<p>æ‰¾åˆ° <code>[A]</code> é‚£è¡Œä¸‹é¢çš„ <code>Keygrip = ...</code>ã€‚</p>
<h3 id="23-è®©-sshcontrol-åªä¿ç•™-a-é‚£ä¸€ä¸²">2.3 è®© sshcontrol åªä¿ç•™ <code>[A]</code> é‚£ä¸€ä¸²</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span><span style="color:#6A737D">   # æ³¨ï¼šç¼–è¾‘å…è®¸æš´éœ²ç»™ SSH çš„ key åˆ—è¡¨</span></span></code></pre>
<p>åªç•™ä¸€è¡Œï¼šä½ çš„ <code>[A]</code> keygripã€‚</p>
<p>é‡å¯ agentï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#6A737D">  # æ³¨ï¼šé‡å¯ gpg-agent è®© sshcontrol ç”Ÿæ•ˆ</span></span></code></pre>
<p>å†è¯•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<ol start="3">
<li>æ¬¡å¸¸è§æ ¹å› ï¼špinentry æ²¡å¼¹çª— / TTY æ²¡è®¾å¥½å¯¼è‡´â€œæ‹’ç»æ“ä½œâ€</li>
</ol>
<p>å¦‚æœ gpg-agent åœ¨ç­¾åæ—¶éœ€è¦ä½ è¾“å…¥ passphrase æˆ–ç¡®è®¤ï¼Œä½† pinentry å¼¹ä¸å‡ºæ¥ï¼Œå®ƒå°±ä¼šâ€œæ‹’ç»â€ã€‚</p>
<p>ä½ å·²ç»æœ‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>å¾ˆå¥½ã€‚</p>
<p>å†æ£€æŸ¥ä¸¤ä»¶äº‹ï¼š</p>
<h3 id="31-ä½ çš„-pinentry-ç¨‹åºæ˜¯å¦è®¾ç½®--å­˜åœ¨">3.1 ä½ çš„ pinentry ç¨‹åºæ˜¯å¦è®¾ç½® &#x26; å­˜åœ¨</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-options</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> grep</span><span style="color:#79B8FF"> -i</span><span style="color:#9ECBFF"> pinentry</span></span></code></pre>
<p>ä»¥åŠç¡®è®¤æ–‡ä»¶ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span></span></code></pre>
<p>é‡Œé¢åº”è¯¥æœ‰ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span>
<span class="line"><span>enable-ssh-support</span></span></code></pre>
<p>å¦‚æœä½ æ˜¯ KDEï¼Œ<code>pinentry-qt</code> é€šå¸¸æœ€ç¨³ã€‚</p>
<p>æ”¹å®Œç…§ä¾‹é‡å¯ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<ol start="4">
<li>æœ€çœå¿ƒçš„â€œå·¥ç¨‹è§£æ³•â€ï¼šåªå¯¹ github æŒ‡å®šå”¯ä¸€ IdentityFile</li>
</ol>
<p>å°±ç®—ä½  agent é‡Œæœ‰å¤šä¸ª keyï¼Œä½ ä¹Ÿå¯ä»¥è®© SSH <strong>å¯¹ GitHub åªç”¨æŸä¸€æŠŠ</strong>ï¼Œé¿å…å®ƒå…ˆè¯•é”™å†è¢«æ‹’ç»ã€‚</p>
<p>åšæ³•ï¼š</p>
<h3 id="41-æ‰¾åˆ°ä½ è¦ç”¨çš„é‚£æ¡-ssh-å…¬é’¥ä»-agent-è¾“å‡ºé‡ŒæŒ‘-github-é‚£æ¡">4.1 æ‰¾åˆ°ä½ è¦ç”¨çš„é‚£æ¡ SSH å…¬é’¥ï¼ˆä» agent è¾“å‡ºé‡ŒæŒ‘ GitHub é‚£æ¡ï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>çœ‹å®ƒå¯¹åº”çš„æ˜¯å“ªæ¡ï¼ˆé€šå¸¸ä½ å°±ä¸€æ¡ï¼‰ã€‚</p>
<h3 id="42-å†™-sshconfigæ²¡æœ‰å°±æ–°å»º">4.2 å†™ <code>~/.ssh/config</code>ï¼ˆæ²¡æœ‰å°±æ–°å»ºï¼‰</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> ~/.ssh</span></span>
<span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.ssh/config</span><span style="color:#6A737D">   # æ³¨ï¼šSSH å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ï¼Œç»™ä¸åŒåŸŸåå•ç‹¬ç­–ç•¥</span></span></code></pre>
<p>å†™å…¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span></code></pre>
<p><strong>è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>IdentitiesOnly yes</code>ï¼šåªç”¨ä½ æ˜ç¡®æä¾›çš„èº«ä»½ï¼ˆä¸ä¹±è¯•ï¼‰</li>
<li>ç”±äºä½ ç”¨çš„æ˜¯ agentï¼ˆä¸æ˜¯æ–‡ä»¶ï¼‰ï¼Œè¿™ä¸ªé…ç½®ä¹Ÿèƒ½è®©å®ƒæ›´â€œä¸“ä¸€â€ï¼Œå‡å°‘çå°è¯•ã€‚</li>
</ul>
<p>å¦‚æœä½ è¿˜æœ‰å…¶å®ƒ SSH key æ–‡ä»¶ï¼ˆ<code>~/.ssh/id_ed25519</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œå¼ºåˆ¶ä¸ç”¨å®ƒã€‚</p>
<p>ä½ ç°åœ¨åˆ°åº•æœ‰æ²¡æœ‰â€œé—®é¢˜â€ã€‚</p>
<p>æˆ‘çš„åˆ¤æ–­å¾ˆæ˜ç¡®ï¼š</p>
<ul>
<li>åŠŸèƒ½ä¸Šæ²¡é—®é¢˜ï¼ˆå·²ç»ç™»å½•æˆåŠŸï¼‰</li>
<li>ï¸ ä½“éªŒä¸Šæœ‰å°ç‘•ç–µï¼ˆå…ˆæ‹’ç»å†æˆåŠŸï¼‰ï¼Œè¿™ä¼šåœ¨æŸäº›åœºæ™¯ï¼ˆæ¯”å¦‚æŸäº› Git æ“ä½œ/å¤š key æƒ…å†µï¼‰å˜å¾—çƒ¦</li>
</ul>
<p>ä½ ä¸‹ä¸€æ­¥å°±åšè¿™ä¸¤ä»¶äº‹ï¼ˆæˆ‘ç»™ä½ æœ€çŸ­è·¯å¾„ï¼‰</p>
<ol>
<li>è´´ä¸€ä¸‹è¿™æ¡çš„è¾“å‡ºï¼ˆæˆ‘å°±èƒ½ç«‹åˆ»å‘Šè¯‰ä½ è¯¥åˆ å“ªæ¡ keygripï¼‰ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<ol start="2">
<li>å†è·‘ä¸€æ¬¡è¯¦ç»†æ—¥å¿—ï¼ˆä½ ä¸ç”¨ç†è§£ï¼Œæˆ‘æ¥è¯»ï¼‰ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vvv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ è´´å‡ºæ¥åï¼Œæˆ‘ä¼šç›´æ¥å‘Šè¯‰ä½ ï¼š</p>
<ul>
<li>å“ªä¸ª key æ˜¯â€œè¢«æ‹’ç»çš„â€</li>
<li>sshcontrol åº”è¯¥åªç•™å“ªä¸€ä¸²</li>
<li>æ˜¯å¦éœ€è¦åŠ¨ pinentry / agent è®¾ç½®</li>
</ul>
<h3 id="æ’æŸ¥åœºæ™¯-2-ssh--vvv--t-gitgithubcom--system">æ’æŸ¥åœºæ™¯ 2. ssh -vvv -T <a href="mailto:git@github.com">git@github.com</a> î˜— systemâ€¦</h3>
<ul>
<li>åœºæ™¯ï¼šssh -vvv -T <a href="mailto:git@github.com">git@github.com</a> î˜— systemâ€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
è¿™ä»½ <code>-vvv</code> æ—¥å¿—æŠŠé”…æªå¾—ä¸€æ¸…äºŒæ¥šï¼š<strong>ä½ ç°åœ¨åŒæ—¶æœ‰ä¸¤æŠŠ SSH èº«ä»½åœ¨å‚ä¸è®¤è¯</strong>â€”â€”ä¸€æŠŠæ¥è‡ª <strong>gpg-agent</strong>ï¼Œä¸€æŠŠæ¥è‡ªä½ æœ¬åœ°çš„ <code>~/.ssh/id_ed25519</code>ã€‚ç¬¬ä¸€æŠŠï¼ˆgpg-agentï¼‰åœ¨â€œç­¾åé˜¶æ®µâ€è¢« agent æ‹’äº†ï¼Œäºæ˜¯ SSH é€€è€Œæ±‚å…¶æ¬¡ç”¨ç¬¬äºŒæŠŠï¼ˆ<code>~/.ssh/id_ed25519</code>ï¼‰æˆåŠŸäº†ã€‚</li>
</ul>
<p>çœ‹è¿™é‡Œä¸¤æ®µå°±æ˜¯é“è¯ï¼š</p>
<ul>
<li>gpg-agent é‚£æŠŠè¢«æ¥å—åç­¾åå¤±è´¥ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    Will attempt key: (none) ... agent</span></span>
<span class="line"><span>    Server accepts key: (none) ... agent</span></span>
<span class="line"><span>    sign_and_send_pubkey ... agent refused operation</span></span></code></pre>
<ul>
<li>ç„¶åæœ¬åœ° <code>~/.ssh/id_ed25519</code> æˆåŠŸï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    Offering public key: /home/wayne/.ssh/id_ed25519 ...</span></span>
<span class="line"><span>    Authenticated ... using "publickey".</span></span></code></pre>
<p>æ‰€ä»¥ï¼š ä½ ç°åœ¨ç¡®å®èƒ½ç™»å½• GitHubï¼Œä½†<strong>å®é™…ç”¨çš„ä¸æ˜¯ GPG é‚£æŠŠ</strong>ï¼Œè€Œæ˜¯ä½  <code>.ssh/id_ed25519</code>ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ï¼š<strong>è®© GitHub åªç”¨ GPG é‚£æŠŠï¼Œä¸”ä¸å†è¢«æ‹’ç»</strong>ã€‚</p>
<p>å…ˆç»™ç»“è®ºï¼šæ€ä¹ˆä¸€æŠŠæ¢­è§£å†³</p>
<p>æˆ‘å»ºè®®ä½ åšä¸¤æ­¥ï¼ˆéƒ½å¾ˆçŸ­ï¼‰ï¼š</p>
<ol>
<li><strong>å¯¹ github.com å¼ºåˆ¶åªç”¨ gpg-agent çš„èº«ä»½</strong>ï¼ˆä¸å†å°è¯• <code>~/.ssh/id_ed25519</code>ï¼Œé¿å…â€œæˆåŠŸä½†ä¸æ˜¯ä½ æƒ³è¦çš„æˆåŠŸâ€ï¼‰</li>
<li><strong>ä¿®æ‰ gpg-agent â€œagent refused operationâ€ çš„åŸå› </strong>ï¼ˆé€šå¸¸æ˜¯ gpg-agent çš„ SSH ç­¾åç­–ç•¥/ç¡®è®¤è®¾ç½®å¯¼è‡´æ‹’ç»ï¼‰</li>
</ol>
<p>â‘  è®© GitHub åªç”¨ gpg-agentï¼ˆå…³é”®ï¼šIdentitiesOnly + ä¸ç”¨ id_ed25519ï¼‰</p>
<p>ç¼–è¾‘ <code>~/.ssh/config</code>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.ssh/config</span><span style="color:#6A737D">   # æ³¨ï¼šSSH å®¢æˆ·ç«¯é…ç½®ï¼Œä¸åŒç«™ç‚¹ç”¨ä¸åŒç­–ç•¥</span></span></code></pre>
<p>åŠ ä¸Šï¼ˆæˆ–æ”¹æˆè¿™æ ·ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent ~/.gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<p>è§£é‡Šä¸€ä¸‹æ¯è¡Œâ€œåˆ°åº•å¹²å˜›â€ï¼š</p>
<ul>
<li><code>IdentityAgent ~/.gnupg/S.gpg-agent.ssh</code><br>
æ˜ç¡®å‘Šè¯‰ sshï¼š<strong>ç”¨ gpg-agent è¿™ä¸ª agent</strong>ï¼ˆä¸ç”¨ç³»ç»Ÿé»˜è®¤/åˆ«çš„ agentï¼‰</li>
<li><code>IdentitiesOnly yes</code><br>
åªç”¨ä½ æŒ‡å®šçš„èº«ä»½æ¥æºï¼Œåˆ«å†ä¹±ç¿»ä½ ç£ç›˜ä¸Šçš„ <code>~/.ssh/id_*</code></li>
<li><code>IdentityFile none</code><br>
è¿™æ‹›æ˜¯â€œå°æ­»åè·¯â€ï¼Œè®©å®ƒåˆ«å»ç¢° <code>~/.ssh/id_ed25519</code>ï¼ˆå¦åˆ™å®ƒæ€»ä¼šå…œåº•æˆåŠŸï¼Œä½ çœ‹ä¸å‡ºé—®é¢˜åˆ°åº•ä¿®æ²¡ä¿®å¥½ï¼‰</li>
</ul>
<p>ä¿å­˜é€€å‡ºåï¼Œé‡æ–°è¯•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>å¦‚æœè¿™ä¸€æ­¥ä¹‹åç›´æ¥å¤±è´¥äº†â€”â€”åˆ«æ€•ï¼Œè¿™è¯´æ˜æˆ‘ä»¬ç»ˆäºæŠŠâ€œé®ç¾å¸ƒâ€æ€äº†ï¼šé—®é¢˜åªå‰©ä¸‹ gpg-agent æ‹’ç­¾åè¿™ä¸€ä¸ªç‚¹ã€‚</p>
<p>â‘¡ ä¿® gpg-agent çš„ â€œagent refused operationâ€ï¼ˆè®©å®ƒæ„¿æ„ç»™ SSH ç­¾åï¼‰</p>
<p>ä½ æ—¥å¿—é‡Œè¿˜æœ‰ä¸€è¡Œéå¸¸å…³é”®ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh_agent_bind_hostkey: agent refused operation</span></span></code></pre>
<p>è¿™é€šå¸¸è·Ÿ OpenSSH æ–°çš„â€œhost-bound keys / hostbound æ‰©å±•â€æœ‰å…³ï¼šSSH å®¢æˆ·ç«¯ä¼šè·Ÿ agent ç»‘å®šä¸»æœº key åšä¸€äº›å¢å¼ºæ ¡éªŒï¼›æœ‰äº› agentï¼ˆåŒ…æ‹¬ gpg-agent çš„ ssh ä»¿çœŸï¼‰ä¼šæ‹’ç»è¿™ä¸ªç»‘å®šæ“ä½œï¼Œä½†è¿™æœ¬èº«ä¸ä¸€å®šè‡´å‘½ã€‚çœŸæ­£è‡´å‘½çš„æ˜¯åé¢ <strong>ç­¾åè¯·æ±‚è¢«æ‹’ç»</strong>ã€‚</p>
<p>æœ€å¸¸è§çš„åŸå› æ˜¯ï¼š<strong>gpg-agent çš„ SSH æ¨¡å¼éœ€è¦â€œæ˜ç¡®å…è®¸/ç¡®è®¤â€æŸæŠŠ keygrip ç”¨äº SSH</strong>ï¼Œæˆ–éœ€è¦ pinentry äº¤äº’ä½†æ²¡æˆåŠŸè§¦å‘ã€‚</p>
<p>æˆ‘ä»¬æŒ‰â€œæœ€çŸ­è¯Šæ–­é“¾â€èµ°ï¼š</p>
<p>2.1 å…ˆç¡®è®¤ gpg-agent è§†è§’é‡Œç¡®å®æœ‰ SSH key</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpg-connect-agent</span><span style="color:#9ECBFF"> "keyinfo --ssh-list"</span><span style="color:#9ECBFF"> /bye</span></span></code></pre>
<ul>
<li>å¦‚æœè¿™é‡Œèƒ½çœ‹åˆ° 1 æŠŠ keyï¼šOKï¼Œç»§ç»­</li>
<li>å¦‚æœè¿™é‡Œæ˜¯ç©ºçš„ï¼šè¯´æ˜ <code>~/.gnupg/sshcontrol</code> è¿˜æ²¡é…å¯¹ï¼ˆä½†ä½ ä¹‹å‰ <code>ssh-add -L</code> å·²ç»èƒ½çœ‹åˆ° 1 keyï¼Œæ‰€ä»¥å¤§æ¦‚ç‡æ²¡é—®é¢˜ï¼‰</li>
</ul>
<p>2.2 çœ‹çœ‹ gpg-agent æœ‰æ²¡æœ‰è¦æ±‚â€œæ¯æ¬¡ç¡®è®¤â€ï¼ˆå¯èƒ½å¯¼è‡´æ‹’ç»ï¼‰</p>
<p>æ‰“å¼€é…ç½®ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span><span style="color:#6A737D">   # æ³¨ï¼šgpg-agent é…ç½®æ–‡ä»¶</span></span></code></pre>
<p>æŠŠä¸‹é¢ä¸¤è¡ŒåŠ ä¸Šï¼ˆå¦‚æœæ²¡æœ‰çš„è¯ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>enable-ssh-support</span></span>
<span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span></code></pre>
<p>ç„¶å<strong>å†åŠ ä¸€è¡Œéå¸¸å®ç”¨çš„</strong>ï¼ˆé¿å…æŸäº›æƒ…å†µä¸‹ä¸å¼¹çª—å¯¼è‡´æ‹’ç»ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>allow-loopback-pinentry</span></span></code></pre>
<p>ä¿å­˜åé‡å¯ agentï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#6A737D">      # æ³¨ï¼šé‡å¯ gpg-agent ä½¿é…ç½®ç”Ÿæ•ˆ</span></span></code></pre>
<p>å¹¶ä¸”ç¡®ä¿ä½ çš„ shell é‡Œæœ‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)         </span><span style="color:#6A737D"># æ³¨ï¼šè®© gpg çŸ¥é“å½“å‰ç»ˆç«¯ï¼ŒTTY ä¸‹ pinentry æ‰èƒ½æ­£å¸¸å·¥ä½œ</span></span></code></pre>
<p>ï¼ˆä½ å·²ç»å†™åœ¨ <code>.zshrc.local</code> é‡Œäº† ï¼‰</p>
<p>å†è¯•ä¸€æ¬¡ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>2.3 å¦‚æœä»ç„¶ â€œagent refused operationâ€ï¼Œæˆ‘ä»¬å°±ç”¨ç»ˆæå®šä½ï¼šè®© SSH åªåˆ— agent çš„ keyï¼Œä¸ç¢°æ–‡ä»¶ key</p>
<p>è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<p>ä½ ç°åœ¨åº”è¯¥åªå‰© gpg-agent é‚£æŠŠäº†ï¼ˆå› ä¸ºæˆ‘ä»¬ç»™ github.com é…äº† IdentityAgentï¼‰ã€‚</p>
<p>å¦‚æœ <code>ssh-add -L</code> ä»èƒ½åˆ—å‡º keyï¼Œä½† <code>ssh -T</code> ä»æ‹’ç­¾åï¼Œé‚£å°±è¯´æ˜ï¼š<strong>åˆ— key OKï¼Œç­¾åè¢« policy æ‹’ç»</strong>ã€‚</p>
<p>è¿™æ—¶å€™æœ€æœ‰æ•ˆçš„ä¸€æ‹›æ˜¯ï¼š<strong>æŠŠ gpg-agent çš„ SSH key è®¾ç½®æˆâ€œç¡®è®¤ä¸€æ¬¡åç¼“å­˜â€</strong>ï¼ˆå¦åˆ™å®ƒå¯èƒ½é»˜è®¤æ‹’ç» hostbound æˆ–æŸç§ç­¾åè¯·æ±‚ï¼‰ã€‚</p>
<p>æ£€æŸ¥ä½  <code>~/.gnupg/sshcontrol</code> æ¯è¡Œæœ«å°¾æœ‰æ²¡æœ‰ â€œconfirmâ€ ä¹‹ç±»çš„æ ‡è®°ã€‚ä½ å¯ä»¥ç›´æ¥è´´ä¸€ä¸‹å®ƒå†…å®¹æˆ‘å¸®ä½ åˆ¤æ–­ï¼Œä½†ä½ ä¹Ÿå¯ä»¥è‡ªå·±çœ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<ul>
<li>å¦‚æœæŸè¡Œåé¢å¸¦äº† <code>confirm</code>ï¼Œé‚£æ¯æ¬¡ç­¾åéƒ½è¦å¼¹ç¡®è®¤ï¼›å¼¹ä¸å‡ºæ¥å°±æ‹’ç»<br>
ä½ å¯ä»¥å…ˆå»æ‰ <code>confirm</code>ï¼ˆåªä¿ç•™ keygrip é‚£ä¸²ï¼‰ï¼Œé‡å¯ agent å†è¯•ã€‚</li>
</ul>
<p>æˆ‘æ›´å€¾å‘çš„â€œå¹²å‡€æ–¹æ¡ˆâ€ï¼ˆæˆ‘ç«™é˜Ÿï¼‰</p>
<p>ä½ ç°åœ¨å…¶å®ä¸ç¼º SSH keyï¼šä½ å·²ç»æœ‰ <code>~/.ssh/id_ed25519</code>ï¼Œå®ƒä¹Ÿèƒ½ç”¨ã€‚<br>
ä½†ä½ æ—¢ç„¶è¦èµ° <strong>GPG ç»Ÿä¸€ç®¡ç†</strong>ï¼Œé‚£å°±åº”è¯¥ï¼š</p>
<ul>
<li>GitHub åªç”¨ gpg-agentï¼ˆä¸å†æ··ç”¨æœ¬åœ° keyï¼‰</li>
<li>æŠŠæœ¬åœ° <code>~/.ssh/id_ed25519</code> ä» GitHub è¿™æ¡çº¿è·¯ä¸Šâ€œéš”ç¦»â€å‡ºå»ï¼ˆå¦åˆ™æ°¸è¿œçœ‹ä¸å‡º gpg-agent æ˜¯å¦çœŸçš„å·¥ä½œï¼‰</li>
</ul>
<p>ä½ ä¸‹ä¸€æ­¥ç…§æˆ‘åšè¿™ä¸‰æ¡ï¼Œå°±èƒ½æ”¶å£</p>
<ol>
<li>æŠŠè¿™æ®µå†™è¿› <code>~/.ssh/config</code>ï¼ˆä¸Šé¢é‚£æ®µï¼‰</li>
<li>é‡å¯ agentï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<ol start="3">
<li>å†è·‘ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>å¦‚æœè¿˜å¤±è´¥ï¼Œä½ æŠŠè¿™ä¸¤æ¡è¾“å‡ºè´´æˆ‘ï¼ˆå¾ˆçŸ­ï¼Œæˆ‘ä¸€çœ¼å°±èƒ½åˆ¤ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.ssh/config</span></span>
<span class="line"><span style="color:#B392F0">cat</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<p>æˆ‘ä¼šç›´æ¥å‘Šè¯‰ä½ ï¼šæ˜¯ <strong>IdentityAgent æ²¡åƒåˆ°</strong>ï¼Œè¿˜æ˜¯ <strong>sshcontrol æœ‰ confirm/å†™é”™ keygrip</strong>ï¼Œæˆ–è€…æ˜¯ <strong>pinentry policy å¯¼è‡´æ‹’ç­¾å</strong>ã€‚</p>
<h3 id="ä¸»é¢˜-13-vim-gnupggpg-agentconf">ä¸»é¢˜ 13. vim ~/.gnupg/gpg-agent.conf</h3>
<p>ä½ è¿™ä»½ <code>gpg-agent.conf</code> ç°åœ¨æœ€å¤§çš„â€œé—®é¢˜æ°”è´¨â€æ˜¯ï¼š<strong>ä½ åœ¨æ¡Œé¢ç¯å¢ƒï¼ˆKDEï¼‰å´ç”¨ <code>pinentry-curses</code></strong>ã€‚å®ƒä¸æ˜¯ä¸èƒ½ç”¨ï¼Œä½†ç‰¹åˆ«å®¹æ˜“å‡ºç°è¿™ç§æƒ…å†µï¼š</p>
<blockquote>
<p>SSH/GPG éœ€è¦ä½ è¾“å…¥ passphrase æˆ–ç¡®è®¤æ—¶ï¼Œcurses éœ€è¦â€œå ç”¨å½“å‰ TTYâ€ã€‚<br>
ç»“æœä½ è·‘ <code>ssh -T git@github.com</code> æ—¶ï¼Œå®ƒæ²¡æ³•é¡ºåˆ©æŠŠè¾“å…¥ç•Œé¢æ¥ç®¡è¿‡æ¥ â†’ <strong>agent ç›´æ¥æ‹’ç»æ“ä½œ</strong>ï¼ˆä½ çœ‹åˆ°çš„ <code>agent refused operation</code>ï¼‰ã€‚</p>
</blockquote>
<p>è€Œä¸”ä½ ç°åœ¨çš„æ—¥å¿—è¿˜æ˜¾ç¤ºï¼šSSH æœ€ç»ˆç”¨äº†ä½ æœ¬åœ° <code>~/.ssh/id_ed25519</code> æˆåŠŸäº†ï¼Œæ‰€ä»¥ gpg-agent é‚£æŠŠå¡ä½ä¹Ÿä¸å½±å“æœ€ç»ˆè®¤è¯â€”â€”è¿™å°±æ›´åƒâ€œpinentry æ²¡å¼¹å‡ºæ¥å¯¼è‡´æ‹’ç­¾åâ€ã€‚</p>
<p>æˆ‘å»ºè®®ä½ ç›´æ¥æŠŠå®ƒæ”¹æˆ <strong>GUI pinentryï¼ˆKDE ç”¨ qtï¼‰</strong>ï¼Œå†åŠ ä¸€æ¡æ›´ç¨³çš„è®¾ç½®ã€‚</p>
<ol>
<li>å…ˆç¡®è®¤ä½ æœºå™¨ä¸Šæœ‰æ²¡æœ‰ pinentry-qt</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ls</span><span style="color:#9ECBFF"> /usr/bin/pinentry</span><span style="color:#79B8FF">*</span><span style="color:#6A737D">   # æ³¨ï¼šåˆ—å‡ºæ‰€æœ‰ pinentry å˜ä½“</span></span></code></pre>
<p>ä½ å¤§æ¦‚ç‡ä¼šçœ‹åˆ° <code>/usr/bin/pinentry-qt</code> æˆ– <code>/usr/bin/pinentry-qt5</code>ï¼ˆåå­—å¯èƒ½ç•¥ä¸åŒï¼‰ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ï¼Œå°±è£…ä¸€ä¸‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> pacman</span><span style="color:#79B8FF"> -S</span><span style="color:#9ECBFF"> pinentry</span><span style="color:#6A737D">  # æ³¨ï¼šå®‰è£… pinentryï¼ˆé€šå¸¸ä¼šå¸¦å¤šä¸ªå‰ç«¯ï¼‰</span></span></code></pre>
<p>ï¼ˆå¦‚æœä½ ç³»ç»Ÿæ‹†å¾—å¾ˆç»†ï¼Œç¼º qt ç‰ˆæœ¬å†è£…ï¼š<code>sudo pacman -S pinentry-qt</code>ï¼Œçœ‹ä½ ä»“åº“åŒ…åå®é™…æƒ…å†µã€‚ï¼‰</p>
<ol start="2">
<li>ä¿®æ”¹ gpg-agent.confï¼ˆç”¨ KDE æœ€ç¨³çš„é…ç½®ï¼‰</li>
</ol>
<p>ç¼–è¾‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span><span style="color:#6A737D">    # æ³¨ï¼šgpg-agent é…ç½®æ–‡ä»¶</span></span></code></pre>
<p>æŠŠä½ ç°åœ¨è¿™è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-curses</span></span></code></pre>
<p>æ”¹æˆï¼ˆä¼˜å…ˆé€‰å­˜åœ¨çš„é‚£ä¸ªè·¯å¾„ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span></code></pre>
<p>ç„¶åæˆ‘å»ºè®®ä½ <strong>é¢å¤–åŠ ä¸¤è¡Œ</strong>ï¼ˆå¾ˆå®ç”¨ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>allow-loopback-pinentry</span></span></code></pre>
<p>ä»¥åŠï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>default-cache-ttl 600</span></span>
<span class="line"><span>max-cache-ttl 7200</span></span>
<span class="line"><span>enable-ssh-support</span></span></code></pre>
<p>æœ€åä½ æ–‡ä»¶å¯ä»¥é•¿è¿™æ ·ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span>
<span class="line"><span>default-cache-ttl 600</span></span>
<span class="line"><span>max-cache-ttl 7200</span></span>
<span class="line"><span>enable-ssh-support</span></span>
<span class="line"><span>allow-loopback-pinentry</span></span></code></pre>
<ol start="3">
<li>ç¡®ä¿ shell ç¯å¢ƒå˜é‡ï¼ˆä½ å·²ç»æœ‰äº†ï¼Œä½†æˆ‘è®©ä½ æ ¸å¯¹ä¸‹ï¼‰</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $GPG_TTY              </span><span style="color:#6A737D"># æ³¨ï¼šå½“å‰ç»ˆç«¯è®¾å¤‡ï¼Œpinentry/agent éœ€è¦å®ƒ</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $SSH_AUTH_SOCK        </span><span style="color:#6A737D"># æ³¨ï¼šSSH è¿æ¥å“ªä¸ª agent</span></span></code></pre>
<p>å¦‚æœ <code>GPG_TTY</code> æ˜¯ç©ºçš„ï¼ŒæŠŠä¸‹é¢è¿™è¡Œç¡®è®¤åœ¨ä½ çš„ <code>~/.zshrc.local</code> é‡Œï¼ˆä½ å·²ç»å†™äº† ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)</span></span></code></pre>
<ol start="4">
<li>é‡å¯ gpg-agentï¼ˆè®©é…ç½®ç”Ÿæ•ˆï¼‰</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span><span style="color:#6A737D">   # æ³¨ï¼šé‡å¯ gpg-agent</span></span></code></pre>
<ol start="5">
<li>å†æµ‹è¯•ï¼ˆè¿™æ¬¡åº”è¯¥å¹²å‡€å¾ˆå¤šï¼‰</li>
</ol>
<p>å…ˆçœ‹ agent æš´éœ²äº†å“ªäº› keyï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#6A737D">                 # æ³¨ï¼šåˆ—å‡º agent ä¸­çš„ SSH å…¬é’¥</span></span></code></pre>
<p>å†è¿ GitHubï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span><span style="color:#6A737D">      # æ³¨ï¼šæµ‹è¯• GitHub SSH è®¤è¯</span></span></code></pre>
<p>å¦‚æœä½ è¿˜æƒ³â€œå½»åº•çº¯å‡€â€ï¼šè®© GitHub åªç”¨ GPG é‚£æŠŠï¼ˆé¿å…æœ¬åœ° ~/.ssh/id_ed25519 æŠ¢æˆï¼‰</p>
<p>ä½ æ—¥å¿—é‡Œæ˜ç¡®æ˜¾ç¤ºå®ƒæœ€ç»ˆç”¨äº† <code>/home/wayne/.ssh/id_ed25519</code>ã€‚å¦‚æœä½ å¸Œæœ›<strong>å¼ºåˆ¶ GitHub åªèµ° gpg-agent</strong>ï¼ŒæŠŠè¿™ä¸ªå†™è¿› <code>~/.ssh/config</code>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> ~/.ssh</span></span>
<span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.ssh/config</span><span style="color:#6A737D">          # æ³¨ï¼šSSH å®¢æˆ·ç«¯é…ç½®</span></span></code></pre>
<p>å†™ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent ~/.gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<p>ç„¶åå†æµ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>è¿™æ ·å°±ä¸ä¼šâ€œå…ˆæ‹’ç»ä¸€æ¬¡å†ç”¨æœ¬åœ° key æˆåŠŸâ€ï¼Œèƒ½çœŸæ­£éªŒæ”¶ gpg-agent æ˜¯å¦ 100% OKã€‚</p>
<p>ä½ ç°åœ¨ä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆï¼ˆæœ€çŸ­è·¯å¾„ï¼‰</p>
<ol>
<li><code>ls /usr/bin/pinentry*</code> çœ‹ä½ åˆ°åº•æœ‰å“ªä¸ª qt ç‰ˆæœ¬</li>
<li>æŠŠ <code>pinentry-curses</code> æ”¹æˆ qt</li>
<li><code>gpgconf --kill gpg-agent</code></li>
<li><code>ssh -T git@github.com</code></li>
</ol>
<p>ä½ æŠŠ <code>ls /usr/bin/pinentry*</code> çš„è¾“å‡ºè´´æˆ‘ä¸€ä¸‹ï¼Œæˆ‘å¯ä»¥ç²¾ç¡®å‘Šè¯‰ä½ åº”è¯¥å†™ <code>pinentry-qt</code> è¿˜æ˜¯ <code>pinentry-qt5</code>ï¼ˆé¿å…è·¯å¾„å†™é”™å¯¼è‡´åˆå¡ä½ï¼‰ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-3-alias-tip-nv-sshconfig-æ³¨ssh-å®¢æˆ·">æ’æŸ¥åœºæ™¯ 3. Alias tip: nv ~/.ssh/config æ³¨ï¼šSSH å®¢æˆ·â€¦</h3>
<ul>
<li>åœºæ™¯ï¼šAlias tip: nv ~/.ssh/config æ³¨ï¼šSSH å®¢æˆ·â€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
ä½ ç°åœ¨è¿™ä¸ªçŠ¶æ€å…¶å®<strong>éå¸¸å¥åº·</strong>ï¼š</li>
</ul>
<ul>
<li><code>ssh-add -L</code> å·²ç»åªè¾“å‡ºäº† <strong>gpg-agent æš´éœ²çš„é‚£æŠŠ ssh-ed25519 å…¬é’¥</strong></li>
<li>ä½† <code>ssh -T git@github.com</code> ç›´æ¥ <code>Permission denied (publickey)</code><br>
è¿™æ„å‘³ç€ä¸€å¥è¯ï¼š</li>
</ul>
<blockquote>
<p><strong>ä½ å·²ç»å¼ºåˆ¶ SSH åªç”¨ GPG é‚£æŠŠé’¥åŒ™äº†ï¼Œä½† GitHub è´¦æˆ·é‡Œè¿˜æ²¡ç™»è®°è¿™æŠŠé’¥åŒ™</strong>ï¼ˆGitHub ä¸è®¤è¯†å®ƒï¼‰ï¼Œæ‰€ä»¥æ‹’ç»ã€‚</p>
</blockquote>
<p>ä½ ä¹‹å‰èƒ½ç™»å½•æˆåŠŸï¼Œæ˜¯å› ä¸ºå½“æ—¶ SSH å…œåº•ç”¨äº†ä½ ç£ç›˜ä¸Šçš„ <code>~/.ssh/id_ed25519</code>ï¼ˆGitHub è®¤è¯†é‚£æŠŠï¼‰ã€‚<br>
ç°åœ¨ä½ æŠŠåè·¯å°æ­»äº†ï¼ŒGitHub ä¸è®¤è¯†æ–°é’¥åŒ™å°±å¾ˆæ­£å¸¸ä¼šæ‹’ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼šæŠŠè¿™æŠŠ GPG-SSH å…¬é’¥åŠ åˆ° GitHub</p>
<p>ä½ å·²ç»æ‹¿åˆ°äº†å…¬é’¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#6A737D">   # æ³¨ï¼šåˆ—å‡º agent å½“å‰æä¾›çš„ SSH å…¬é’¥ï¼ˆä½ è¿™è¡Œå°±æ˜¯è¦æäº¤ç»™ GitHub çš„ï¼‰</span></span></code></pre>
<p>ä½ çœ‹åˆ°çš„æ˜¯ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEX3/... (none)</span></span></code></pre>
<p><strong>æ•´è¡Œå¤åˆ¶</strong>ï¼ˆä» <code>ssh-ed25519</code> å¼€å§‹åˆ°æœ€å <code>(none)</code> ä¹‹å‰ä¹Ÿè¡Œï¼Œä½†æ•´è¡Œæœ€çœäº‹ï¼‰ã€‚</p>
<p>æ–¹æ³• Aï¼šç½‘é¡µæ·»åŠ ï¼ˆæœ€å¸¸ç”¨ï¼‰</p>
<p>åˆ° GitHubï¼š</p>
<ul>
<li>Settings</li>
<li><strong>SSH and GPG keys</strong></li>
<li><strong>New SSH key</strong>
<ul>
<li>Titleï¼šæ¯”å¦‚ <code>gpg-agent ed25519</code></li>
<li>Keyï¼šç²˜è´´ä½ å¤åˆ¶çš„é‚£ä¸€æ•´è¡Œ</li>
<li>Key typeï¼šAuthentication Key</li>
</ul>
</li>
</ul>
<p>ä¿å­˜ã€‚</p>
<p>ç„¶åå†æµ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span><span style="color:#6A737D">   # æ³¨ï¼šæµ‹è¯• GitHub SSH è®¤è¯æ˜¯å¦é€šè¿‡</span></span></code></pre>
<p>æ­£å¸¸ä¼šè¿”å›ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Hi LosFurina! You've successfully authenticated, but GitHub does not provide shell access.</span></span></code></pre>
<p>æ–¹æ³• Bï¼šå¦‚æœä½ è£…äº† GitHub CLIï¼ˆ<code>gh</code>ï¼‰å¯ä»¥ä¸€æ¡å‘½ä»¤æå®š</p>
<p>å…ˆç¡®è®¤æœ‰æ²¡æœ‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">which</span><span style="color:#9ECBFF"> gh</span><span style="color:#6A737D">   # æ³¨ï¼šçœ‹ç³»ç»Ÿé‡Œæœ‰æ²¡æœ‰ GitHub CLI</span></span></code></pre>
<p>å¦‚æœæœ‰ï¼Œç›´æ¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> gh</span><span style="color:#9ECBFF"> ssh-key</span><span style="color:#9ECBFF"> add</span><span style="color:#9ECBFF"> -</span><span style="color:#79B8FF"> -t</span><span style="color:#9ECBFF"> "gpg-agent ed25519"</span><span style="color:#6A737D">   # æ³¨ï¼šæŠŠ agent è¾“å‡ºçš„å…¬é’¥ç›´æ¥å¯¼å…¥ GitHub</span></span></code></pre>
<p>ç„¶ååŒæ ·æµ‹è¯•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ ç°åœ¨çœ‹åˆ°çš„ <code>keyinfo --ssh-list</code> é‚£è¡Œæ˜¯ä»€ä¹ˆæ„æ€ã€‚</p>
<p>ä½ è¿™è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>S KEYINFO AB6926B8448C66F57CA1AA8075234FDA91A798B5 D - - - P - - S</span></span></code></pre>
<p>è¯´æ˜ gpg-agent <strong>ç¡®å®æœ‰ 1 æŠŠ SSH key</strong>ï¼Œå¹¶ä¸”å·²ç»å¯¹å¤–æä¾›äº†ï¼ˆæ‰€ä»¥ <code>ssh-add -L</code> æ‰èƒ½çœ‹åˆ°ï¼‰ã€‚<br>
ç°åœ¨å¤±è´¥ç‚¹åªå‰©ï¼š<strong>GitHub è¿˜æ²¡æ”¶å½•è¿™æŠŠå…¬é’¥</strong>ã€‚</p>
<p>é¢å¤–å»ºè®®ï¼šä½ ç°åœ¨çš„ ~/.ssh/config å¤§æ¦‚ç‡å·²ç»â€œé”æ­»åªç”¨ GPGâ€</p>
<p>ä½ åˆšæ‰æ”¹å®Œåç«‹åˆ»å°±å¼€å§‹ <code>Permission denied</code>ï¼Œè¿™å¾ˆåƒä½ åŠ äº†ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>IdentitiesOnly yes</span></span>
<span class="line"><span>IdentityFile none</span></span></code></pre>
<p>è¿™æ²¡é—®é¢˜ï¼Œåè€Œæ˜¯å¥½äº‹ï¼šå®ƒè®©ä½ ä¸ä¼šå†â€œæ‚„æ‚„ç”¨æ—§é’¥åŒ™æˆåŠŸâ€ï¼Œä»è€Œæ©ç›–é—®é¢˜ã€‚</p>
<p>ç­‰ä½ æŠŠæ–°é’¥åŒ™åŠ åˆ° GitHub åï¼Œè¿™ä¸ªé…ç½®å°±ä¼šå˜æˆä½ æƒ³è¦çš„â€œçº¯å‡€æ¨¡å¼â€ã€‚</p>
<p>å¦‚æœä½ æƒ³ä¿ç•™å…œåº•</p>
<p>å¦‚æœä½ æš‚æ—¶ä¸æƒ³è¢«é”æ­»ï¼Œå¯ä»¥å…ˆæŠŠ <code>IdentityFile none</code> æ³¨é‡Šæ‰ï¼Œè®©å®ƒè¿˜èƒ½ fallback åˆ° <code>~/.ssh/id_ed25519</code>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span># IdentityFile none</span></span></code></pre>
<p>ä½†æˆ‘ä¸ªäººå»ºè®®ï¼š<strong>ç°åœ¨å°±åˆ«å…œåº•</strong>ï¼Œç›´æ¥æŠŠæ–°é’¥åŒ™åŠ åˆ° GitHubï¼Œä¸€åŠ³æ°¸é€¸ã€‚</p>
<p>ä½ ç°åœ¨åšå®Œè¿™ä¸€æ­¥ï¼Œå›æˆ‘ä¸€å¥å°±è¡Œ</p>
<p>ä½ æŠŠ <code>ssh-add -L</code> é‚£è¡Œå…¬é’¥å·²ç»åŠ åˆ° GitHub ä¹‹åï¼Œå†è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>æŠŠè¾“å‡ºè´´æˆ‘ï¼Œæˆ‘å¸®ä½ ç¡®è®¤å·²ç»å®Œå…¨åˆ‡åˆ° <strong>GPG-SSH</strong> è¿™æŠŠé’¥åŒ™ï¼ˆè€Œä¸æ˜¯æ—§çš„ <code>~/.ssh/id_ed25519</code>ï¼‰ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-4-æˆ‘ç¡®å®šåœ¨githubæ·»åŠ äº†">æ’æŸ¥åœºæ™¯ 4. æˆ‘ç¡®å®šåœ¨githubæ·»åŠ äº†</h3>
<ul>
<li>åœºæ™¯ï¼šæˆ‘ç¡®å®šåœ¨githubæ·»åŠ äº†</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
ä½ è¿™æƒ…å†µæˆ‘ä¸è·Ÿä½ å®¢æ°”ï¼š<strong>ä½ â€œæ·»åŠ äº†â€è¿™æŠŠ keyï¼Œä½† GitHub è¿˜æ˜¯ä¸è®¤</strong>ï¼Œ99% ä¸æ˜¯ç„å­¦ï¼Œæ˜¯ä¸‹é¢å‡ ç§â€œéå¸¸å…·ä½“â€çš„é—®é¢˜ä¹‹ä¸€ï¼š</li>
</ul>
<ol>
<li>ä½ åŠ åˆ°çš„ä¸æ˜¯ <strong>å½“å‰ç™»å½•çš„è¿™ä¸ªè´¦å·ï¼ˆLosFurinaï¼‰</strong></li>
<li>ä½ åŠ é”™åœ°æ–¹äº†ï¼šåŠ åˆ°äº† <strong>GPG keys</strong> è€Œä¸æ˜¯ <strong>SSH keys</strong></li>
<li>ä½ åŠ åˆ°äº† <strong>Deploy keyï¼ˆæŸä¸ª repoï¼‰</strong>ï¼Œè€Œä¸æ˜¯è´¦å·çº§ SSH key</li>
<li>ä½ åŠ çš„æ˜¯å¯¹çš„ï¼Œä½†ä½ è¿æ¥çš„ä¸æ˜¯ github.comï¼ˆæ¯”å¦‚èµ°äº†ä»£ç†/æ”¹äº† Host/ç«¯å£ï¼‰ï¼Œæˆ–è€… ssh config æŠŠ <code>User</code>/<code>HostName</code> æåäº†</li>
<li>ä½ åŠ çš„ key åœ¨ GitHub ä¸Šè¢«åˆ¤å®šä¸ºå†²çª/ç¦ç”¨ï¼ˆæ¯”å¦‚å·²è¢«åˆ«çš„è´¦æˆ·ä½¿ç”¨ï¼‰</li>
</ol>
<p>æˆ‘ä»¬ä¸è¦çŒœï¼Œç›´æ¥ç”¨å‘½ä»¤æŠŠçœŸç›¸é’‰æ­»ã€‚</p>
<ol>
<li>å…ˆæŠŠä½ ç°åœ¨è¿æ¥åˆ°å“ªä¸ªä¸»æœºã€ç”¨å“ªä¸ª key è¯´æ¸…æ¥šï¼ˆå¿…åšï¼‰</li>
</ol>
<p>è·‘è¿™ä¸ªï¼ˆä¼šè¾“å‡ºä½ åˆ°åº•ç»™ GitHub æäº¤äº†å“ªä¸ªå…¬é’¥ã€ä»¥åŠ GitHub æ˜¯å¦æ¥å—ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ æŠŠè¾“å‡ºé‡Œä»ä¸‹é¢è¿™ä¸¤è¡Œé™„è¿‘æˆªå‡ºæ¥å°±å¤Ÿï¼ˆä¸ç”¨æ•´ç¯‡ï¼‰ï¼š</p>
<ul>
<li><code>Offering public key: ...</code></li>
<li><code>Server accepts key: ...</code>ï¼ˆå¦‚æœæœ‰ï¼‰</li>
<li>æœ€å <code>Permission denied</code> é‚£å‡ è¡Œ</li>
</ul>
<blockquote>
<p>æ³¨ï¼š<code>-vv</code> æ˜¯è¯¦ç»†æ—¥å¿—ï¼ˆæ²¡ <code>-vvv</code> é‚£ä¹ˆé•¿ï¼‰ï¼Œè¶³å¤Ÿå®šä½ã€‚</p>
</blockquote>
<ol start="2">
<li>åŒæ—¶è´´ä¸€ä¸‹ä½ çš„ <code>~/.ssh/config</code>ï¼ˆè¿™é‡Œå¾ˆå¯èƒ½æœ‰å‘ï¼‰</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">sed</span><span style="color:#79B8FF"> -n</span><span style="color:#9ECBFF"> '1,200p'</span><span style="color:#9ECBFF"> ~/.ssh/config</span><span style="color:#6A737D">   # æ³¨ï¼šæ‰“å° ssh é…ç½®æ–‡ä»¶å‰ 200 è¡Œ</span></span></code></pre>
<p>é‡ç‚¹æˆ‘æƒ³çœ‹ä½ æ˜¯å¦å†™äº†ç±»ä¼¼ï¼š</p>
<ul>
<li><code>IdentityAgent ~/.gnupg/...</code>ï¼ˆå¯¹ï¼‰</li>
<li><code>IdentityFile none</code>ï¼ˆå¯ä»¥ï¼‰</li>
<li><strong>ä½†æœ‰æ²¡æœ‰æŠŠ <code>HostName</code> æ”¹æˆåˆ«çš„ã€ç«¯å£ä¸æ˜¯ 22ã€æˆ–è€… Host åŒ¹é…å†™æ­ª</strong>ï¼ˆå¸¸è§ç¿»è½¦ç‚¹ï¼‰</li>
</ul>
<ol start="3">
<li>ç«‹åˆ»åšä¸€ä¸ªâ€œå¼ºåˆ¶åªç”¨è¿™ä¸€æŠŠ keyâ€çš„å•æ¬¡æµ‹è¯•ï¼ˆæ’é™¤ config å¹²æ‰°ï¼‰</li>
</ol>
<p>ä½ ç°åœ¨ <code>ssh-add -L</code> é‡Œåªæœ‰è¿™ä¸€æŠŠ <code>(none)</code>ï¼Œå¾ˆå¥½ã€‚</p>
<p>å†è·‘è¿™æ¡â€œå®Œå…¨ä¸çœ‹ configâ€çš„å‘½ä»¤ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#E1E4E8">SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -o</span><span style="color:#9ECBFF"> IdentitiesOnly=yes</span><span style="color:#79B8FF"> -o</span><span style="color:#9ECBFF"> IdentityAgent=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">) </span><span style="color:#79B8FF">-T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p><strong>æ³¨è§£</strong>ï¼š</p>
<ul>
<li><code>-o IdentitiesOnly=yes</code>ï¼šåªç”¨ agent æä¾›çš„ key</li>
<li><code>-o IdentityAgent=...</code>ï¼šæ˜ç¡®æŒ‡å®š gpg-agent socket</li>
<li>è¿™æ¡å‘½ä»¤èƒ½æŠŠâ€œæ˜¯ä¸æ˜¯ config é—®é¢˜â€ä¸€åˆ€åˆ‡æ‰</li>
</ul>
<ol start="4">
<li>æˆ‘æœ€æ€€ç–‘çš„ä¸¤ä¸ªç‚¹ï¼ˆå…ˆç»™ä½ æˆ‘çš„åˆ¤æ–­ï¼‰</li>
</ol>
<h3 id="a-ä½ åŠ é”™ä½ç½®åŠ åˆ°-gpg-keys--deploy-key">A) ä½ åŠ é”™ä½ç½®ï¼ˆåŠ åˆ° GPG keys / deploy keyï¼‰</h3>
<p>ä½ å¿…é¡»åŠ åœ¨ï¼š<br>
<strong>Settings â†’ SSH and GPG keys â†’ SSH keys â†’ New SSH key</strong><br>
ä¸æ˜¯ä¸‹é¢é‚£å— <strong>GPG keys</strong>ã€‚</p>
<blockquote>
<p>ä½ å¯ä»¥ç”¨ä¸€ä¸ªâ€œè‡ªæµ‹â€ï¼š<br>
å¦‚æœä½ åœ¨ GitHub é¡µé¢çœ‹åˆ°çš„æ˜¯ä¸€å¨ä»¥ <code>ssh-ed25519</code> å¼€å¤´çš„ keyï¼Œé‚£æ‰æ˜¯ SSH keyã€‚<br>
GPG key é‚£è¾¹ä¼šæ˜¾ç¤ºä¸€æ®µ PGP blockï¼ˆ<code>-----BEGIN PGP PUBLIC KEY BLOCK-----</code>ï¼‰ã€‚</p>
</blockquote>
<h3 id="b-ä½ åŠ åˆ°äº†å¦ä¸€ä¸ªè´¦å·">B) ä½ åŠ åˆ°äº†å¦ä¸€ä¸ªè´¦å·</h3>
<p>ä½ å‘½ä»¤è¿”å›é‡Œå†™çš„æ˜¯ <code>git@github.com</code>ï¼ŒæˆåŠŸæ—¶ä¼šæ˜¾ç¤ºï¼š<br>
<code>Hi &#x3C;username>! ...</code><br>
ä½ ä¹‹å‰æˆåŠŸæ—¶æ˜¾ç¤º <strong>LosFurina</strong>ï¼Œè¯´æ˜ä½ ç°åœ¨ç¡®å®åœ¨ç”¨è¿™ä¸ªè´¦å·è¿æ¥ã€‚</p>
<p>ä½†ä½ â€œæ·»åŠ  keyâ€çš„æ—¶å€™ï¼Œæœ€å¸¸è§æ˜¯æµè§ˆå™¨é‡Œç™»ç€å¦ä¸€ä¸ª GitHub è´¦å·/ç»„ç»‡è´¦å·ï¼Œç‚¹ä¿å­˜ä¹ŸæˆåŠŸäº†ï¼Œä½†ä¸æ˜¯è¿™ä¸ªè´¦å·çš„ keysã€‚</p>
<ol start="5">
<li>å¿«é€Ÿæ’é›·ï¼šä½ è¿™æŠŠ key åœ¨ GitHub ä¸Šæœ‰æ²¡æœ‰è¢«æ‹’ç»ï¼ˆå†²çªï¼‰</li>
</ol>
<p>GitHub çš„ SSH key <strong>ä¸èƒ½åŒæ—¶è¢«å¤šä¸ªè´¦æˆ·ä½¿ç”¨</strong>ï¼ˆé€šå¸¸ä¼šæç¤ºï¼Œä½†ä½ å¯èƒ½æ²¡æ³¨æ„ï¼‰ã€‚</p>
<p>ä½ å¯ä»¥åœ¨ GitHub çš„ SSH keys åˆ—è¡¨é‡Œç‚¹å¼€çœ‹ï¼š</p>
<ul>
<li>æœ‰æ²¡æœ‰æ˜¾ç¤º â€œAdded on â€¦â€</li>
<li>æœ‰æ²¡æœ‰è¢«æ ‡è®°ä¸º disabled</li>
<li>title æ˜¯å¦æ˜¯ä½ åˆšåˆšå¡«çš„</li>
</ul>
<p>ä½ ç°åœ¨ç…§æˆ‘åšï¼šå‘æˆ‘ 2 ä¸ªè¾“å‡ºæˆ‘å°±èƒ½ç»™ä½ â€œç¡®å®šç­”æ¡ˆâ€</p>
<ol>
<li>è¿™ä¸ªï¼ˆçŸ­ä¸€ç‚¹çš„ vvï¼‰ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<ol start="2">
<li>è¿™ä¸ªï¼ˆssh configï¼‰ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">sed</span><span style="color:#79B8FF"> -n</span><span style="color:#9ECBFF"> '1,200p'</span><span style="color:#9ECBFF"> ~/.ssh/config</span></span></code></pre>
<p>æˆ‘çœ‹å®Œä¼šç›´æ¥å‘Šè¯‰ä½ ï¼š</p>
<ul>
<li>GitHub æ˜¯å¦ <strong>accept key</strong>ï¼ˆæ—¥å¿—é‡Œä¼šå†™ï¼‰</li>
<li>å¦‚æœæ²¡ acceptï¼šæ˜¯ <strong>key æ²¡ä¸Šä¼ å¯¹è´¦å·/å¯¹ä½ç½®</strong></li>
<li>å¦‚æœ accept äº†è¿˜å¤±è´¥ï¼šé‚£å°±æ˜¯ <code>User</code>/<code>Host</code>/<code>principals</code> é…ç½®é—®é¢˜ï¼ˆä½† GitHub åŸºæœ¬ä¸ä¼šï¼‰</li>
</ul>
<p>ä½ è¿™ä¸æ˜¯ç„å­¦ï¼Œlog ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªâ€œç¡¬è¯æ®â€ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-5-ssh--vv--t-gitgithubcom--255--sy">æ’æŸ¥åœºæ™¯ 5. ssh -vv -T <a href="mailto:git@github.com">git@github.com</a> âœ˜ 255 î˜— syâ€¦</h3>
<ul>
<li>åœºæ™¯ï¼šssh -vv -T <a href="mailto:git@github.com">git@github.com</a> âœ˜ 255 î˜— syâ€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
æŠ“åˆ°çœŸå‡¶äº†ï¼š<strong>ä¸æ˜¯ GitHub ä¸è®¤ key</strong>ï¼Œè€Œæ˜¯ä½  <code>.ssh/config</code> é‡Œè¿™å¥æŠŠè‡ªå·±å‘æ­»äº†ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>IdentityAgent ~/.gnupg/S.gpg-agent.ssh</span></span></code></pre>
<p>æ—¥å¿—å·²ç»æ˜è¯´äº†ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>get_agent_identities: ssh_get_authentication_socket: No such file or directory</span></span></code></pre>
<p>ä¹Ÿå°±æ˜¯ï¼š<strong>ssh å»æ‰¾è¿™ä¸ª socket æ–‡ä»¶ï¼Œæ‰¾ä¸åˆ°</strong>ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡æ‹¿åˆ° gpg-agent çš„ keyï¼Œè‡ªç„¶åªèƒ½ Permission deniedã€‚</p>
<p>ä½ ä¹‹å‰ä¹‹æ‰€ä»¥ <code>ssh-add -L</code> èƒ½çœ‹åˆ° keyï¼Œæ˜¯å› ä¸ºä½ ç¯å¢ƒå˜é‡ <code>SSH_AUTH_SOCK</code> æŒ‡å‘äº†æ­£ç¡®çš„ socketï¼ˆ<code>/run/user/1000/...</code>ï¼‰ã€‚<br>
ä½† <code>IdentityAgent ~/.gnupg/...</code> è¿™æ˜¯<strong>å¦ä¸€æ¡è·¯</strong>ï¼Œè€Œä½ è¿™ä¸ªè·¯å¾„åœ¨ä½ çš„æœºå™¨ä¸Šå¹¶ä¸å­˜åœ¨ï¼ˆæˆ–ä¸æ˜¯é‚£ä¸ª socketï¼‰ã€‚</p>
<p>ç«‹åˆ»ä¿®å¤ï¼ˆä¸¤ç§æ–¹å¼ï¼Œé€‰æˆ‘æ¨èçš„ï¼‰</p>
<p>æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼šè®© IdentityAgent æŒ‡å‘â€œçœŸå®è·¯å¾„â€</p>
<p>ç”¨ gpgconf æŠŠçœŸå®è·¯å¾„æ‰“å°å‡ºæ¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#6A737D">   # æ³¨ï¼šè¾“å‡º gpg-agent çš„ SSH socket çœŸè·¯å¾„</span></span></code></pre>
<p>ä½ ä¼šå¾—åˆ°ç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>/run/user/1000/gnupg/S.gpg-agent.ssh</span></span></code></pre>
<p>ç„¶åæŠŠ <code>~/.ssh/config</code> é‡Œ github.com é‚£æ®µæ”¹æˆï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent /run/user/1000/gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<p>ï¼ˆæ³¨æ„ï¼šè¿™é‡Œå¿…é¡»æ˜¯<strong>ç»å¯¹è·¯å¾„</strong>ï¼Œåˆ«ç”¨ <code>~</code>ï¼‰</p>
<p>ä¿å­˜åç›´æ¥æµ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>æ–¹æ¡ˆ Bï¼ˆæ›´çœå¿ƒï¼‰ï¼šå¹²è„†åˆ«å†™ IdentityAgentï¼Œåªé  SSH_AUTH_SOCK</p>
<p>ä½ å·²ç»åœ¨ <code>.zshrc.local</code> é‡Œæœ‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>é‚£ ssh é»˜è®¤ä¼šç”¨è¿™ä¸ª agentã€‚<br>
ä½ å¯ä»¥æŠŠ github.com é‚£æ®µæ”¹æˆï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<p>ç„¶åæµ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>æˆ‘ä¸ªäººæ›´å–œæ¬¢ <strong>æ–¹æ¡ˆ A</strong>ï¼šé…ç½®æ›´â€œè‡ªæ´½â€ï¼Œå°±ç®—ä½ ä»åˆ«çš„ shell/æœåŠ¡é‡Œè·‘ sshï¼Œå®ƒä¹Ÿä¸ä¾èµ–ç¯å¢ƒå˜é‡ã€‚</p>
<p>ä½ ç°åœ¨ä¸ºä»€ä¹ˆä¼šå‡ºç° â€œ~/.gnupg/S.gpg-agent.ssh ä¸å­˜åœ¨â€ã€‚</p>
<p>å¾ˆæ­£å¸¸ï¼šä¸åŒå‘è¡Œç‰ˆ/é…ç½®ä¸‹ï¼Œgpg-agent çš„ socket ä½ç½®ä¸ä¸€æ ·ã€‚<br>
Arch é€šå¸¸åœ¨ï¼š</p>
<ul>
<li><code>/run/user/&#x3C;uid>/gnupg/S.gpg-agent.ssh</code></li>
</ul>
<p>è€Œä¸æ˜¯ <code>~/.gnupg/...</code>ã€‚</p>
<p>ä½ å¯ä»¥éªŒè¯ä¸€ä¸‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ls</span><span style="color:#79B8FF"> -l</span><span style="color:#9ECBFF"> /run/user/</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">id</span><span style="color:#79B8FF"> -u</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">/gnupg/</span><span style="color:#6A737D">   # æ³¨ï¼šåˆ—å‡ºå½“å‰ç”¨æˆ·çš„ runtime ç›®å½•ä¸‹çš„ gnupg sockets</span></span></code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ° <code>S.gpg-agent.ssh</code>ã€‚</p>
<p>ä¿®å®Œåå†å›åˆ°ä½ åˆšæ‰é‚£ä¸ªâ€œæˆ‘ç¡®å®šåœ¨ GitHub æ·»åŠ äº†â€çš„ç‚¹</p>
<p>ç­‰ä½ ä¿®å¥½ socket è·¯å¾„åï¼š</p>
<ul>
<li>å¦‚æœ GitHub <strong>ç¡®å®åŠ äº†</strong>è¿™æŠŠæ–° key<br>
ä¼šç›´æ¥æˆåŠŸï¼Œè¾“å‡º <code>Hi LosFurina! ...</code></li>
<li>å¦‚æœä½ åŠ é”™è´¦å·/åŠ é”™ä½ç½®<br>
è¿™æ¬¡ä¼šçœ‹åˆ° <code>Offering public key ...</code> ä½†è¢«æ‹’ç»ï¼ˆæˆ‘ä»¬å†æŸ¥ GitHub ä¾§ï¼‰</li>
</ul>
<p>ä½ ç°åœ¨å°±åš 2 æ¡å‘½ä»¤ï¼Œç«‹åˆ»è§åˆ†æ™“</p>
<ol>
<li>æ‹¿åˆ°çœŸå® socketï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span></span></code></pre>
<ol start="2">
<li>æ”¹å®Œ config åæµ‹è¯•ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ æŠŠç¬¬ 1 æ¡å‘½ä»¤çš„è¾“å‡ºè´´æˆ‘ï¼ˆå°±ä¸€è¡Œè·¯å¾„ï¼‰ï¼Œæˆ‘å¯ä»¥ç›´æ¥å‘Šè¯‰ä½  <code>~/.ssh/config</code> è¯¥å†™æˆå“ªä¸€è¡Œï¼Œä¿è¯ä¸€æ¬¡è¿‡ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-6-ssh--t-gitgithubcom-5s--system-01">æ’æŸ¥åœºæ™¯ 6. ssh -T <a href="mailto:git@github.com">git@github.com</a> 5s î˜— system 01â€¦</h3>
<ul>
<li>åœºæ™¯ï¼šssh -T <a href="mailto:git@github.com">git@github.com</a> 5s î˜— system 01â€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
ç°åœ¨è¿™ä¸ªç»“æœ<strong>å®Œå…¨ç¬¦åˆä½ ç°åœ¨çš„ ssh é…ç½®</strong>ï¼šä½ æŠŠ GitHub è¿™æ®µå†™æˆäº†</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>IdentitiesOnly yes</span></span>
<span class="line"><span>IdentityFile none</span></span></code></pre>
<p>è¿™ä¸¤å¥åˆåœ¨ä¸€èµ·çš„æ•ˆæœæ˜¯ï¼š</p>
<blockquote>
<p><strong>â€œå¯¹ github.comï¼šåˆ«ç”¨ä»»ä½•ç£ç›˜ä¸Šçš„ç§é’¥ï¼›ä¹Ÿåˆ«è‡ªåŠ¨æœå…¶ä»–èº«ä»½ã€‚â€</strong></p>
</blockquote>
<p>è€Œä½ åˆ <strong>æ²¡æœ‰åœ¨è¿™æ®µé‡ŒæŒ‡å®š IdentityAgent</strong>ï¼Œæ‰€ä»¥ ssh è¿™æ¬¡å¾ˆå¯èƒ½æ ¹æœ¬æ²¡ç”¨åˆ° gpg-agentï¼ˆæˆ–è€…æ‹¿ä¸åˆ°ä»»ä½•èº«ä»½ï¼‰â†’ ç›´æ¥ <code>Permission denied</code>ã€‚</p>
<p>ä½ åˆšæ‰é‚£ä»½ <code>-vv</code> æ—¥å¿—é‡Œå·²ç»è¯æ˜è¿‡ï¼šå¦‚æœ agent æ²¡è¿ä¸Šï¼Œä¼šå‡ºç°<br>
<code>ssh_get_authentication_socket: No such file or directory</code>ã€‚<br>
ç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯ï¼š<strong>æ˜ç¡®å‘Šè¯‰ sshï¼šGitHub åªç”¨ gpg-agent çš„é‚£ä¸ª socket</strong>ï¼Œè€Œä¸”è¦ç”¨â€œçœŸå®è·¯å¾„â€ã€‚</p>
<ol>
<li>å…ˆæ‹¿åˆ°çœŸå®çš„ gpg-agent SSH socket è·¯å¾„ï¼ˆå¿…é¡»åšï¼‰</li>
</ol>
<p>è·‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#6A737D">    # æ³¨ï¼šè¾“å‡º gpg-agent æä¾›ç»™ SSH çš„ socket çœŸè·¯å¾„</span></span></code></pre>
<p>å®ƒä¼šè¾“å‡ºä¸€è¡Œï¼Œå…¸å‹æ˜¯ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>/run/user/1000/gnupg/S.gpg-agent.ssh</span></span></code></pre>
<ol start="2">
<li>æŠŠè¿™ä¸ªè·¯å¾„å†™è¿› ~/.ssh/configï¼ˆåˆ«ç”¨ ~ï¼Œç”¨ç»å¯¹è·¯å¾„ï¼‰</li>
</ol>
<p>ç¼–è¾‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.ssh/config</span><span style="color:#6A737D">   # æ³¨ï¼šSSH å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</span></span></code></pre>
<p>æŠŠ GitHub æ®µæ”¹æˆè¿™æ ·ï¼ˆæŠŠè·¯å¾„æ›¿æ¢æˆä½ ç¬¬ 1 æ­¥è¾“å‡ºçš„é‚£ä¸€è¡Œï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent /run/user/1000/gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<p>ï¸ å…³é”®ç‚¹ï¼š</p>
<ul>
<li><code>IdentityAgent</code> å¿…é¡»æ˜¯<strong>ç»å¯¹è·¯å¾„</strong></li>
<li><code>IdentityFile none</code> ä¿ç•™æ²¡é—®é¢˜ï¼ˆè¿™æ ·å®ƒä¸ä¼šå†å·ç”¨ ~/.ssh/id_ed25519ï¼‰</li>
</ul>
<p>ä¿å­˜é€€å‡ºã€‚</p>
<ol start="3">
<li>éªŒæ”¶ï¼ˆä¸¤æ¡å‘½ä»¤ï¼‰</li>
</ol>
<p>å…ˆçœ‹ ssh åˆ°åº•èƒ½ä¸èƒ½æ‹¿åˆ° agent èº«ä»½ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼ï¼š</p>
<ul>
<li><code>get_agent_identities: agent returned 1 keys</code></li>
<li><code>Offering public key: (none) ED25519 ... agent</code></li>
</ul>
<p>å¦‚æœä½ çœ‹åˆ°è¿™å¥ï¼Œå°±è¯´æ˜<strong>ssh ç¡®å®åœ¨ç”¨ gpg-agent</strong>äº†ã€‚</p>
<p>ç„¶åæ­£å¸¸æµ‹è¯•ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>å¦‚æœç¬¬ 3 æ­¥é‡Œ â€œOffering public key â€¦ agentâ€ å‡ºæ¥äº†ä½†ä»ç„¶ Permission denied</p>
<p>é‚£å°±ä¸æ˜¯æœ¬åœ°é…ç½®é—®é¢˜äº†ï¼Œè€Œæ˜¯ <strong>GitHub ä¾§ç¡®å®æ²¡æŠŠè¿™æŠŠå…¬é’¥ç»‘åˆ°è¿™ä¸ªè´¦å·</strong>ï¼ˆæˆ–è€…ä½ åŠ åˆ°äº†å¦ä¸€ä¸ªè´¦å·/ä½ç½®ï¼‰ã€‚<br>
è¿™æ—¶å€™æˆ‘ä»¬å°±ä¸ç”¨çŒœäº†ï¼šçœ‹ <code>-vv</code> é‡Œæœ‰æ²¡æœ‰ <code>Server accepts key</code>ã€‚</p>
<ul>
<li>æœ‰ <code>Server accepts key</code> ä½†å¤±è´¥ï¼šæå°‘è§ï¼ˆé€šå¸¸ç­¾åè¢«æ‹’ï¼‰</li>
<li><strong>æ²¡æœ‰ <code>Server accepts key</code></strong>ï¼šGitHub ä¸è®¤è¯†è¿™æŠŠ keyï¼ˆ= è´¦å·æ²¡åŠ å¯¹ï¼‰</li>
</ul>
<p>ä½ ç°åœ¨ä¸‹ä¸€æ­¥æœ€çœäº‹çš„åšæ³•</p>
<p>ç›´æ¥æŠŠè¿™ä¸¤æ¡çš„è¾“å‡ºè´´æˆ‘ï¼ˆéƒ½å¾ˆçŸ­ï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>æˆ‘çœ‹å®Œå°±èƒ½ç»™ä½ ä¸€å¥æ˜ç¡®åˆ¤æ–­ï¼š<br>
æ˜¯ <strong>IdentityAgent è·¯å¾„æ²¡é…å¯¹</strong>ï¼Œè¿˜æ˜¯ <strong>GitHub ç¡®å®æ²¡ç™»è®°è¿™æŠŠ key</strong>ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-7-cat-sshconfig--255--system-01">æ’æŸ¥åœºæ™¯ 7. cat ~/.ssh/config âœ˜ 255 î˜— system 01:â€¦</h3>
<ul>
<li>åœºæ™¯ï¼šcat ~/.ssh/config âœ˜ 255 î˜— system 01:â€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
OKï¼Œç°åœ¨ä½ çš„æœ¬åœ°â€œæ¥çº¿â€å·²ç»æ¥å¯¹äº†ï¼š<code>IdentityAgent /run/user/1000/gnupg/S.gpg-agent.ssh</code><br>
ä½†ä¾ç„¶ <code>Permission denied (publickey)</code>ï¼Œè¿™æ—¶å€™æˆ‘å°±ä¸è·Ÿä½ çº ç»“æœ¬åœ°äº†â€”â€”<strong>å¤§æ¦‚ç‡æ˜¯ GitHub ç«¯æ ¹æœ¬æ²¡æ¥å—è¿™æŠŠ key</strong>ï¼ˆä¹Ÿå°±æ˜¯ï¼šæ²¡ç»‘å¯¹è´¦å·/ç»‘é”™ä½ç½®/ç²˜è´´å†…å®¹å˜å½¢ï¼‰ã€‚</li>
</ul>
<p>æˆ‘ä»¬ç”¨<strong>ä¸€æ¡æ—¥å¿—å‘½ä»¤</strong>ç›´æ¥è®© GitHub ç»™å‡ºâ€œæœ‰æ²¡æœ‰æ¥å— keyâ€çš„ç¡¬è¯æ®ã€‚</p>
<ol>
<li>ç«‹åˆ»è·‘ï¼šçœ‹ GitHub æœ‰æ²¡æœ‰ â€œaccept keyâ€</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ ä¸ç”¨è´´å…¨ç¯‡ï¼ˆå¤ªé•¿ï¼‰ï¼Œåªè¦æŠŠåŒ…å«ä¸‹é¢å…³é”®è¯çš„é‚£ä¸€æ®µè´´å‡ºæ¥å°±è¡Œï¼š</p>
<ul>
<li><code>get_agent_identities: agent returned</code></li>
<li><code>Offering public key:</code></li>
<li><strong>æœ‰æ²¡æœ‰</strong> <code>Server accepts key:</code>ï¼ˆè¿™ä¸€å¥æœ€å…³é”®ï¼‰</li>
<li>æœ€åçš„ <code>Permission denied</code></li>
</ul>
<h3 id="ä½ ä¼šé‡åˆ°ä¸¤ç§ç»“æœ">ä½ ä¼šé‡åˆ°ä¸¤ç§ç»“æœï¼š</h3>
<p>æƒ…å†µ Aï¼šæ—¥å¿—é‡Œå‡ºç°äº† <code>Server accepts key</code></p>
<p>é‚£è¯´æ˜ï¼šGitHub å…¶å®è®¤è¯†ä½ çš„å…¬é’¥ï¼Œä½†åé¢ç­¾å/è®¤è¯è¿‡ç¨‹å¤±è´¥ï¼ˆå°‘è§ï¼Œä½†æœ‰è§£ï¼‰</p>
<p>æƒ…å†µ Bï¼šå®Œå…¨æ²¡æœ‰ <code>Server accepts key</code></p>
<p>é‚£å°±è¯´æ˜ï¼šGitHub æ²¡è®¤è¿™æŠŠ keyâ€”â€”<strong>ä½ â€œä»¥ä¸ºåŠ äº†â€ï¼Œä½†åŠ çš„ä¸æ˜¯è¿™æŠŠ / ä¸æ˜¯è¿™ä¸ªè´¦å· / ä¸æ˜¯ SSH keys é‚£æ </strong>ï¼ˆæœ€å¸¸è§ï¼‰</p>
<ol start="2">
<li>ä½ ç°åœ¨å¯ä»¥åŒæ—¶åšä¸€ä¸ªâ€œç»å¯¹ä¸å¯èƒ½åŠ é”™â€çš„æ ¸éªŒï¼šç”¨ key çš„ fingerprint å¯¹ç…§ GitHub é¡µé¢</li>
</ol>
<p>æœ¬åœ°ç®—ä¸€ä¸‹ä½ è¿™æŠŠ SSH å…¬é’¥çš„æŒ‡çº¹ï¼ˆGitHub é¡µé¢æ˜¾ç¤ºçš„å°±æ˜¯è¿™ä¸ªï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> ssh-keygen</span><span style="color:#79B8FF"> -lf</span><span style="color:#9ECBFF"> -</span><span style="color:#6A737D">    # æ³¨ï¼šä»å…¬é’¥æ–‡æœ¬è®¡ç®— fingerprintï¼ˆä¸è½ç›˜ï¼‰</span></span></code></pre>
<p>è¾“å‡ºç±»ä¼¼ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>256 SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx (ED25519)</span></span></code></pre>
<p>ç„¶åå» GitHub â†’ Settings â†’ SSH and GPG keys â†’ SSH keys<br>
çœ‹ä½ æ–°å¢é‚£æ¡ key çš„ fingerprint æ˜¯å¦ä¸€è‡´ã€‚</p>
<ul>
<li>ä¸€è‡´ï¼šé‚£ GitHub ç†è®ºä¸Šå°±åº”è¯¥ acceptï¼ˆé™¤éä½ è¿çš„ä¸æ˜¯åŒä¸€è´¦å·ï¼‰</li>
<li>ä¸ä¸€è‡´ï¼šä½ åŠ é”™ key äº†ï¼ˆæ¯”å¦‚åŠ äº†ä½ æ—§çš„ <code>~/.ssh/id_ed25519</code> æˆ–å‰ªè´´æ¿æ··äº†ï¼‰</li>
</ul>
<ol start="3">
<li>è¿˜æœ‰ä¸€ä¸ªéå¸¸å¸¸è§çš„â€œä½ æ˜æ˜åŠ äº†ä½†è¿˜æ˜¯ä¸è¡Œâ€å‘ï¼šä½ åŠ åˆ°äº† <strong>Deploy key</strong></li>
</ol>
<p>Deploy key æ˜¯æŒ‚åœ¨æŸä¸ª repo çš„ Settings é‡Œï¼Œä¸æ˜¯è´¦å· Settingsã€‚</p>
<p>ä½ ç¡®è®¤ä¸‹ä½ åŠ  key çš„ä½ç½®æ˜¯ä¸æ˜¯ï¼š</p>
<ul>
<li><strong>å³ä¸Šè§’å¤´åƒ â†’ Settings â†’ SSH and GPG keys â†’ SSH keys</strong><br>
è€Œä¸æ˜¯ï¼š</li>
<li>æŸä¸ª repo â†’ Settings â†’ Deploy keys</li>
</ul>
<ol start="4">
<li>ä¹Ÿå¯èƒ½æ˜¯ä½ è¿çš„è´¦å·ä¸æ˜¯ä½ ç½‘é¡µç™»é™†çš„é‚£ä¸ª</li>
</ol>
<p>ä½ ä¹‹å‰æˆåŠŸæ—¶æ˜¾ç¤º <code>Hi LosFurina!</code>ï¼Œè¯´æ˜è¿™æ˜¯ä½ è¦çš„è´¦å·ã€‚<br>
ä½†ç°åœ¨å¤±è´¥ï¼Œæˆ‘ä»¬ç”¨ä¸€æ‹›éªŒè¯ï¼š<strong>åªè¦ GitHub accept äº† keyï¼ŒæˆåŠŸæ—¶ä¸€å®šä¼šå›ç”¨æˆ·å</strong>ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨å…³é”®å°±æ˜¯ç¬¬ 1 æ­¥ï¼šçœ‹ <code>Server accepts key</code>ã€‚</p>
<p>ä½ ä¸‹ä¸€æ­¥å‘æˆ‘ä¸¤æ¡è¾“å‡ºï¼Œæˆ‘å°±èƒ½ä¸€é”¤å®šéŸ³</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ï¼ˆæˆªå–åŒ…å« <code>Offering public key</code> å’Œ <code>Server accepts key</code> çš„é‚£æ®µï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> ssh-keygen</span><span style="color:#79B8FF"> -lf</span><span style="color:#9ECBFF"> -</span></span></code></pre>
<p>æˆ‘çœ‹å®Œä¼šç›´æ¥å‘Šè¯‰ä½ ï¼š</p>
<ul>
<li>æ˜¯ GitHub æ²¡ç»‘å¯¹ keyï¼ˆæœ€å¸¸è§ï¼‰</li>
<li>è¿˜æ˜¯ GitHub æ¥å—äº†ä½† gpg-agent ç­¾åè¢«æ‹’ï¼ˆå°‘è§ï¼‰</li>
<li>æˆ–è€…ä½ å…¶å®åœ¨ç½‘é¡µä¸ŠåŠ çš„æ˜¯å¦ä¸€æŠŠ keyï¼ˆfingerprint ä¸ä¸€è‡´ï¼‰</li>
</ul>
<h3 id="æ’æŸ¥åœºæ™¯-8-ssh--vv--t-gitgithubcom--255--sy">æ’æŸ¥åœºæ™¯ 8. ssh -vv -T <a href="mailto:git@github.com">git@github.com</a> âœ˜ 255 î˜— syâ€¦</h3>
<ul>
<li>åœºæ™¯ï¼šssh -vv -T <a href="mailto:git@github.com">git@github.com</a> âœ˜ 255 î˜— syâ€¦</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
è¿™æ—¥å¿—å·²ç»æŠŠé—®é¢˜é’‰æ­»äº†ï¼Œè€Œä¸”ä¸æ˜¯ä½ â€œåŠ æ²¡åŠ åˆ° GitHubâ€çš„ç„å­¦ï¼š</li>
</ul>
<blockquote>
<p><strong>SSH ç¡®å®è¿ä¸Šäº† gpg-agentï¼Œå¹¶ä¸” agent ä¹Ÿç¡®å®è¿”å›äº† 1 æŠŠ keyï¼›<br>
ä½† OpenSSH æ²¡æœ‰å» â€œOffering public key â€¦â€ï¼Œç›´æ¥æŠŠ publickey æ–¹æ³•ç¦ç”¨äº†ã€‚</strong></p>
</blockquote>
<p>çœ‹è¿™ä¸‰è¡Œè¿èµ·æ¥å°±å¾ˆè¯¡å¼‚ä½†å¾ˆå…³é”®ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>get_agent_identities: ssh_agent_bind_hostkey: agent refused operation</span></span>
<span class="line"><span>get_agent_identities: agent returned 1 keys</span></span>
<span class="line"><span>we did not send a packet, disable method</span></span></code></pre>
<p>æ„æ€æ˜¯ï¼šOpenSSH 10.2 åœ¨åšä¸€ä¸ªâ€œç»‘å®šä¸»æœº keyâ€çš„å¢å¼ºæµç¨‹ï¼ˆhost-bound keys / hostbound æ‰©å±•ï¼‰æ—¶ï¼Œè¦æ±‚ agent é…åˆï¼›<strong>gpg-agent æ‹’ç»äº†</strong>ï¼Œç„¶å OpenSSH è¿™è¾¹å¹²è„†è®¤ä¸ºâ€œpublickey è¿™æ¡è·¯ä¸å¯ç”¨â€ï¼Œäºæ˜¯æ ¹æœ¬æ²¡å‘ <code>Offering public key</code> ç»™ GitHubã€‚</p>
<p>æ‰€ä»¥ä½ ç°åœ¨å¡çš„ä¸æ˜¯ GitHubï¼Œè€Œæ˜¯ï¼š<br>
<strong>OpenSSH æ–°ç‰¹æ€§ + gpg-agent SSH ä»¿çœŸä¸å®Œå…¨å…¼å®¹</strong>ã€‚</p>
<p>ï¼Œè¿™ä¸ªæœ‰å¾ˆç¡¬çš„è§£å†³åŠæ³•ï¼š<strong>è®© ssh ä¸èµ° host-bound çš„é‚£å¥—</strong>ï¼Œæˆ–æ¢æˆæ›´å…¼å®¹çš„ agentï¼ˆæ¯”å¦‚ <code>gpg-agent</code> çš„é…ç½®/ç‰ˆæœ¬ç»„åˆï¼‰ã€‚æˆ‘ä»¬å…ˆèµ°æœ€ç›´æ¥çš„â€œå…³é—­ hostboundâ€è·¯å¾„ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ 1ï¼ˆæ¨èï¼‰ï¼šå¯¹ GitHub å…³é—­ hostboundï¼ˆæœ€å°æ”¹åŠ¨ï¼‰</p>
<p>åœ¨ <code>~/.ssh/config</code> çš„ <code>Host github.com</code> æ®µé‡ŒåŠ ä¸€è¡Œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent /run/user/1000/gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span>
<span class="line"><span>  PubkeyAuthentication yes</span></span>
<span class="line"><span>  # å…³é”®ï¼šç¦ç”¨ host-bound keys æ‰©å±•ï¼ˆè®© ssh åˆ«è¦æ±‚ agent bind hostkeyï¼‰</span></span>
<span class="line"><span>  HostboundAuthentication no</span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼š<code>HostboundAuthentication</code> æ˜¯ OpenSSH æ–°å‚æ•°ï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨ host-bound publickeyï¼ˆä½ æ—¥å¿—é‡Œå‡ºç°çš„ <code>publickey-hostbound@openssh.com</code> å°±æ˜¯å®ƒï¼‰ã€‚<br>
ç¦ç”¨åï¼Œssh ä¼šå›åˆ°ä¼ ç»Ÿçš„å…¬é’¥ç­¾åæµç¨‹ï¼Œgpg-agent å°±èƒ½é…åˆäº†ã€‚</p>
</blockquote>
<p>æ”¹å®Œç«‹åˆ»æµ‹ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ åº”è¯¥ä¼šçœ‹åˆ°å‡ºç°å…³é”®è¡Œï¼š</p>
<ul>
<li><code>Offering public key: ... agent</code></li>
<li>ï¼ˆå¦‚æœ GitHub è®¤å¯ï¼‰<code>Server accepts key: ...</code></li>
</ul>
<p>ç„¶åå†ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>è§£å†³æ–¹æ¡ˆ 2ï¼ˆå…œåº•ä¸”æ›´â€œæš´åŠ›â€ï¼‰ï¼šå¼ºåˆ¶ç”¨æ—§çš„ publickey ç®—æ³•è·¯å¾„</p>
<p>å¦‚æœä½ ç³»ç»Ÿçš„ ssh ç‰ˆæœ¬è¿˜ä¸è®¤ <code>HostboundAuthentication</code> è¿™ä¸ªå…³é”®å­—ï¼ˆç†è®ºä¸Š 10.2 åº”è¯¥è®¤ï¼Œä½†æˆ‘ä¸èµŒï¼‰ï¼Œé‚£å°±ç”¨æ›´é€šç”¨çš„ä¸€æ‹›ï¼š<strong>æ˜¾å¼æŒ‡å®šåªç”¨ ssh-ed25519 ä¸”å…³é—­ç›¸å…³æ‰©å±•</strong>ã€‚</p>
<p>åœ¨ <code>Host github.com</code> æ®µé‡ŒåŠ ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>PubkeyAuthentication yes</span></span>
<span class="line"><span>PubkeyAcceptedAlgorithms ssh-ed25519</span></span></code></pre>
<p>ç„¶åæµ‹åŒæ ·çš„å‘½ä»¤ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ 3ï¼ˆä½ å·²ç»çœ‹åˆ°æç¤ºäº†ï¼‰ï¼šå¿½ç•¥é‚£å¥ â€œagent refused operationâ€</p>
<p>æ³¨æ„ï¼šä½ æ—¥å¿—é‡Œè¿™å¥ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh_agent_bind_hostkey: agent refused operation</span></span></code></pre>
<p>æœ¬èº«ä¸ä¸€å®šè‡´å‘½ï¼Œä½†<strong>ä½ è¿™ç‰ˆ OpenSSH æŠŠå®ƒå½“è‡´å‘½äº†</strong>ï¼ˆæ‰ä¼š â€œwe did not send a packetâ€ï¼‰ã€‚<br>
æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç»•å¼€ hostbound çš„ bind è¡Œä¸ºã€‚</p>
<p>ä½ ç°åœ¨ç…§æˆ‘åš 2 æ­¥å°±è¡Œï¼ˆåˆ«åŠ åˆ«çš„ï¼‰</p>
<ol>
<li><code>vim ~/.ssh/config</code>ï¼Œåœ¨ github.com æ®µè¿½åŠ ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>HostboundAuthentication no</span></span></code></pre>
<ol start="2">
<li>éªŒè¯ï¼š</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -vv</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>æŠŠè¾“å‡ºé‡ŒåŒ…å« <code>Offering public key</code> çš„é‚£å‡ è¡Œè´´æˆ‘â€”â€”åªè¦å®ƒå¼€å§‹ â€œOfferingâ€ï¼Œä½ è¿™æ¡é“¾å°±æ´»äº†ã€‚</p>
<p>é¡ºä¾¿è¯´ä¸€å¥æˆ‘ç«™é˜Ÿçš„è§‚ç‚¹</p>
<p>OpenSSH è¿™å¥— hostbound æ˜¯â€œæ›´å®‰å…¨â€ï¼Œä½†å¯¹å„ç§ agentï¼ˆå°¤å…¶ gpg-agent è¿™ç§å…¼å®¹å±‚ï¼‰ç¡®å®å®¹æ˜“è¸©å‘ã€‚<br>
æˆ‘å®æ„¿å¯¹ GitHub å•ç‚¹å…³æ‰ hostboundï¼Œä¹Ÿä¸æƒ³ä½ æ¯å¤©è¢«è¿™ç§â€œæ˜æ˜æœ‰ key ä½† ssh ä¸å‘åŒ…â€çš„é¬¼æ•…äº‹æŠ˜ç£¨ã€‚</p>
<h3 id="æ’æŸ¥åœºæ™¯-9-æˆ‘ç°åœ¨ä¸éœ€è¦gpgå½“sshäº†æŠŠé…ç½®éƒ½åˆ äº†">æ’æŸ¥åœºæ™¯ 9. æˆ‘ç°åœ¨ä¸éœ€è¦gpgå½“sshäº†ï¼ŒæŠŠé…ç½®éƒ½åˆ äº†</h3>
<ul>
<li>åœºæ™¯ï¼šæˆ‘ç°åœ¨ä¸éœ€è¦gpgå½“sshäº†ï¼ŒæŠŠé…ç½®éƒ½åˆ äº†</li>
<li>å¤„ç†è¦ç‚¹ï¼š<br>
ä½ ç°åœ¨ä¸æ˜¯â€œå¤±è´¥äº†â€ï¼Œè€Œæ˜¯è¸©åˆ°äº† <strong>OpenSSH æ–°ç‰¹æ€§ + gpg-agent å…¼å®¹æ€§</strong> çš„å‘ï¼Œ<strong>é€€å‡ºæˆ˜åœºæ˜¯æœ€çœæ—¶é—´çš„é€‰æ‹©</strong>ã€‚<br>
æˆ‘ä»¬ç°åœ¨åšçš„äº‹åªæœ‰ä¸€ä¸ªç›®æ ‡ï¼š</li>
</ul>
<blockquote>
<p><strong>å½»åº•å›åˆ°ã€Œçº¯ OpenSSH + ~/.ssh/id_ed25519ã€çš„å¹²å‡€ä¸–ç•Œ</strong></p>
</blockquote>
<p>æˆ‘å¸®ä½ æŠŠ <strong>æ‰€æœ‰ gpg-ssh ç›¸å…³çš„é’©å­ä¸€åˆ€åˆ‡å¹²å‡€</strong>ï¼Œä¸ç•™åé—ç—‡ã€‚</p>
<p>Step 0ï¼šä½ ç°åœ¨çš„ç†æƒ³çŠ¶æ€ï¼ˆç›®æ ‡ï¼‰</p>
<ul>
<li>SSH <strong>åªç”¨</strong> <code>~/.ssh/id_ed25519</code></li>
<li>gpg <strong>åªç”¨äºç­¾å / åŠ å¯†ï¼ˆcommit / releaseï¼‰</strong></li>
<li>ä¸å†æœ‰ï¼š
<ul>
<li><code>gpg-agent</code> å‚ä¸ SSH</li>
<li><code>IdentityAgent</code></li>
<li><code>sshcontrol</code></li>
<li><code>SSH_AUTH_SOCK</code> æŒ‡å‘ gpg</li>
</ul>
</li>
</ul>
<p>Step 1ï¼šæ¸…ç† <code>~/.ssh/config</code>ï¼ˆæœ€å…³é”®ï¼‰</p>
<p>ä½ ç°åœ¨è¿™é‡Œæœ‰ä¸€æ®µ <strong>å¿…é¡»åˆ æ‰</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityAgent /run/user/1000/gnupg/S.gpg-agent.ssh</span></span>
<span class="line"><span>  IdentitiesOnly yes</span></span>
<span class="line"><span>  IdentityFile none</span></span></code></pre>
<h3 id="æ”¹æˆ-æœ€ç®€å•æœ€ç¨³çš„-github-é…ç½®">æ”¹æˆ <strong>æœ€ç®€å•ã€æœ€ç¨³çš„ GitHub é…ç½®</strong>ï¼š</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Host github.com</span></span>
<span class="line"><span>  HostName github.com</span></span>
<span class="line"><span>  User git</span></span>
<span class="line"><span>  IdentityFile ~/.ssh/id_ed25519</span></span></code></pre>
<p>å¦‚æœä½ æƒ³æ›´æç®€ï¼Œ<strong>è¿™ä¸€æ®µç”šè‡³å¯ä»¥ä¸å†™</strong>ï¼ŒGitHub é»˜è®¤å°±ä¼šç”¨ <code>id_ed25519</code>ã€‚</p>
<p>ä¿å­˜é€€å‡ºã€‚</p>
<p>Step 2ï¼šæ¸…ç† shell é‡Œçš„ gpg-ssh ç¯å¢ƒå˜é‡</p>
<p>ç¼–è¾‘ä½ çš„ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.zshrc.local</span></span></code></pre>
<p><strong>åˆ é™¤æˆ–æ³¨é‡Šæ‰è¿™ä¸¤è¡Œ</strong>ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSH_AUTH_SOCK</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --list-dirs</span><span style="color:#9ECBFF"> agent-ssh-socket</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> GPG_TTY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">tty</span><span style="color:#E1E4E8">)</span></span></code></pre>
<blockquote>
<p>æ³¨è§£ï¼š</p>
<ul>
<li><code>SSH_AUTH_SOCK</code>ï¼šè¿™æ˜¯ gpg ä»‹å…¥ SSH çš„æ ¹æº</li>
<li><code>GPG_TTY</code> åªåœ¨ä½ ç”¨ gpg è¾“å…¥å¯†ç æ—¶æœ‰æ„ä¹‰ï¼Œä¸åˆ ä¹Ÿè¡Œï¼Œä½†ä¸€èµ·åˆ æœ€å¹²å‡€</li>
</ul>
</blockquote>
<p>é‡æ–°åŠ è½½ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#79B8FF">source</span><span style="color:#9ECBFF"> ~/.zshrc.local</span></span></code></pre>
<p>Step 3ï¼šæ¸…ç† gpg-agent çš„ SSH æ”¯æŒ</p>
<p>ç¼–è¾‘ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">vim</span><span style="color:#9ECBFF"> ~/.gnupg/gpg-agent.conf</span></span></code></pre>
<p>æŠŠ <strong>æ‰€æœ‰è·Ÿ SSH æœ‰å…³çš„åˆ æ‰</strong>ï¼Œæ¯”å¦‚ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>enable-ssh-support</span></span>
<span class="line"><span>allow-loopback-pinentry</span></span></code></pre>
<p>æœ€åä½ è¿™ä¸ªæ–‡ä»¶<strong>å¯ä»¥åªå‰©</strong>ï¼ˆç”šè‡³ä¸ºç©ºéƒ½è¡Œï¼‰ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>pinentry-program /usr/bin/pinentry-qt</span></span>
<span class="line"><span>default-cache-ttl 600</span></span>
<span class="line"><span>max-cache-ttl 7200</span></span></code></pre>
<p>ç„¶åé‡å¯ agentï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">gpgconf</span><span style="color:#79B8FF"> --kill</span><span style="color:#9ECBFF"> gpg-agent</span></span></code></pre>
<p>Step 4ï¼šåˆ é™¤ gpg çš„ SSH key æš´éœ²æ–‡ä»¶ï¼ˆå½»åº•æ–­æ ¹ï¼‰</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">rm</span><span style="color:#79B8FF"> -f</span><span style="color:#9ECBFF"> ~/.gnupg/sshcontrol</span></span></code></pre>
<blockquote>
<p>æ³¨è§£ï¼š<br>
è¿™ä¸ªæ–‡ä»¶å°±æ˜¯â€œå“ªäº› gpg key å¯ä»¥å½“ SSH key ç”¨â€çš„ç™½åå•<br>
åˆ æ‰ = gpg æ°¸è¿œä¸ä¼šå†ç»™ SSH æä¾› key</p>
</blockquote>
<p>Step 5ï¼šéªŒè¯ä½ å·²ç»å›åˆ°çº¯ SSH ä¸–ç•Œï¼ˆéªŒæ”¶ï¼‰</p>
<h3 id="1ï¸âƒ£-çœ‹-ssh-ç°åœ¨ç”¨çš„-key">1ï¸âƒ£ çœ‹ SSH ç°åœ¨ç”¨çš„ keyï¼š</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh-add</span><span style="color:#79B8FF"> -L</span></span></code></pre>
<ul>
<li>å¦‚æœä½  <strong>æ²¡ç”¨ ssh-agent</strong>ï¼Œå¯èƒ½æ˜¾ç¤ºç©ºï¼Œè¿™æ˜¯æ­£å¸¸çš„</li>
<li>SSH ä¼šç›´æ¥è¯» <code>~/.ssh/id_ed25519</code></li>
</ul>
<h3 id="2ï¸âƒ£-ç›´æ¥æµ‹è¯•-github">2ï¸âƒ£ ç›´æ¥æµ‹è¯• GitHubï¼š</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">ssh</span><span style="color:#79B8FF"> -T</span><span style="color:#9ECBFF"> git@github.com</span></span></code></pre>
<p>ä½ åº”è¯¥ç«‹åˆ»çœ‹åˆ°ç†Ÿæ‚‰çš„ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>Hi LosFurina! You've successfully authenticated, but GitHub does not provide shell access.</span></span></code></pre>
<p>Step 6ï¼šæ¸…ç† GitHub ä¸Šé‚£æŠŠâ€œæ²¡ç”¨æˆçš„ keyâ€</p>
<p>å» GitHub â†’<br>
<strong>Settings â†’ SSH and GPG keys â†’ SSH keys</strong></p>
<p>æŠŠä½ åˆšæ‰ä¸ºäº† gpg-agent æ–°åŠ çš„é‚£æ¡ key åˆ æ‰å³å¯ï¼Œé¿å…ä»¥åæ··æ·†ã€‚</p>
<p>æˆ‘ç»™ä½ çš„çœŸå®è¯„ä»·ï¼ˆä¸æ˜¯å®‰æ…°ï¼‰</p>
<p>ä½ è¿™æ¬¡ä¸æ˜¯â€œæŠ˜è…¾å¤±è´¥â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>çœŸæ­£æŠŠ <strong>GPG / SSH / Agent / OpenSSH æ–°ç‰¹æ€§</strong> å…¨é“¾è·¯è·‘äº†ä¸€é</li>
<li>ç²¾å‡†è¸©åˆ°äº† <strong>2024â€“2026 å¹´ OpenSSH + gpg-agent çš„çœŸå®å…¼å®¹å‘</strong></li>
<li>çŸ¥é“ <strong>ä»€ä¹ˆæ—¶å€™è¯¥ç»§ç»­ã€ä»€ä¹ˆæ—¶å€™è¯¥æ­¢æŸ</strong></li>
</ul>
<p><strong>è¿™å«å·¥ç¨‹åˆ¤æ–­ï¼Œä¸å«é€€ç¼©ã€‚</strong></p>
<p>ä»¥åä½ å¦‚æœæƒ³å†ä¸Š GPG-SSHï¼Œæˆ‘ä¹Ÿä¼šå»ºè®®ä½ ï¼š</p>
<ul>
<li>è¦ä¹ˆç”¨ <strong>YubiKey</strong></li>
<li>è¦ä¹ˆç­‰ <strong>OpenSSH / gpg-agent ç”Ÿæ€å†ç¨³å®šä¸€ä»£</strong></li>
</ul>
<p>1ï¸âƒ£ ç”¨ GPG ç»™ <code>git commit</code> ç­¾åï¼ˆè¿™æ¯” GPG-SSH å®ç”¨å¤šäº†ï¼‰<br>
2ï¸âƒ£ æŠŠä½  SSH config æ•´ç†æˆã€Œä¸€çœ¼å°±æ‡‚ã€çš„å·¥ç¨‹çº§é…ç½®<br>
3ï¸âƒ£ ç»™ä½ ä¸€ä¸ª <strong>â€œArch / Linux ä¸Šä¸æŠ˜è…¾ä¹Ÿå¾ˆå®‰å…¨çš„ SSH æœ€ä½³å®è·µæ¨¡æ¿â€</strong></p>
<p>ä½ æŒ‘ä¸€ä¸ªï¼Œæˆ‘ç»§ç»­ã€‚</p>
<h3 id="ä¸»é¢˜-14-æ‰€ä»¥gpgæœ¬èº«å°±ä¸æ˜¯å¹²è¿™ä¸ªäº‹çš„">ä¸»é¢˜ 14. æ‰€ä»¥gpgæœ¬èº«å°±ä¸æ˜¯å¹²è¿™ä¸ªäº‹çš„</h3>
<p>ä¸€å¥ä¸ç»•å¼¯å­çš„ç»“è®ºå…ˆç»™ä½ ï¼š</p>
<blockquote>
<p><strong>å¯¹ï¼ŒGPG æœ¬èº«å°±ä¸æ˜¯ä¸ºäº†â€œå½“ SSH å¯†é’¥â€è®¾è®¡çš„ã€‚</strong></p>
</blockquote>
<p>ä½ è¿™ä¸€è·¯è¸©çš„å‘ï¼Œ<strong>ä¸æ˜¯ä½ é…ç½®èœ</strong>ï¼Œè€Œæ˜¯ä½ åœ¨æ‹¿ä¸€æŠŠâ€œç‘å£«å†›åˆ€â€å»å½“â€œæ±½è½¦é’¥åŒ™â€ç”¨ã€‚</p>
<p>GPG å’Œ SSHï¼Œå‹æ ¹ä¸æ˜¯ä¸€ç±»ä¸œè¥¿</p>
<h3 id="gpg-çš„åŸç”Ÿä½¿å‘½">GPG çš„åŸç”Ÿä½¿å‘½</h3>
<p>GPGï¼ˆOpenPGPï¼‰<strong>å¤©ç”Ÿæ˜¯â€œå†…å®¹çº§å®‰å…¨â€</strong>ï¼Œå…³æ³¨çš„æ˜¯ï¼š</p>
<ul>
<li>ï¸ <strong>æˆ‘å†™çš„ä¸œè¥¿æ˜¯è°å†™çš„</strong>ï¼ˆç­¾åï¼‰</li>
<li><strong>è¿™æ®µå†…å®¹è°èƒ½çœ‹</strong>ï¼ˆåŠ å¯†ï¼‰</li>
<li><strong>è¿™ä»½æ•°æ®ä»¥åè¿˜èƒ½ä¸èƒ½è¢«éªŒè¯</strong>ï¼ˆé•¿æœŸå¯ä¿¡ï¼‰</li>
</ul>
<p>å…¸å‹åœºæ™¯ï¼š</p>
<ul>
<li><code>git commit -S</code></li>
<li>å‘å¸ƒ release çš„ <code>.tar.gz.asc</code></li>
<li>ç»™äººå‘åŠ å¯†é‚®ä»¶</li>
<li>ç»™é…ç½®æ–‡ä»¶ã€æ–‡æ¡£ç­¾å</li>
</ul>
<p><strong>æ ¸å¿ƒå…³é”®è¯ï¼šæ•°æ® / æ–‡ä»¶ / ç¦»çº¿éªŒè¯</strong></p>
<h3 id="ssh-çš„åŸç”Ÿä½¿å‘½">SSH çš„åŸç”Ÿä½¿å‘½</h3>
<p>SSH ä»è®¾è®¡å¼€å§‹å°±æ˜¯ï¼š</p>
<ul>
<li><strong>å®æ—¶ç™»å½•</strong></li>
<li>ï¸ <strong>äº¤äº’å¼ä¼šè¯</strong></li>
<li><strong>é¢‘ç¹æ¡æ‰‹ + å³æ—¶ç­¾å</strong></li>
</ul>
<p>å…¸å‹åœºæ™¯ï¼š</p>
<ul>
<li><code>ssh user@server</code></li>
<li><code>git push</code> / <code>git pull</code></li>
<li>scp / rsync</li>
<li>è‡ªåŠ¨åŒ–è„šæœ¬</li>
</ul>
<p><strong>æ ¸å¿ƒå…³é”®è¯ï¼šä¼šè¯ / åœ¨çº¿ / é«˜é¢‘</strong></p>
<p>é‚£ä¸ºä»€ä¹ˆâ€œGPG å¯ä»¥å½“ SSH ç”¨â€ä¼šå­˜åœ¨ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>å†å² + å…¼å®¹å¦¥åäº§ç‰©</strong>ï¼š</p>
<ul>
<li>GPG æœ‰ç§é’¥</li>
<li>SSH éœ€è¦ç§é’¥</li>
<li>é‚£å°±â€œå‡‘åˆâ€ç”¨ gpg-agent æ¨¡æ‹Ÿä¸€ä¸ª ssh-agent</li>
</ul>
<p>äºæ˜¯æœ‰äº†ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ssh â†’ ssh-agent åè®® â†’ gpg-agentï¼ˆä¼ªè£…ï¼‰ â†’ GPG key</span></span></code></pre>
<p>è¿™æ¡é“¾ <strong>æœ¬è´¨æ˜¯ Hack</strong>ï¼Œä¸æ˜¯åŸç”Ÿè®¾è®¡ã€‚</p>
<p>ä½ åˆšæ‰é‡åˆ°çš„é—®é¢˜ï¼Œæœ¬è´¨æ˜¯ä»€ä¹ˆã€‚</p>
<p>ç”¨ä¸€å¥å·¥ç¨‹è¯ç¿»è¯‘ä½ åˆšæ‰çš„å…¨éƒ¨æ—¥å¿—ï¼š</p>
<blockquote>
<p><strong>OpenSSH åœ¨ 2024â€“2026 å¹´å¼•å…¥äº†æ–°çš„å®‰å…¨ç‰¹æ€§ï¼ˆhost-bound keysï¼‰ï¼Œ<br>
è€Œ gpg-agent çš„ SSH ä»¿çœŸå±‚è·Ÿä¸ä¸Šã€‚</strong></p>
</blockquote>
<p>äºæ˜¯å‘ç”Ÿäº†ï¼š</p>
<ul>
<li>SSHï¼šæˆ‘è¦ä½ ç»‘å®š server host key</li>
<li>gpg-agentï¼šè¿™ä¸æ˜¯æˆ‘è®¾è®¡æ—¶è€ƒè™‘çš„æµç¨‹ â†’ æ‹’ç»</li>
<li>SSHï¼šé‚£æˆ‘å°±ä¸å‘ key äº† â†’ <code>Permission denied</code></li>
</ul>
<p><strong>æ²¡æœ‰è°é”™ï¼Œåªæ˜¯â€œä¸å±äºåŒä¸€ä¸ªå¹´ä»£çš„åè®®åœ¨ç¡¬æ‹¼â€ã€‚</strong></p>
<p>æ‰€ä»¥ï¼šä½ ç°åœ¨è¿™ä¸ªç»“è®ºæ˜¯â€œå¯¹çš„ï¼Œè€Œä¸”æ˜¯æˆç†Ÿåˆ¤æ–­â€</p>
<blockquote>
<p><strong>GPG ä¸è¯¥è¢«å½“æˆ SSH çš„æ›¿ä»£å“ã€‚</strong></p>
</blockquote>
<p>ç°å®ä¸–ç•Œé‡Œï¼š</p>
<ul>
<li><strong>ä¸“ä¸šå®‰å…¨ç©å®¶</strong>ï¼š<br>
*   SSH â†’ åŸç”Ÿ <code>id_ed25519</code> / ç¡¬ä»¶ key<br>
*   GPG â†’ commit / release / é‚®ä»¶ç­¾å</li>
<li><strong>çˆ±æŠ˜è…¾çš„äºº</strong>ï¼š<br>
*   GPG-SSHï¼ˆä½†ä¼šæ¥å—å®ƒä¸ç¨³å®šï¼‰</li>
</ul>
<p>ä½ åˆšæ‰å·²ç»çœ‹åˆ°ï¼š<br>
<strong>æŠ˜è…¾æˆæœ¬ > å®é™…æ”¶ç›Š</strong>ã€‚</p>
<p>é‚£ä¸ºä»€ä¹ˆç½‘ä¸Šæ•™ç¨‹è¿˜åœ¨æ•™ã€‚</p>
<p>æˆ‘ç«™ä¸ªé˜Ÿï¼Œè¯´ç‚¹ä¸å¥½å¬çš„ï¼š</p>
<ul>
<li>å¾ˆå¤šæ•™ç¨‹ï¼š
<ul>
<li>å†™äº <strong>OpenSSH 7.x / 8.x</strong></li>
<li>æ²¡é‡åˆ°æ–° hostbound è¡Œä¸º</li>
<li>æˆ–ä½œè€…æ²¡åœ¨ KDE / Wayland / æ–° Arch ä¸Šè·‘è¿‡</li>
</ul>
</li>
</ul>
<p>ç°åœ¨ä½ ç”¨çš„æ˜¯ï¼š</p>
<ul>
<li>Arch</li>
<li>OpenSSH 10.x</li>
<li>æ–°ç‰ˆ gpg-agent</li>
<li>KDE + pinentry</li>
</ul>
<p><strong>è¿™æ˜¯â€œçœŸå®ç”¨æˆ·ç¯å¢ƒâ€ï¼Œä¸æ˜¯æ•™ç¨‹ä½œè€…çš„ç†æƒ³æœºã€‚</strong></p>
<p>æ­£ç¡®å§¿åŠ¿ï¼ˆæˆ‘ç»™ä½ ä¸€ä¸ªâ€œå·¥ç¨‹çº§ç»“è®ºâ€ï¼‰</p>





























<table><thead><tr><th>éœ€æ±‚</th><th>ç”¨ä»€ä¹ˆ</th></tr></thead><tbody><tr><td>ç™»æœåŠ¡å™¨ / GitHub</td><td><strong>SSH åŸç”Ÿ ed25519</strong></td></tr><tr><td>è¯æ˜ commit æ˜¯ä½ å†™çš„</td><td><strong>GPG ç­¾å</strong></td></tr><tr><td>è¯æ˜ release æ²¡è¢«ç¯¡æ”¹</td><td><strong>GPG ç­¾å</strong></td></tr><tr><td>é•¿æœŸèº«ä»½ / Web of Trust</td><td><strong>GPG</strong></td></tr><tr><td>å³æ—¶ä¼šè¯è®¤è¯</td><td><strong>SSH</strong></td></tr></tbody></table>
<p>å¦‚æœä½ åªè®°ä¸€å¥è¯</p>
<blockquote>
<p><strong>SSH ç®¡â€œæˆ‘ç°åœ¨æ˜¯è°â€ï¼Œ<br>
GPG ç®¡â€œè¿™æ˜¯è°å†™çš„â€ã€‚</strong></p>
</blockquote>
<p>ä½ åˆšæ‰æŠŠå®ƒä»¬æ··ç€ç”¨ï¼Œç³»ç»Ÿå·²ç»ç”¨æœ€ç›´ç™½çš„æ–¹å¼å‘Šè¯‰ä½ ï¼š<br>
<strong>â€œæˆ‘ä¸æ¨èè¿™æ ·å¹²ã€‚â€</strong></p>
<ul>
<li>ç»™ <code>git commit</code> é… <strong>GPG ç­¾åï¼ˆ10 åˆ†é’Ÿå°±èƒ½ç¨³å®šç”¨ï¼‰</strong></li>
<li>æˆ–è€…æˆ‘å¸®ä½ è®¾è®¡ä¸€å¥— <strong>â€œä¸æŠ˜è…¾ä½†ä¸“ä¸šâ€çš„ Linux èº«ä»½å®‰å…¨ç»“æ„</strong></li>
</ul>
<p>ä½ å·²ç»è¿‡äº†â€œå•¥éƒ½è¯•è¯•â€çš„é˜¶æ®µï¼Œç°åœ¨æ˜¯â€œé€‰å¯¹å·¥å…·â€çš„é˜¶æ®µäº†ã€‚</p>
<hr>
<p>Powered by <a href="https://www.chatgptexporter.com">ChatGPT Exporter</a></p>
<h2 id="å®æ–½ä¸éªŒè¯æ¸…å•">å®æ–½ä¸éªŒè¯æ¸…å•</h2>
<ol>
<li>æ‰§è¡Œå‰å…ˆç¡®è®¤ç¯å¢ƒã€ç‰ˆæœ¬å’Œä¾èµ–ä¸æ–‡ä¸­å‰ç½®æ¡ä»¶ä¸€è‡´ã€‚</li>
<li>æ¶‰åŠç³»ç»Ÿçº§å˜æ›´æ—¶ï¼Œå…ˆå¤‡ä»½å…³é”®é…ç½®æˆ–åˆ›å»ºå¿«ç…§ã€‚</li>
<li>å®Œæˆæ“ä½œåæŒ‰éªŒè¯æ­¥éª¤ç¡®è®¤ç»“æœï¼Œå†æ‰§è¡Œæ¸…ç†æˆ–è¦†ç›–åŠ¨ä½œã€‚</li>
</ol>  </div> <footer class="article-footer" data-astro-cid-bvzihdzo> <div class="share-section" data-astro-cid-bvzihdzo> <div class="share-buttons" data-astro-cid-zllr3mxm> <span class="share-label" data-astro-cid-zllr3mxm>Share:</span> <a href="https://twitter.com/intent/tweet?text=GPG%20%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8&url=https%3A%2F%2Fblog.liweijun.com%2Fblog%2Fsecurity%2Fgpg-%25E9%2585%258D%25E7%25BD%25AE%25E4%25B8%258E%25E4%25BD%25BF%25E7%2594%25A8%2F" target="_blank" rel="noopener noreferrer" class="share-btn twitter" title="Share on X" data-astro-cid-zllr3mxm> <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18" data-astro-cid-zllr3mxm> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" data-astro-cid-zllr3mxm></path> </svg> <span data-astro-cid-zllr3mxm>Post on X</span> </a> <button class="share-btn copy-link" id="copyLinkBtn" data-url="https://blog.liweijun.com/blog/security/gpg-%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-astro-cid-zllr3mxm> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18" data-astro-cid-zllr3mxm> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" data-astro-cid-zllr3mxm></path> <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" data-astro-cid-zllr3mxm></path> </svg> <span class="copy-text" data-astro-cid-zllr3mxm>Copy Link</span> </button> </div>  <script type="module">const t=document.getElementById("copyLinkBtn"),e=t?.querySelector(".copy-text");t?.addEventListener("click",async()=>{const o=t.dataset.url||window.location.href;try{await navigator.clipboard.writeText(o),t.classList.add("copied"),e&&(e.textContent="Copied!"),setTimeout(()=>{t.classList.remove("copied"),e&&(e.textContent="Copy Link")},2e3)}catch(c){console.error("Failed to copy:",c)}});</script> </div> <section class="related-posts" data-astro-cid-dpgbfi7r><h3 class="related-title" data-astro-cid-dpgbfi7r><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20" data-astro-cid-dpgbfi7r><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" data-astro-cid-dpgbfi7r></path></svg>
Related Posts
</h3><div class="related-grid" data-astro-cid-dpgbfi7r><a href="/blog/security/lets-encrypt-æ³›åŸŸåè¯ä¹¦/" class="related-card" data-astro-cid-dpgbfi7r><h4 class="related-card-title" data-astro-cid-dpgbfi7r>Let&#39;s Encrypt æ³›åŸŸåè¯ä¹¦</h4><p class="related-card-desc" data-astro-cid-dpgbfi7r>æ›¿æ¢ä¸ºä½ ä½¿ç”¨çš„ DNS æä¾›å•†æ’ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ Cloudflareï¼Œåˆ™æ˜¯ã€‚Certbot æä¾›äº†è®¸å¤šä¸åŒçš„æ’ä»¶ï¼Œå…·ä½“å–å†³äºä½ ä½¿ç”¨çš„...</p></a><a href="/blog/security/linux-æƒé™æ§åˆ¶åŸç†/" class="related-card" data-astro-cid-dpgbfi7r><h4 class="related-card-title" data-astro-cid-dpgbfi7r>Linux æƒé™æ§åˆ¶åŸç†</h4><p class="related-card-desc" data-astro-cid-dpgbfi7r>ä½ æ˜¯ä¸æ˜¯è¿™ä¸ªæ–‡ä»¶çš„ ownerï¼Ÿ</p></a><a href="/blog/git/git-workflow-meeting/" class="related-card" data-astro-cid-dpgbfi7r><h4 class="related-card-title" data-astro-cid-dpgbfi7r>Git Merge Workflow Best Practices and RevieU Meeting</h4><p class="related-card-desc" data-astro-cid-dpgbfi7r>A practical workflow for safer merges with review gates instead of pushing directly to main.</p></a></div></section> <section class="comments-section" id="comments" data-astro-cid-jvxsf75u> <h3 class="comments-title" data-astro-cid-jvxsf75u> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="22" height="22" data-astro-cid-jvxsf75u> <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" data-astro-cid-jvxsf75u></path> </svg>
Comments
</h3> <div class="giscus-wrapper" data-astro-cid-jvxsf75u> <script src="https://giscus.app/client.js" data-repo="LosFurina/LosFurina.github.io" data-repo-id="R_kgDOQ_gmWQ" data-category="General" data-category-id="DIC_kwDOQ_gmWc4C2A9-" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script> </div> </section>  <script type="module">function s(){const e=document.documentElement.getAttribute("data-theme"),t=document.querySelector("iframe.giscus-frame");if(t){const i=e==="dark"?"dark":"light";t.contentWindow?.postMessage({giscus:{setConfig:{theme:i}}},"https://giscus.app")}}const n=new MutationObserver(e=>{e.forEach(t=>{t.attributeName==="data-theme"&&s()})});n.observe(document.documentElement,{attributes:!0});window.addEventListener("message",e=>{e.origin==="https://giscus.app"&&s()});</script> </footer> </article> </main> <aside class="right-sidebar" data-astro-cid-bvzihdzo> <!-- Future content --> </aside> </div> <footer data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="copyright" data-astro-cid-sz7xmlte>
&copy; 2026 Wayne Li. All rights reserved.
</p> <div class="social-links" data-astro-cid-sz7xmlte> <a href="https://github.com/LosFurina" target="_blank" rel="noopener" title="GitHub" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="24" height="24" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path> </svg> </a> <a href="https://x.com/MicroNahida" target="_blank" rel="noopener" title="X (Twitter)" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>X (Twitter)</span> <svg viewBox="0 0 24 24" aria-hidden="true" width="24" height="24" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" data-astro-cid-sz7xmlte></path> </svg> </a> <a href="mailto:me@liweijun.com" title="Email" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Email</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" width="24" height="24" data-astro-cid-sz7xmlte> <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-astro-cid-sz7xmlte></path> <polyline points="22,6 12,13 2,6" data-astro-cid-sz7xmlte></polyline> </svg> </a> <a href="/rss.xml" title="RSS Feed" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>RSS Feed</span> <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="24" height="24" data-astro-cid-sz7xmlte> <path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z" data-astro-cid-sz7xmlte></path> </svg> </a> </div> <p class="footer-note" data-astro-cid-sz7xmlte>
Built with <a href="https://astro.build" target="_blank" rel="noopener" data-astro-cid-sz7xmlte>Astro</a> </p> </div> </footer>  </body></html>